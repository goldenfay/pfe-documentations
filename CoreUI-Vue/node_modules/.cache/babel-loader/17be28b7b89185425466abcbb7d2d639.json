{"remainingRequest":"/home/hads/Documents/CoreUI-Vue/node_modules/babel-loader/lib/index.js!/home/hads/Downloads/pycharm-community-2020.1/plugins/python-ce/helpers/MathJax/extensions/MathMenu.js","dependencies":[{"path":"/home/hads/Downloads/pycharm-community-2020.1/plugins/python-ce/helpers/MathJax/extensions/MathMenu.js","mtime":1586259854000},{"path":"/home/hads/Documents/CoreUI-Vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hads/Documents/CoreUI-Vue/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyogLSotIE1vZGU6IEphdmFzY3JpcHQ7IGluZGVudC10YWJzLW1vZGU6bmlsOyBqcy1pbmRlbnQtbGV2ZWw6IDIgLSotICovCgovKiB2aW06IHNldCB0cz0yIGV0IHN3PTIgdHc9ODA6ICovCgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogKgogKiAgTWF0aEpheC9leHRlbnNpb25zL01hdGhNZW51LmpzCiAqCiAqICBJbXBsZW1lbnRzIGEgcmlnaHQtbW91c2UgKG9yIENUUkwtY2xpY2spIG1lbnUgb3ZlciBtYXRoZW1hdGljcwogKiAgZWxlbWVudHMgdGhhdCBnaXZlcyB0aGUgdXNlciB0aGUgYWJpbGl0eSB0byBjb3B5IHRoZSBzb3VyY2UsCiAqICBjaGFuZ2UgdGhlIG1hdGggc2l6ZSwgYW5kIHpvb20gc2V0dGluZ3MuCiAqCiAqICAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KICoKICogIENvcHlyaWdodCAoYykgMjAxMC0yMDE1IFRoZSBNYXRoSmF4IENvbnNvcnRpdW0KICoKICogIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOwogKiAgeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLgogKiAgWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0CiAqCiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqCiAqICBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlCiAqICBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiAiQVMgSVMiIEJBU0lTLAogKiAgV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuCiAqICBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kCiAqICBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS4KICovCihmdW5jdGlvbiAoSFVCLCBIVE1MLCBBSkFYLCBDQUxMQkFDSywgT1VUUFVUKSB7CiAgdmFyIFZFUlNJT04gPSAiMi42LjEiOwogIHZhciBTSUdOQUwgPSBNYXRoSmF4LkNhbGxiYWNrLlNpZ25hbCgibWVudSIpOyAvLyBzaWduYWwgZm9yIG1lbnUgZXZlbnRzCgogIE1hdGhKYXguRXh0ZW5zaW9uLk1hdGhNZW51ID0gewogICAgdmVyc2lvbjogVkVSU0lPTiwKICAgIHNpZ25hbDogU0lHTkFMCiAgfTsKCiAgdmFyIF8gPSBmdW5jdGlvbiBfKGlkKSB7CiAgICByZXR1cm4gTWF0aEpheC5Mb2NhbGl6YXRpb24uXy5hcHBseShNYXRoSmF4LkxvY2FsaXphdGlvbiwgW1siTWF0aE1lbnUiLCBpZF1dLmNvbmNhdChbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpKTsKICB9OwoKICB2YXIgaXNQQyA9IEhVQi5Ccm93c2VyLmlzUEMsCiAgICAgIGlzTVNJRSA9IEhVQi5Ccm93c2VyLmlzTVNJRSwKICAgICAgaXNJRTkgPSAoZG9jdW1lbnQuZG9jdW1lbnRNb2RlIHx8IDApID4gODsKICB2YXIgUk9VTkQgPSBpc1BDID8gbnVsbCA6ICI1cHgiOwogIHZhciBDT05GSUcgPSBIVUIuQ29tYmluZUNvbmZpZygiTWF0aE1lbnUiLCB7CiAgICBkZWxheTogMTUwLAogICAgLy8gdGhlIGRlbGF5IGZvciBzdWJtZW51cwogICAgc2hvd1JlbmRlcmVyOiB0cnVlLAogICAgLy8gIHNob3cgdGhlICJNYXRoIFJlbmRlcmVyIiBtZW51PwogICAgc2hvd01hdGhQbGF5ZXI6IHRydWUsCiAgICAvLyAgc2hvdyB0aGUgIk1hdGhQbGF5ZXIiIG1lbnU/CiAgICBzaG93Rm9udE1lbnU6IGZhbHNlLAogICAgLy8gIHNob3cgdGhlICJGb250IFByZWZlcmVuY2UiIG1lbnU/CiAgICBzaG93Q29udGV4dDogZmFsc2UsCiAgICAvLyAgc2hvdyB0aGUgIkNvbnRleHQgTWVudSIgbWVudT8KICAgIHNob3dEaXNjb3ZlcmFibGU6IGZhbHNlLAogICAgLy8gIHNob3cgdGhlICJEaXNjb3ZlcmFibGUiIG1lbnU/CiAgICBzaG93TG9jYWxlOiB0cnVlLAogICAgLy8gIHNob3cgdGhlICJMb2NhbGUiIG1lbnU/CiAgICBzaG93TG9jYWxlVVJMOiBmYWxzZSwKICAgIC8vICBzaG93IHRoZSAiTG9hZCBmcm9tIFVSTCIgbWVudT8KICAgIHNlbWFudGljc0Fubm90YXRpb25zOiB7CiAgICAgICJUZVgiOiBbIlRlWCIsICJMYVRlWCIsICJhcHBsaWNhdGlvbi94LXRleCJdLAogICAgICAiU3Rhck1hdGgiOiBbIlN0YXJNYXRoIDUuMCJdLAogICAgICAiTWFwbGUiOiBbIk1hcGxlIl0sCiAgICAgICJDb250ZW50TWF0aE1MIjogWyJNYXRoTUwtQ29udGVudCIsICJhcHBsaWNhdGlvbi9tYXRobWwtY29udGVudCt4bWwiXSwKICAgICAgIk9wZW5NYXRoIjogWyJPcGVuTWF0aCJdCiAgICB9LAogICAgd2luZG93U2V0dGluZ3M6IHsKICAgICAgLy8gZm9yIHNvdXJjZSB3aW5kb3cKICAgICAgc3RhdHVzOiAibm8iLAogICAgICB0b29sYmFyOiAibm8iLAogICAgICBsb2NhdGlvbmJhcjogIm5vIiwKICAgICAgbWVudWJhcjogIm5vIiwKICAgICAgZGlyZWN0b3JpZXM6ICJubyIsCiAgICAgIHBlcnNvbmFsYmFyOiAibm8iLAogICAgICByZXNpemFibGU6ICJ5ZXMiLAogICAgICBzY3JvbGxiYXJzOiAieWVzIiwKICAgICAgd2lkdGg6IDQwMCwKICAgICAgaGVpZ2h0OiAzMDAsCiAgICAgIGxlZnQ6IE1hdGgucm91bmQoKHNjcmVlbi53aWR0aCAtIDQwMCkgLyAyKSwKICAgICAgdG9wOiBNYXRoLnJvdW5kKChzY3JlZW4uaGVpZ2h0IC0gMzAwKSAvIDMpCiAgICB9LAogICAgc3R5bGVzOiB7CiAgICAgICIjTWF0aEpheF9BYm91dCI6IHsKICAgICAgICBwb3NpdGlvbjogImZpeGVkIiwKICAgICAgICBsZWZ0OiAiNTAlIiwKICAgICAgICB3aWR0aDogImF1dG8iLAogICAgICAgICJ0ZXh0LWFsaWduIjogImNlbnRlciIsCiAgICAgICAgYm9yZGVyOiAiM3B4IG91dHNldCIsCiAgICAgICAgcGFkZGluZzogIjFlbSAyZW0iLAogICAgICAgICJiYWNrZ3JvdW5kLWNvbG9yIjogIiNEREREREQiLAogICAgICAgIGNvbG9yOiAiYmxhY2siLAogICAgICAgIGN1cnNvcjogImRlZmF1bHQiLAogICAgICAgICJmb250LWZhbWlseSI6ICJtZXNzYWdlLWJveCIsCiAgICAgICAgImZvbnQtc2l6ZSI6ICIxMjAlIiwKICAgICAgICAiZm9udC1zdHlsZSI6ICJub3JtYWwiLAogICAgICAgICJ0ZXh0LWluZGVudCI6IDAsCiAgICAgICAgInRleHQtdHJhbnNmb3JtIjogIm5vbmUiLAogICAgICAgICJsaW5lLWhlaWdodCI6ICJub3JtYWwiLAogICAgICAgICJsZXR0ZXItc3BhY2luZyI6ICJub3JtYWwiLAogICAgICAgICJ3b3JkLXNwYWNpbmciOiAibm9ybWFsIiwKICAgICAgICAid29yZC13cmFwIjogIm5vcm1hbCIsCiAgICAgICAgIndoaXRlLXNwYWNlIjogIm5vd3JhcCIsCiAgICAgICAgImZsb2F0IjogIm5vbmUiLAogICAgICAgICJ6LWluZGV4IjogMjAxLAogICAgICAgICJib3JkZXItcmFkaXVzIjogIjE1cHgiLAogICAgICAgIC8vIE9wZXJhIDEwLjUgYW5kIElFOQogICAgICAgICItd2Via2l0LWJvcmRlci1yYWRpdXMiOiAiMTVweCIsCiAgICAgICAgLy8gU2FmYXJpIGFuZCBDaHJvbWUKICAgICAgICAiLW1vei1ib3JkZXItcmFkaXVzIjogIjE1cHgiLAogICAgICAgIC8vIEZpcmVmb3gKICAgICAgICAiLWtodG1sLWJvcmRlci1yYWRpdXMiOiAiMTVweCIsCiAgICAgICAgLy8gS29ucXVlcm9yCiAgICAgICAgImJveC1zaGFkb3ciOiAiMHB4IDEwcHggMjBweCAjODA4MDgwIiwKICAgICAgICAvLyBPcGVyYSAxMC41IGFuZCBJRTkKICAgICAgICAiLXdlYmtpdC1ib3gtc2hhZG93IjogIjBweCAxMHB4IDIwcHggIzgwODA4MCIsCiAgICAgICAgLy8gU2FmYXJpIDMgYW5kIENocm9tZQogICAgICAgICItbW96LWJveC1zaGFkb3ciOiAiMHB4IDEwcHggMjBweCAjODA4MDgwIiwKICAgICAgICAvLyBGb3JlZm94IDMuNQogICAgICAgICIta2h0bWwtYm94LXNoYWRvdyI6ICIwcHggMTBweCAyMHB4ICM4MDgwODAiLAogICAgICAgIC8vIEtvbnF1ZXJvcgogICAgICAgIGZpbHRlcjogInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5kcm9wc2hhZG93KE9mZlg9MiwgT2ZmWT0yLCBDb2xvcj0nZ3JheScsIFBvc2l0aXZlPSd0cnVlJykiIC8vIElFCgogICAgICB9LAogICAgICAiI01hdGhKYXhfQWJvdXQuTWF0aEpheF9Nb3VzZVBvc3QiOiB7CiAgICAgICAgb3V0bGluZTogIm5vbmUiCiAgICAgIH0sCiAgICAgICIuTWF0aEpheF9NZW51IjogewogICAgICAgIHBvc2l0aW9uOiAiYWJzb2x1dGUiLAogICAgICAgICJiYWNrZ3JvdW5kLWNvbG9yIjogIndoaXRlIiwKICAgICAgICBjb2xvcjogImJsYWNrIiwKICAgICAgICB3aWR0aDogImF1dG8iLAogICAgICAgIHBhZGRpbmc6IGlzUEMgPyAiMnB4IiA6ICI1cHggMHB4IiwKICAgICAgICBib3JkZXI6ICIxcHggc29saWQgI0NDQ0NDQyIsCiAgICAgICAgbWFyZ2luOiAwLAogICAgICAgIGN1cnNvcjogImRlZmF1bHQiLAogICAgICAgIGZvbnQ6ICJtZW51IiwKICAgICAgICAidGV4dC1hbGlnbiI6ICJsZWZ0IiwKICAgICAgICAidGV4dC1pbmRlbnQiOiAwLAogICAgICAgICJ0ZXh0LXRyYW5zZm9ybSI6ICJub25lIiwKICAgICAgICAibGluZS1oZWlnaHQiOiAibm9ybWFsIiwKICAgICAgICAibGV0dGVyLXNwYWNpbmciOiAibm9ybWFsIiwKICAgICAgICAid29yZC1zcGFjaW5nIjogIm5vcm1hbCIsCiAgICAgICAgIndvcmQtd3JhcCI6ICJub3JtYWwiLAogICAgICAgICJ3aGl0ZS1zcGFjZSI6ICJub3dyYXAiLAogICAgICAgICJmbG9hdCI6ICJub25lIiwKICAgICAgICAiei1pbmRleCI6IDIwMSwKICAgICAgICAiYm9yZGVyLXJhZGl1cyI6IFJPVU5ELAogICAgICAgIC8vIE9wZXJhIDEwLjUgYW5kIElFOQogICAgICAgICItd2Via2l0LWJvcmRlci1yYWRpdXMiOiBST1VORCwKICAgICAgICAvLyBTYWZhcmkgYW5kIENocm9tZQogICAgICAgICItbW96LWJvcmRlci1yYWRpdXMiOiBST1VORCwKICAgICAgICAvLyBGaXJlZm94CiAgICAgICAgIi1raHRtbC1ib3JkZXItcmFkaXVzIjogUk9VTkQsCiAgICAgICAgLy8gS29ucXVlcm9yCiAgICAgICAgImJveC1zaGFkb3ciOiAiMHB4IDEwcHggMjBweCAjODA4MDgwIiwKICAgICAgICAvLyBPcGVyYSAxMC41IGFuZCBJRTkKICAgICAgICAiLXdlYmtpdC1ib3gtc2hhZG93IjogIjBweCAxMHB4IDIwcHggIzgwODA4MCIsCiAgICAgICAgLy8gU2FmYXJpIDMgYW5kIENocm9tZQogICAgICAgICItbW96LWJveC1zaGFkb3ciOiAiMHB4IDEwcHggMjBweCAjODA4MDgwIiwKICAgICAgICAvLyBGb3JlZm94IDMuNQogICAgICAgICIta2h0bWwtYm94LXNoYWRvdyI6ICIwcHggMTBweCAyMHB4ICM4MDgwODAiLAogICAgICAgIC8vIEtvbnF1ZXJvcgogICAgICAgIGZpbHRlcjogInByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5kcm9wc2hhZG93KE9mZlg9MiwgT2ZmWT0yLCBDb2xvcj0nZ3JheScsIFBvc2l0aXZlPSd0cnVlJykiIC8vIElFCgogICAgICB9LAogICAgICAiLk1hdGhKYXhfTWVudUl0ZW0iOiB7CiAgICAgICAgcGFkZGluZzogaXNQQyA/ICIycHggMmVtIiA6ICIxcHggMmVtIiwKICAgICAgICBiYWNrZ3JvdW5kOiAidHJhbnNwYXJlbnQiCiAgICAgIH0sCiAgICAgICIuTWF0aEpheF9NZW51QXJyb3ciOiB7CiAgICAgICAgcG9zaXRpb246ICJhYnNvbHV0ZSIsCiAgICAgICAgcmlnaHQ6ICIuNWVtIiwKICAgICAgICAicGFkZGluZy10b3AiOiAiLjI1ZW0iLAogICAgICAgIGNvbG9yOiAiIzY2NjY2NiIsCiAgICAgICAgImZvbnQtZmFtaWx5IjogaXNNU0lFID8gIidBcmlhbCB1bmljb2RlIE1TJyIgOiBudWxsLAogICAgICAgICJmb250LXNpemUiOiAiLjc1ZW0iCiAgICAgIH0sCiAgICAgICIuTWF0aEpheF9NZW51QWN0aXZlIC5NYXRoSmF4X01lbnVBcnJvdyI6IHsKICAgICAgICBjb2xvcjogIndoaXRlIgogICAgICB9LAogICAgICAiLk1hdGhKYXhfTWVudUFycm93LlJUTCI6IHsKICAgICAgICBsZWZ0OiAiLjVlbSIsCiAgICAgICAgcmlnaHQ6ICJhdXRvIgogICAgICB9LAogICAgICAiLk1hdGhKYXhfTWVudUNoZWNrIjogewogICAgICAgIHBvc2l0aW9uOiAiYWJzb2x1dGUiLAogICAgICAgIGxlZnQ6ICIuN2VtIiwKICAgICAgICAiZm9udC1mYW1pbHkiOiBpc01TSUUgPyAiJ0FyaWFsIHVuaWNvZGUgTVMnIiA6IG51bGwKICAgICAgfSwKICAgICAgIi5NYXRoSmF4X01lbnVDaGVjay5SVEwiOiB7CiAgICAgICAgcmlnaHQ6ICIuN2VtIiwKICAgICAgICBsZWZ0OiAiYXV0byIKICAgICAgfSwKICAgICAgIi5NYXRoSmF4X01lbnVSYWRpb0NoZWNrIjogewogICAgICAgIHBvc2l0aW9uOiAiYWJzb2x1dGUiLAogICAgICAgIGxlZnQ6IGlzUEMgPyAiMWVtIiA6ICIuN2VtIgogICAgICB9LAogICAgICAiLk1hdGhKYXhfTWVudVJhZGlvQ2hlY2suUlRMIjogewogICAgICAgIHJpZ2h0OiBpc1BDID8gIjFlbSIgOiAiLjdlbSIsCiAgICAgICAgbGVmdDogImF1dG8iCiAgICAgIH0sCiAgICAgICIuTWF0aEpheF9NZW51TGFiZWwiOiB7CiAgICAgICAgcGFkZGluZzogaXNQQyA/ICIycHggMmVtIDRweCAxLjMzZW0iIDogIjFweCAyZW0gM3B4IDEuMzNlbSIsCiAgICAgICAgImZvbnQtc3R5bGUiOiAiaXRhbGljIgogICAgICB9LAogICAgICAiLk1hdGhKYXhfTWVudVJ1bGUiOiB7CiAgICAgICAgImJvcmRlci10b3AiOiBpc1BDID8gIjFweCBzb2xpZCAjQ0NDQ0NDIiA6ICIxcHggc29saWQgI0RERERERCIsCiAgICAgICAgbWFyZ2luOiBpc1BDID8gIjRweCAxcHggMHB4IiA6ICI0cHggM3B4IgogICAgICB9LAogICAgICAiLk1hdGhKYXhfTWVudURpc2FibGVkIjogewogICAgICAgIGNvbG9yOiAiR3JheVRleHQiCiAgICAgIH0sCiAgICAgICIuTWF0aEpheF9NZW51QWN0aXZlIjogewogICAgICAgICJiYWNrZ3JvdW5kLWNvbG9yIjogaXNQQyA/ICJIaWdobGlnaHQiIDogIiM2MDY4NzIiLAogICAgICAgIGNvbG9yOiBpc1BDID8gIkhpZ2hsaWdodFRleHQiIDogIndoaXRlIgogICAgICB9LAogICAgICAiLk1hdGhKYXhfTWVudURpc2FibGVkOmZvY3VzLCAuTWF0aEpheF9NZW51TGFiZWw6Zm9jdXMiOiB7CiAgICAgICAgImJhY2tncm91bmQtY29sb3IiOiAiI0U4RThFOCIKICAgICAgfSwKICAgICAgIi5NYXRoSmF4X0NvbnRleHRNZW51OmZvY3VzIjogewogICAgICAgIG91dGxpbmU6ICJub25lIgogICAgICB9LAogICAgICAiLk1hdGhKYXhfQ29udGV4dE1lbnUgLk1hdGhKYXhfTWVudUl0ZW06Zm9jdXMiOiB7CiAgICAgICAgb3V0bGluZTogIm5vbmUiCiAgICAgIH0sCiAgICAgICIjTWF0aEpheF9BYm91dENsb3NlIjogewogICAgICAgIHRvcDogIi4yZW0iLAogICAgICAgIHJpZ2h0OiAiLjJlbSIKICAgICAgfSwKICAgICAgIi5NYXRoSmF4X01lbnUgLk1hdGhKYXhfTWVudUNsb3NlIjogewogICAgICAgIHRvcDogIi0xMHB4IiwKICAgICAgICBsZWZ0OiAiLTEwcHgiCiAgICAgIH0sCiAgICAgICIuTWF0aEpheF9NZW51Q2xvc2UiOiB7CiAgICAgICAgcG9zaXRpb246ICJhYnNvbHV0ZSIsCiAgICAgICAgY3Vyc29yOiAicG9pbnRlciIsCiAgICAgICAgZGlzcGxheTogImlubGluZS1ibG9jayIsCiAgICAgICAgYm9yZGVyOiAiMnB4IHNvbGlkICNBQUEiLAogICAgICAgICJib3JkZXItcmFkaXVzIjogIjE4cHgiLAogICAgICAgICItd2Via2l0LWJvcmRlci1yYWRpdXMiOiAiMThweCIsCiAgICAgICAgLy8gU2FmYXJpIGFuZCBDaHJvbWUKICAgICAgICAiLW1vei1ib3JkZXItcmFkaXVzIjogIjE4cHgiLAogICAgICAgIC8vIEZpcmVmb3gKICAgICAgICAiLWtodG1sLWJvcmRlci1yYWRpdXMiOiAiMThweCIsCiAgICAgICAgLy8gS29ucXVlcm9yCiAgICAgICAgImZvbnQtZmFtaWx5IjogIidDb3VyaWVyIE5ldycsQ291cmllciIsCiAgICAgICAgImZvbnQtc2l6ZSI6ICIyNHB4IiwKICAgICAgICBjb2xvcjogIiNGMEYwRjAiCiAgICAgIH0sCiAgICAgICIuTWF0aEpheF9NZW51Q2xvc2Ugc3BhbiI6IHsKICAgICAgICBkaXNwbGF5OiAiYmxvY2siLAogICAgICAgICJiYWNrZ3JvdW5kLWNvbG9yIjogIiNBQUEiLAogICAgICAgIGJvcmRlcjogIjEuNXB4IHNvbGlkIiwKICAgICAgICAiYm9yZGVyLXJhZGl1cyI6ICIxOHB4IiwKICAgICAgICAiLXdlYmtpdC1ib3JkZXItcmFkaXVzIjogIjE4cHgiLAogICAgICAgIC8vIFNhZmFyaSBhbmQgQ2hyb21lCiAgICAgICAgIi1tb3otYm9yZGVyLXJhZGl1cyI6ICIxOHB4IiwKICAgICAgICAvLyBGaXJlZm94CiAgICAgICAgIi1raHRtbC1ib3JkZXItcmFkaXVzIjogIjE4cHgiLAogICAgICAgIC8vIEtvbnF1ZXJvcgogICAgICAgICJsaW5lLWhlaWdodCI6IDAsCiAgICAgICAgcGFkZGluZzogIjhweCAwIDZweCIgLy8gbWF5IG5lZWQgdG8gYmUgYnJvd3Nlci1zcGVjaWZpYwoKICAgICAgfSwKICAgICAgIi5NYXRoSmF4X01lbnVDbG9zZTpob3ZlciI6IHsKICAgICAgICBjb2xvcjogIndoaXRlIWltcG9ydGFudCIsCiAgICAgICAgYm9yZGVyOiAiMnB4IHNvbGlkICNDQ0MhaW1wb3J0YW50IgogICAgICB9LAogICAgICAiLk1hdGhKYXhfTWVudUNsb3NlOmhvdmVyIHNwYW4iOiB7CiAgICAgICAgImJhY2tncm91bmQtY29sb3IiOiAiI0NDQyFpbXBvcnRhbnQiCiAgICAgIH0sCiAgICAgICIuTWF0aEpheF9NZW51Q2xvc2U6aG92ZXI6Zm9jdXMiOiB7CiAgICAgICAgb3V0bGluZTogIm5vbmUiCiAgICAgIH0KICAgIH0KICB9KTsKICB2YXIgRkFMU0UsIEhPVkVSLCBLRVk7CiAgSFVCLlJlZ2lzdGVyLlN0YXJ0dXBIb29rKCJNYXRoRXZlbnRzIFJlYWR5IiwgZnVuY3Rpb24gKCkgewogICAgRkFMU0UgPSBNYXRoSmF4LkV4dGVuc2lvbi5NYXRoRXZlbnRzLkV2ZW50LkZhbHNlOwogICAgSE9WRVIgPSBNYXRoSmF4LkV4dGVuc2lvbi5NYXRoRXZlbnRzLkhvdmVyOwogICAgS0VZID0gTWF0aEpheC5FeHRlbnNpb24uTWF0aEV2ZW50cy5FdmVudC5LRVk7CiAgfSk7CiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogIC8qCiAgICogIEFic3RyYWN0IGNsYXNzIG9mIGFsbCBrZXlib2FyZCBuYXZpZ2F0YWJsZSBvYmplY3RzLgogICAqLwoKICB2YXIgTkFWID0gTWF0aEpheC5PYmplY3QuU3ViY2xhc3MoewogICAgLyoKICAgICAqIE1vdmluZyBpbiB0aGUgbGlzdCBvZiBpdGVtcy4KICAgICAqLwogICAgS2V5ZG93bjogZnVuY3Rpb24gS2V5ZG93bihldmVudCwgbWVudSkgewogICAgICBzd2l0Y2ggKGV2ZW50LmtleUNvZGUpIHsKICAgICAgICBjYXNlIEtFWS5FU0NBUEU6CiAgICAgICAgICB0aGlzLlJlbW92ZShldmVudCwgbWVudSk7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgY2FzZSBLRVkuUklHSFQ6CiAgICAgICAgICB0aGlzLlJpZ2h0KGV2ZW50LCBtZW51KTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIEtFWS5MRUZUOgogICAgICAgICAgdGhpcy5MZWZ0KGV2ZW50LCBtZW51KTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIEtFWS5VUDoKICAgICAgICAgIHRoaXMuVXAoZXZlbnQsIG1lbnUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgS0VZLkRPV046CiAgICAgICAgICB0aGlzLkRvd24oZXZlbnQsIG1lbnUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgS0VZLlJFVFVSTjoKICAgICAgICBjYXNlIEtFWS5TUEFDRToKICAgICAgICAgIHRoaXMuU3BhY2UoZXZlbnQsIG1lbnUpOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICByZXR1cm47CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgcmV0dXJuIEZBTFNFKGV2ZW50KTsKICAgIH0sCiAgICBFc2NhcGU6IGZ1bmN0aW9uIEVzY2FwZShldmVudCwgbWVudSkge30sCiAgICBSaWdodDogZnVuY3Rpb24gUmlnaHQoZXZlbnQsIG1lbnUpIHt9LAogICAgTGVmdDogZnVuY3Rpb24gTGVmdChldmVudCwgbWVudSkge30sCiAgICBVcDogZnVuY3Rpb24gVXAoZXZlbnQsIG1lbnUpIHt9LAogICAgRG93bjogZnVuY3Rpb24gRG93bihldmVudCwgbWVudSkge30sCiAgICBTcGFjZTogZnVuY3Rpb24gU3BhY2UoZXZlbnQsIG1lbnUpIHt9CiAgfSwge30pOwogIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAvKgogICAqICBUaGUgbWFpbiBtZW51IGNsYXNzCiAgICovCgogIHZhciBNRU5VID0gTWF0aEpheC5NZW51ID0gTkFWLlN1YmNsYXNzKHsKICAgIHZlcnNpb246IFZFUlNJT04sCiAgICBpdGVtczogW10sCiAgICBwb3N0ZWQ6IGZhbHNlLAogICAgdGl0bGU6IG51bGwsCiAgICBtYXJnaW46IDUsCiAgICBJbml0OiBmdW5jdGlvbiBJbml0KGRlZikgewogICAgICB0aGlzLml0ZW1zID0gW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDApOwogICAgfSwKICAgIFdpdGg6IGZ1bmN0aW9uIFdpdGgoZGVmKSB7CiAgICAgIGlmIChkZWYpIHsKICAgICAgICBIVUIuSW5zZXJ0KHRoaXMsIGRlZik7CiAgICAgIH0KCiAgICAgIDsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAoKICAgIC8qCiAgICAgKiAgRGlzcGxheSB0aGUgbWVudQogICAgICovCiAgICBQb3N0OiBmdW5jdGlvbiBQb3N0KGV2ZW50LCBwYXJlbnQsIGZvcmNlTFRSKSB7CiAgICAgIGlmICghZXZlbnQpIHsKICAgICAgICBldmVudCA9IHdpbmRvdy5ldmVudCB8fCB7fTsKICAgICAgfQoKICAgICAgdmFyIGRpdiA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJNYXRoSmF4X01lbnVGcmFtZSIpOwoKICAgICAgaWYgKCFkaXYpIHsKICAgICAgICBkaXYgPSBNRU5VLkJhY2tncm91bmQodGhpcyk7CiAgICAgICAgZGVsZXRlIElURU0ubGFzdEl0ZW07CiAgICAgICAgZGVsZXRlIElURU0ubGFzdE1lbnU7CiAgICAgICAgZGVsZXRlIE1FTlUuc2tpcFVwOwogICAgICAgIFNJR05BTC5Qb3N0KFsicG9zdCIsIE1FTlUuamF4XSk7CiAgICAgICAgTUVOVS5pc1JUTCA9IE1hdGhKYXguTG9jYWxpemF0aW9uLmZvbnREaXJlY3Rpb24oKSA9PT0gInJ0bCI7CiAgICAgIH0KCiAgICAgIHZhciBtZW51ID0gSFRNTC5FbGVtZW50KCJkaXYiLCB7CiAgICAgICAgb25tb3VzZXVwOiBNRU5VLk1vdXNldXAsCiAgICAgICAgb25kYmxjbGljazogRkFMU0UsCiAgICAgICAgb25kcmFnc3RhcnQ6IEZBTFNFLAogICAgICAgIG9uc2VsZWN0c3RhcnQ6IEZBTFNFLAogICAgICAgIG9uY29udGV4dG1lbnU6IEZBTFNFLAogICAgICAgIG1lbnVJdGVtOiB0aGlzLAogICAgICAgIGNsYXNzTmFtZTogIk1hdGhKYXhfTWVudSIsCiAgICAgICAgb25rZXlkb3duOiBNRU5VLktleWRvd24sCiAgICAgICAgcm9sZTogIm1lbnUiCiAgICAgIH0pOwogICAgICBpZiAoZXZlbnQudHlwZSA9PT0gImNvbnRleHRtZW51IiB8fCBldmVudC50eXBlID09PSAibW91c2VvdmVyIikgbWVudS5jbGFzc05hbWUgKz0gIiBNYXRoSmF4X0NvbnRleHRNZW51IjsKCiAgICAgIGlmICghZm9yY2VMVFIpIHsKICAgICAgICBNYXRoSmF4LkxvY2FsaXphdGlvbi5zZXRDU1MobWVudSk7CiAgICAgIH0KCiAgICAgIGZvciAodmFyIGkgPSAwLCBtID0gdGhpcy5pdGVtcy5sZW5ndGg7IGkgPCBtOyBpKyspIHsKICAgICAgICB0aGlzLml0ZW1zW2ldLkNyZWF0ZShtZW51KTsKICAgICAgfQoKICAgICAgaWYgKE1FTlUuaXNNb2JpbGUpIHsKICAgICAgICBIVE1MLmFkZEVsZW1lbnQobWVudSwgInNwYW4iLCB7CiAgICAgICAgICBjbGFzc05hbWU6ICJNYXRoSmF4X01lbnVDbG9zZSIsCiAgICAgICAgICBtZW51OiBwYXJlbnQsCiAgICAgICAgICBvbnRvdWNoc3RhcnQ6IE1FTlUuQ2xvc2UsCiAgICAgICAgICBvbnRvdWNoZW5kOiBGQUxTRSwKICAgICAgICAgIG9ubW91c2Vkb3duOiBNRU5VLkNsb3NlLAogICAgICAgICAgb25tb3VzZXVwOiBGQUxTRQogICAgICAgIH0sIFtbInNwYW4iLCB7fSwgIlx4RDciXV0pOwogICAgICB9CgogICAgICBkaXYuYXBwZW5kQ2hpbGQobWVudSk7CiAgICAgIHRoaXMucG9zdGVkID0gdHJ1ZTsKICAgICAgaWYgKG1lbnUub2Zmc2V0V2lkdGgpIG1lbnUuc3R5bGUud2lkdGggPSBtZW51Lm9mZnNldFdpZHRoICsgMiArICJweCI7CiAgICAgIHZhciB4ID0gZXZlbnQucGFnZVgsCiAgICAgICAgICB5ID0gZXZlbnQucGFnZVk7CgogICAgICBpZiAoIXggJiYgIXkgJiYgImNsaWVudFgiIGluIGV2ZW50KSB7CiAgICAgICAgeCA9IGV2ZW50LmNsaWVudFggKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgKyBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdDsKICAgICAgICB5ID0gZXZlbnQuY2xpZW50WSArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wICsgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbFRvcDsKICAgICAgfQoKICAgICAgaWYgKCFwYXJlbnQpIHsKICAgICAgICB2YXIgbm9kZSA9IE1FTlUuQ3VycmVudE5vZGUoKSB8fCBldmVudC50YXJnZXQ7CgogICAgICAgIGlmICgoZXZlbnQudHlwZSA9PT0gImtleWRvd24iIHx8ICF4ICYmICF5KSAmJiBub2RlKSB7CiAgICAgICAgICB2YXIgb2Zmc2V0WCA9IHdpbmRvdy5wYWdlWE9mZnNldCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdDsKICAgICAgICAgIHZhciBvZmZzZXRZID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7CiAgICAgICAgICB2YXIgcmVjdCA9IG5vZGUuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICB4ID0gKHJlY3QucmlnaHQgKyByZWN0LmxlZnQpIC8gMiArIG9mZnNldFg7CiAgICAgICAgICB5ID0gKHJlY3QuYm90dG9tICsgcmVjdC50b3ApIC8gMiArIG9mZnNldFk7CiAgICAgICAgfQoKICAgICAgICBpZiAoeCArIG1lbnUub2Zmc2V0V2lkdGggPiBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoIC0gdGhpcy5tYXJnaW4pIHsKICAgICAgICAgIHggPSBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoIC0gbWVudS5vZmZzZXRXaWR0aCAtIHRoaXMubWFyZ2luOwogICAgICAgIH0KCiAgICAgICAgaWYgKE1FTlUuaXNNb2JpbGUpIHsKICAgICAgICAgIHggPSBNYXRoLm1heCg1LCB4IC0gTWF0aC5mbG9vcihtZW51Lm9mZnNldFdpZHRoIC8gMikpOwogICAgICAgICAgeSAtPSAyMDsKICAgICAgICB9CgogICAgICAgIE1FTlUuc2tpcFVwID0gZXZlbnQuaXNDb250ZXh0TWVudTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgc2lkZSA9ICJsZWZ0IiwKICAgICAgICAgICAgbXcgPSBwYXJlbnQub2Zmc2V0V2lkdGg7CiAgICAgICAgeCA9IE1FTlUuaXNNb2JpbGUgPyAzMCA6IG13IC0gMjsKICAgICAgICB5ID0gMDsKCiAgICAgICAgd2hpbGUgKHBhcmVudCAmJiBwYXJlbnQgIT09IGRpdikgewogICAgICAgICAgeCArPSBwYXJlbnQub2Zmc2V0TGVmdDsKICAgICAgICAgIHkgKz0gcGFyZW50Lm9mZnNldFRvcDsKICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlOwogICAgICAgIH0KCiAgICAgICAgaWYgKCFNRU5VLmlzTW9iaWxlKSB7CiAgICAgICAgICBpZiAoTUVOVS5pc1JUTCAmJiB4IC0gbXcgLSBtZW51Lm9mZnNldFdpZHRoID4gdGhpcy5tYXJnaW4gfHwgIU1FTlUuaXNSVEwgJiYgeCArIG1lbnUub2Zmc2V0V2lkdGggPiBkb2N1bWVudC5ib2R5Lm9mZnNldFdpZHRoIC0gdGhpcy5tYXJnaW4pIHsKICAgICAgICAgICAgc2lkZSA9ICJyaWdodCI7CiAgICAgICAgICAgIHggPSBNYXRoLm1heCh0aGlzLm1hcmdpbiwgeCAtIG13IC0gbWVudS5vZmZzZXRXaWR0aCArIDYpOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKCFpc1BDKSB7CiAgICAgICAgICAvLyBpbiBjYXNlIHRoZXNlIGV2ZXIgZ2V0IGltcGxlbWVudGVkCiAgICAgICAgICBtZW51LnN0eWxlWyJib3JkZXJSYWRpdXNUb3AiICsgc2lkZV0gPSAwOyAvLyBPcGVyYSAxMC41CgogICAgICAgICAgbWVudS5zdHlsZVsiV2Via2l0Qm9yZGVyUmFkaXVzVG9wIiArIHNpZGVdID0gMDsgLy8gU2FmYXJpIGFuZCBDaHJvbWUKCiAgICAgICAgICBtZW51LnN0eWxlWyJNb3pCb3JkZXJSYWRpdXNUb3AiICsgc2lkZV0gPSAwOyAvLyBGaXJlZm94CgogICAgICAgICAgbWVudS5zdHlsZVsiS2h0bWxCb3JkZXJSYWRpdXNUb3AiICsgc2lkZV0gPSAwOyAvLyBLb25xdWVyb3IKICAgICAgICB9CiAgICAgIH0KCiAgICAgIG1lbnUuc3R5bGUubGVmdCA9IHggKyAicHgiOwogICAgICBtZW51LnN0eWxlLnRvcCA9IHkgKyAicHgiOwoKICAgICAgaWYgKGRvY3VtZW50LnNlbGVjdGlvbiAmJiBkb2N1bWVudC5zZWxlY3Rpb24uZW1wdHkpIHsKICAgICAgICBkb2N1bWVudC5zZWxlY3Rpb24uZW1wdHkoKTsKICAgICAgfSAvLyBGb2N1c2luZyB3aGlsZSBrZWVwaW5nIHRoZSBzY3JvbGwgcG9zaXRpb24uCgoKICAgICAgdmFyIG9sZFggPSB3aW5kb3cucGFnZVhPZmZzZXQgfHwgZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQ7CiAgICAgIHZhciBvbGRZID0gd2luZG93LnBhZ2VZT2Zmc2V0IHx8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5zY3JvbGxUb3A7CiAgICAgIE1FTlUuRm9jdXMobWVudSk7CgogICAgICBpZiAoZXZlbnQudHlwZSA9PT0gImtleWRvd24iKSB7CiAgICAgICAgTUVOVS5za2lwTW91c2VvdmVyRnJvbUtleSA9IHRydWU7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBkZWxldGUgTUVOVS5za2lwTW91c2VvdmVyRnJvbUtleTsKICAgICAgICB9LCBDT05GSUcuZGVsYXkpOwogICAgICB9CgogICAgICB3aW5kb3cuc2Nyb2xsVG8ob2xkWCwgb2xkWSk7CiAgICAgIHJldHVybiBGQUxTRShldmVudCk7CiAgICB9LAoKICAgIC8qCiAgICAgKiAgUmVtb3ZlIHRoZSBtZW51IGZyb20gdGhlIHNjcmVlbgogICAgICovCiAgICBSZW1vdmU6IGZ1bmN0aW9uIFJlbW92ZShldmVudCwgbWVudSkgewogICAgICBTSUdOQUwuUG9zdChbInVucG9zdCIsIE1FTlUuamF4XSk7CiAgICAgIHZhciBkaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTWF0aEpheF9NZW51RnJhbWUiKTsKCiAgICAgIGlmIChkaXYpIHsKICAgICAgICBkaXYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChkaXYpOwoKICAgICAgICBpZiAodGhpcy5tc2llRml4ZWRQb3NpdGlvbkJ1ZykgewogICAgICAgICAgZGV0YWNoRXZlbnQoIm9ucmVzaXplIiwgTUVOVS5SZXNpemUpOwogICAgICAgIH0KICAgICAgfQoKICAgICAgaWYgKE1FTlUuamF4LmhvdmVyKSB7CiAgICAgICAgZGVsZXRlIE1FTlUuamF4LmhvdmVyLm5vZmFkZTsKICAgICAgICBIT1ZFUi5VbkhvdmVyKE1FTlUuamF4KTsKICAgICAgfQoKICAgICAgTUVOVS5VbmZvY3VzKG1lbnUpOwogICAgICBpZiAoZXZlbnQudHlwZSA9PT0gIm1vdXNlZG93biIpIE1FTlUuQ3VycmVudE5vZGUoKS5ibHVyKCk7CiAgICAgIHJldHVybiBGQUxTRShldmVudCk7CiAgICB9LAoKICAgIC8qCiAgICAgKiAgRmluZCBhbiBpdGVtIGluIGEgbWVudSAob3Igc3VibWVudSkgYnkgbmFtZSAoRmluZCkgb3IgSUQgKEZpbmRJRCkuCiAgICAgKiAgQSBsaXN0IG9mIG5hbWVzIG9yIElEcyBtZWFucyBkZXNjZW5kIGludG8gc3VibWVudXMuCiAgICAgKi8KICAgIEZpbmQ6IGZ1bmN0aW9uIEZpbmQobmFtZSkgewogICAgICByZXR1cm4gdGhpcy5GaW5kTigxLCBuYW1lLCBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpOwogICAgfSwKICAgIEZpbmRJZDogZnVuY3Rpb24gRmluZElkKG5hbWUpIHsKICAgICAgcmV0dXJuIHRoaXMuRmluZE4oMCwgbmFtZSwgW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTsKICAgIH0sCiAgICBGaW5kTjogZnVuY3Rpb24gRmluZE4obiwgbmFtZSwgbmFtZXMpIHsKICAgICAgZm9yICh2YXIgaSA9IDAsIG0gPSB0aGlzLml0ZW1zLmxlbmd0aDsgaSA8IG07IGkrKykgewogICAgICAgIGlmICh0aGlzLml0ZW1zW2ldLm5hbWVbbl0gPT09IG5hbWUpIHsKICAgICAgICAgIGlmIChuYW1lcy5sZW5ndGgpIHsKICAgICAgICAgICAgaWYgKCF0aGlzLml0ZW1zW2ldLnN1Ym1lbnUpIHsKICAgICAgICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHRoaXMuaXRlbXNbaV0uc3VibWVudS5GaW5kTihuLCBuYW1lc1swXSwgbmFtZXMuc2xpY2UoMSkpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiB0aGlzLml0ZW1zW2ldOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIG51bGw7CiAgICB9LAoKICAgIC8qCiAgICAgKiAgRmluZCB0aGUgaW5kZXggb2YgYSBtZW51IGl0ZW0gKHNvIHdlIGNhbiBpbnNlcnQgYmVmb3JlIG9yIGFmdGVyIGl0KQogICAgICovCiAgICBJbmRleE9mOiBmdW5jdGlvbiBJbmRleE9mKG5hbWUpIHsKICAgICAgcmV0dXJuIHRoaXMuSW5kZXhPZk4oMSwgbmFtZSk7CiAgICB9LAogICAgSW5kZXhPZklkOiBmdW5jdGlvbiBJbmRleE9mSWQobmFtZSkgewogICAgICByZXR1cm4gdGhpcy5JbmRleE9mTigwLCBuYW1lKTsKICAgIH0sCiAgICBJbmRleE9mTjogZnVuY3Rpb24gSW5kZXhPZk4obiwgbmFtZSkgewogICAgICBmb3IgKHZhciBpID0gMCwgbSA9IHRoaXMuaXRlbXMubGVuZ3RoOyBpIDwgbTsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXMuaXRlbXNbaV0ubmFtZVtuXSA9PT0gbmFtZSkgewogICAgICAgICAgcmV0dXJuIGk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gbnVsbDsKICAgIH0sCiAgICBSaWdodDogZnVuY3Rpb24gUmlnaHQoZXZlbnQsIG1lbnUpIHsKICAgICAgTUVOVS5SaWdodChldmVudCwgbWVudSk7CiAgICB9LAogICAgTGVmdDogZnVuY3Rpb24gTGVmdChldmVudCwgbWVudSkgewogICAgICBNRU5VLkxlZnQoZXZlbnQsIG1lbnUpOwogICAgfSwKICAgIFVwOiBmdW5jdGlvbiBVcChldmVudCwgbWVudSkgewogICAgICB2YXIgbm9kZSA9IG1lbnUubGFzdENoaWxkOwogICAgICBub2RlLm1lbnVJdGVtLkFjdGl2YXRlKGV2ZW50LCBub2RlKTsKICAgIH0sCiAgICBEb3duOiBmdW5jdGlvbiBEb3duKGV2ZW50LCBtZW51KSB7CiAgICAgIHZhciBub2RlID0gbWVudS5maXJzdENoaWxkOwogICAgICBub2RlLm1lbnVJdGVtLkFjdGl2YXRlKGV2ZW50LCBub2RlKTsKICAgIH0sCiAgICBTcGFjZTogZnVuY3Rpb24gU3BhY2UoZXZlbnQsIG1lbnUpIHsKICAgICAgdGhpcy5SZW1vdmUoZXZlbnQsIG1lbnUpOwogICAgfQogIH0sIHsKICAgIGNvbmZpZzogQ09ORklHLAogICAgUmVtb3ZlOiBmdW5jdGlvbiBSZW1vdmUoZXZlbnQpIHsKICAgICAgcmV0dXJuIE1FTlUuRXZlbnQoZXZlbnQsIHRoaXMsICJSZW1vdmUiKTsKICAgIH0sCiAgICBNb3VzZW92ZXI6IGZ1bmN0aW9uIE1vdXNlb3ZlcihldmVudCkgewogICAgICByZXR1cm4gTUVOVS5FdmVudChldmVudCwgdGhpcywgIk1vdXNlb3ZlciIpOwogICAgfSwKICAgIE1vdXNlb3V0OiBmdW5jdGlvbiBNb3VzZW91dChldmVudCkgewogICAgICByZXR1cm4gTUVOVS5FdmVudChldmVudCwgdGhpcywgIk1vdXNlb3V0Iik7CiAgICB9LAogICAgTW91c2Vkb3duOiBmdW5jdGlvbiBNb3VzZWRvd24oZXZlbnQpIHsKICAgICAgcmV0dXJuIE1FTlUuRXZlbnQoZXZlbnQsIHRoaXMsICJNb3VzZWRvd24iKTsKICAgIH0sCiAgICBNb3VzZXVwOiBmdW5jdGlvbiBNb3VzZXVwKGV2ZW50KSB7CiAgICAgIHJldHVybiBNRU5VLkV2ZW50KGV2ZW50LCB0aGlzLCAiTW91c2V1cCIpOwogICAgfSwKICAgIEtleWRvd246IGZ1bmN0aW9uIEtleWRvd24oZXZlbnQpIHsKICAgICAgcmV0dXJuIE1FTlUuRXZlbnQoZXZlbnQsIHRoaXMsICJLZXlkb3duIik7CiAgICB9LAoKICAgIC8qCiAgICAgKiAgRXZlbnRzIGZvciBtb2JpbGUgZGV2aWNlcy4KICAgICAqLwogICAgVG91Y2hzdGFydDogZnVuY3Rpb24gVG91Y2hzdGFydChldmVudCkgewogICAgICByZXR1cm4gTUVOVS5FdmVudChldmVudCwgdGhpcywgIlRvdWNoc3RhcnQiKTsKICAgIH0sCiAgICBUb3VjaGVuZDogZnVuY3Rpb24gVG91Y2hlbmQoZXZlbnQpIHsKICAgICAgcmV0dXJuIE1FTlUuRXZlbnQoZXZlbnQsIHRoaXMsICJUb3VjaGVuZCIpOwogICAgfSwKICAgIENsb3NlOiBmdW5jdGlvbiBDbG9zZShldmVudCkgewogICAgICByZXR1cm4gTUVOVS5FdmVudChldmVudCwgdGhpcy5tZW51IHx8IHRoaXMucGFyZW50Tm9kZSwgdGhpcy5tZW51ID8gIlRvdWNoZW5kIiA6ICJSZW1vdmUiKTsKICAgIH0sCiAgICBFdmVudDogZnVuY3Rpb24gRXZlbnQoZXZlbnQsIG1lbnUsIHR5cGUsIGZvcmNlKSB7CiAgICAgIGlmIChNRU5VLnNraXBNb3VzZW92ZXIgJiYgdHlwZSA9PT0gIk1vdXNlb3ZlciIgJiYgIWZvcmNlKSB7CiAgICAgICAgcmV0dXJuIEZBTFNFKGV2ZW50KTsKICAgICAgfQoKICAgICAgaWYgKE1FTlUuc2tpcE1vdXNlb3ZlckZyb21LZXkgJiYgdHlwZSA9PT0gIk1vdXNlb3ZlciIpIHsKICAgICAgICBkZWxldGUgTUVOVS5za2lwTW91c2VvdmVyRnJvbUtleTsKICAgICAgICByZXR1cm4gRkFMU0UoZXZlbnQpOwogICAgICB9CgogICAgICBpZiAoTUVOVS5za2lwVXApIHsKICAgICAgICBpZiAodHlwZS5tYXRjaCgvTW91c2V1cHxUb3VjaGVuZC8pKSB7CiAgICAgICAgICBkZWxldGUgTUVOVS5za2lwVXA7CiAgICAgICAgICByZXR1cm4gRkFMU0UoZXZlbnQpOwogICAgICAgIH0KCiAgICAgICAgaWYgKHR5cGUgPT09ICJUb3VjaHN0YXJ0IiB8fCB0eXBlID09PSAiTW91c2Vkb3duIiAmJiAhTUVOVS5za2lwTW91c2Vkb3duKSB7CiAgICAgICAgICBkZWxldGUgTUVOVS5za2lwVXA7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoIWV2ZW50KSB7CiAgICAgICAgZXZlbnQgPSB3aW5kb3cuZXZlbnQ7CiAgICAgIH0KCiAgICAgIHZhciBpdGVtID0gbWVudS5tZW51SXRlbTsKCiAgICAgIGlmIChpdGVtICYmIGl0ZW1bdHlwZV0pIHsKICAgICAgICByZXR1cm4gaXRlbVt0eXBlXShldmVudCwgbWVudSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBudWxsOwogICAgfSwKCiAgICAvKgogICAgICogIFN0eWxlIGZvciB0aGUgYmFja2dyb3VuZCBESVYKICAgICAqLwogICAgQkdTVFlMRTogewogICAgICBwb3NpdGlvbjogImFic29sdXRlIiwKICAgICAgbGVmdDogMCwKICAgICAgdG9wOiAwLAogICAgICAiei1pbmRleCI6IDIwMCwKICAgICAgd2lkdGg6ICIxMDAlIiwKICAgICAgaGVpZ2h0OiAiMTAwJSIsCiAgICAgIGJvcmRlcjogMCwKICAgICAgcGFkZGluZzogMCwKICAgICAgbWFyZ2luOiAwCiAgICB9LAogICAgQmFja2dyb3VuZDogZnVuY3Rpb24gQmFja2dyb3VuZChtZW51KSB7CiAgICAgIHZhciBkaXYgPSBIVE1MLmFkZEVsZW1lbnQoZG9jdW1lbnQuYm9keSwgImRpdiIsIHsKICAgICAgICBzdHlsZTogdGhpcy5CR1NUWUxFLAogICAgICAgIGlkOiAiTWF0aEpheF9NZW51RnJhbWUiCiAgICAgIH0sIFtbImRpdiIsIHsKICAgICAgICBzdHlsZTogdGhpcy5CR1NUWUxFLAogICAgICAgIG1lbnVJdGVtOiBtZW51LAogICAgICAgIG9ubW91c2Vkb3duOiB0aGlzLlJlbW92ZQogICAgICB9XV0pOwogICAgICB2YXIgYmcgPSBkaXYuZmlyc3RDaGlsZDsKCiAgICAgIGlmIChNRU5VLm1zaWVCYWNrZ3JvdW5kQnVnKSB7CiAgICAgICAgLy8gIE1TSUUgZG9lc24ndCBhbGxvdyB0cmFuc3BhcmVudCBiYWNrZ3JvdW5kIHRvIGJlIGhpdCBib3hlcywgc28KICAgICAgICAvLyAgZmFrZSBpdCB1c2luZyBvcGFjaXR5IHdpdGggc29saWQgYmFja2dyb3VuZCBjb2xvcgogICAgICAgIGJnLnN0eWxlLmJhY2tncm91bmRDb2xvciA9ICJ3aGl0ZSI7CiAgICAgICAgYmcuc3R5bGUuZmlsdGVyID0gImFscGhhKG9wYWNpdHk9MCkiOwogICAgICB9CgogICAgICBpZiAoTUVOVS5tc2llRml4ZWRQb3NpdGlvbkJ1ZykgewogICAgICAgIC8vICBNU0lFIGNhbid0IGRvIGZpeGVkIHBvc2l0aW9uLCBzbyB1c2UgYSBmdWxsLXNpemVkIGJhY2tncm91bmQKICAgICAgICAvLyAgYW5kIGFuIG9ucmVzaXplIGhhbmRsZXIgdG8gdXBkYXRlIGl0IChzdHVwaWQsIGJ1dCBuZWNlc3NhcnkpCiAgICAgICAgZGl2LndpZHRoID0gZGl2LmhlaWdodCA9IDA7CiAgICAgICAgdGhpcy5SZXNpemUoKTsKICAgICAgICBhdHRhY2hFdmVudCgib25yZXNpemUiLCB0aGlzLlJlc2l6ZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gb3RoZXJ3aXNlLCB1c2UgYSBmaXhlZCBwb3NpdGlvbiBESVYgdG8gY292ZXIgdGhlIHZpZXdwb3J0CiAgICAgICAgYmcuc3R5bGUucG9zaXRpb24gPSAiZml4ZWQiOwogICAgICB9CgogICAgICByZXR1cm4gZGl2OwogICAgfSwKICAgIFJlc2l6ZTogZnVuY3Rpb24gUmVzaXplKCkgewogICAgICBzZXRUaW1lb3V0KE1FTlUuU2V0V0gsIDApOwogICAgfSwKICAgIFNldFdIOiBmdW5jdGlvbiBTZXRXSCgpIHsKICAgICAgdmFyIGJnID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIk1hdGhKYXhfTWVudUZyYW1lIik7CgogICAgICBpZiAoYmcpIHsKICAgICAgICBiZyA9IGJnLmZpcnN0Q2hpbGQ7CiAgICAgICAgYmcuc3R5bGUud2lkdGggPSBiZy5zdHlsZS5oZWlnaHQgPSAiMXB4IjsgLy8gc28gc2Nyb2xsV2lkdGgvSGVpZ2h0IHdpbGwgYmUgcmlnaHQgYmVsb3cKCiAgICAgICAgYmcuc3R5bGUud2lkdGggPSBkb2N1bWVudC5ib2R5LnNjcm9sbFdpZHRoICsgInB4IjsKICAgICAgICBiZy5zdHlsZS5oZWlnaHQgPSBkb2N1bWVudC5ib2R5LnNjcm9sbEhlaWdodCArICJweCI7CiAgICAgIH0KICAgIH0sCgogICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogICAgLyoKICAgICAqICBLZXlib2FyZCBuYXZpZ2F0aW9uIG9mIG1lbnUuCiAgICAgKi8KICAgIHBvc3RlZDogZmFsc2UsCiAgICAvLyBJcyBhIG1lbnUgb3Blbj8KICAgIGFjdGl2ZTogbnVsbCwKICAgIC8vIFRoZSBmb2N1c2VkIGluIEhUTUwgbm9kZSBpbiB0aGUgbWVudS4KICAgIEdldE5vZGU6IGZ1bmN0aW9uIEdldE5vZGUoamF4KSB7CiAgICAgIHZhciBub2RlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoamF4LmlucHV0SUQgKyAiLUZyYW1lIik7CiAgICAgIHJldHVybiBub2RlLmlzTWF0aEpheCA/IG5vZGUgOiBub2RlLmZpcnN0Q2hpbGQ7CiAgICB9LAogICAgQ3VycmVudE5vZGU6IGZ1bmN0aW9uIEN1cnJlbnROb2RlKCkgewogICAgICByZXR1cm4gTUVOVS5HZXROb2RlKE1FTlUuamF4KTsKICAgIH0sCiAgICBBbGxOb2RlczogZnVuY3Rpb24gQWxsTm9kZXMoKSB7CiAgICAgIHZhciBqYXhzID0gTWF0aEpheC5IdWIuZ2V0QWxsSmF4KCk7CiAgICAgIHZhciBub2RlcyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGpheDsgamF4ID0gamF4c1tpXTsgaSsrKSB7CiAgICAgICAgbm9kZXMucHVzaChNRU5VLkdldE5vZGUoamF4KSk7CiAgICAgIH0KCiAgICAgIHJldHVybiBub2RlczsKICAgIH0sCiAgICBBY3RpdmVOb2RlOiBmdW5jdGlvbiBBY3RpdmVOb2RlKCkgewogICAgICByZXR1cm4gTUVOVS5hY3RpdmU7CiAgICB9LAogICAgRm9jdXNOb2RlOiBmdW5jdGlvbiBGb2N1c05vZGUobm9kZSkgewogICAgICBNRU5VLmFjdGl2ZSA9IG5vZGU7CiAgICAgIG5vZGUuZm9jdXMoKTsKICAgIH0sCiAgICAvLwogICAgLy8gRm9jdXMgaXMgYSBnbG9iYWwgYWZmYWlyLCBzaW5jZSB3ZSBvbmx5IGV2ZXIgd2FudCBhIHNpbmdsZSBmb2N1c2VkIGl0ZW0uCiAgICAvLwogICAgRm9jdXM6IGZ1bmN0aW9uIEZvY3VzKG1lbnUpIHsKICAgICAgIU1FTlUucG9zdGVkID8gTUVOVS5BY3RpdmF0ZShtZW51KSA6IE1FTlUuQWN0aXZlTm9kZSgpLnRhYkluZGV4ID0gLTE7CiAgICAgIG1lbnUudGFiSW5kZXggPSAwOwogICAgICBNRU5VLkZvY3VzTm9kZShtZW51KTsKICAgIH0sCiAgICBBY3RpdmF0ZTogZnVuY3Rpb24gQWN0aXZhdGUoZXZlbnQsIG1lbnUpIHsKICAgICAgTUVOVS5VbnNldFRhYkluZGV4KCk7CiAgICAgIE1FTlUucG9zdGVkID0gdHJ1ZTsKICAgIH0sCiAgICBVbmZvY3VzOiBmdW5jdGlvbiBVbmZvY3VzKCkgewogICAgICBNRU5VLkFjdGl2ZU5vZGUoKS50YWJJbmRleCA9IC0xOwogICAgICBNRU5VLlNldFRhYkluZGV4KCk7CiAgICAgIE1FTlUuRm9jdXNOb2RlKE1FTlUuQ3VycmVudE5vZGUoKSk7CiAgICAgIE1FTlUucG9zdGVkID0gZmFsc2U7CiAgICB9LAogICAgTW92ZUhvcml6b250YWw6IGZ1bmN0aW9uIE1vdmVIb3Jpem9udGFsKGV2ZW50LCBtZW51LCBtb3ZlKSB7CiAgICAgIGlmICghZXZlbnQuc2hpZnRLZXkpIHJldHVybjsKICAgICAgdmFyIGpheHMgPSBNRU5VLkFsbE5vZGVzKCk7CiAgICAgIHZhciBsZW4gPSBqYXhzLmxlbmd0aDsKICAgICAgaWYgKGxlbiA9PT0gMCkgcmV0dXJuOwogICAgICB2YXIgbmV4dCA9IGpheHNbTUVOVS5Nb2QobW92ZShNRU5VLkluZGV4T2YoamF4cywgTUVOVS5DdXJyZW50Tm9kZSgpKSksIGxlbildOwogICAgICBpZiAobmV4dCA9PT0gTUVOVS5DdXJyZW50Tm9kZSgpKSByZXR1cm47CiAgICAgIE1FTlUubWVudS5SZW1vdmUoZXZlbnQsIG1lbnUpOwogICAgICBNRU5VLmpheCA9IE1hdGhKYXguSHViLmdldEpheEZvcihuZXh0KTsKICAgICAgTUVOVS5Gb2N1c05vZGUobmV4dCk7CiAgICAgIE1FTlUubWVudS5Qb3N0KG51bGwpOwogICAgfSwKICAgIFJpZ2h0OiBmdW5jdGlvbiBSaWdodChldmVudCwgbWVudSkgewogICAgICBNRU5VLk1vdmVIb3Jpem9udGFsKGV2ZW50LCBtZW51LCBmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4ICsgMTsKICAgICAgfSk7CiAgICB9LAogICAgTGVmdDogZnVuY3Rpb24gTGVmdChldmVudCwgbWVudSkgewogICAgICBNRU5VLk1vdmVIb3Jpem9udGFsKGV2ZW50LCBtZW51LCBmdW5jdGlvbiAoeCkgewogICAgICAgIHJldHVybiB4IC0gMTsKICAgICAgfSk7CiAgICB9LAogICAgVW5zZXRUYWJJbmRleDogZnVuY3Rpb24gVW5zZXRUYWJJbmRleCgpIHsKICAgICAgdmFyIGpheHMgPSBNRU5VLkFsbE5vZGVzKCk7CgogICAgICBmb3IgKHZhciBqID0gMCwgamF4OyBqYXggPSBqYXhzW2pdOyBqKyspIHsKICAgICAgICBpZiAoamF4LnRhYkluZGV4ID4gMCkgewogICAgICAgICAgamF4Lm9sZFRhYkluZGV4ID0gamF4LnRhYkluZGV4OwogICAgICAgIH0KCiAgICAgICAgamF4LnRhYkluZGV4ID0gLTE7CiAgICAgIH0KICAgIH0sCiAgICBTZXRUYWJJbmRleDogZnVuY3Rpb24gU2V0VGFiSW5kZXgoKSB7CiAgICAgIHZhciBqYXhzID0gTUVOVS5BbGxOb2RlcygpOwoKICAgICAgZm9yICh2YXIgaiA9IDAsIGpheDsgamF4ID0gamF4c1tqXTsgaisrKSB7CiAgICAgICAgaWYgKGpheC5vbGRUYWJJbmRleCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBqYXgudGFiSW5kZXggPSBqYXgub2xkVGFiSW5kZXg7CiAgICAgICAgICBkZWxldGUgamF4Lm9sZFRhYkluZGV4OwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBqYXgudGFiSW5kZXggPSBIVUIuZ2V0VGFiT3JkZXIoamF4KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvL1RPRE86IE1vdmUgdG8gdXRpbGl0eSBjbGFzcy4KICAgIC8vIENvbXB1dGVzIGEgbW9kIG4uCiAgICBNb2Q6IGZ1bmN0aW9uIE1vZChhLCBuKSB7CiAgICAgIHJldHVybiAoYSAlIG4gKyBuKSAlIG47CiAgICB9LAogICAgSW5kZXhPZjogQXJyYXkucHJvdG90eXBlLmluZGV4T2YgPyBmdW5jdGlvbiAoQSwgaXRlbSwgc3RhcnQpIHsKICAgICAgcmV0dXJuIEEuaW5kZXhPZihpdGVtLCBzdGFydCk7CiAgICB9IDogZnVuY3Rpb24gKEEsIGl0ZW0sIHN0YXJ0KSB7CiAgICAgIGZvciAodmFyIGkgPSBzdGFydCB8fCAwLCBqID0gQS5sZW5ndGg7IGkgPCBqOyBpKyspIHsKICAgICAgICBpZiAoaXRlbSA9PT0gQVtpXSkgcmV0dXJuIGk7CiAgICAgIH0KCiAgICAgIHJldHVybiAtMTsKICAgIH0sCiAgICBzYXZlQ29va2llOiBmdW5jdGlvbiBzYXZlQ29va2llKCkgewogICAgICBIVE1MLkNvb2tpZS5TZXQoIm1lbnUiLCB0aGlzLmNvb2tpZSk7CiAgICB9LAogICAgZ2V0Q29va2llOiBmdW5jdGlvbiBnZXRDb29raWUoKSB7CiAgICAgIHRoaXMuY29va2llID0gSFRNTC5Db29raWUuR2V0KCJtZW51Iik7CiAgICB9CiAgfSk7CiAgTWF0aEpheC5NZW51Lk5BViA9IE5BVjsKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCiAgLyoKICAgKiAgQWJzdHJhY3QgY2xhc3Mgb2YgbWVudSBpdGVtcy4KICAgKi8KCiAgdmFyIElURU0gPSBNRU5VLklURU0gPSBOQVYuU3ViY2xhc3MoewogICAgbmFtZTogIiIsCiAgICAvLyBUaGUgbWVudSBpdGVtJ3MgbGFiZWwgYXMgW2lkLGxhYmVsXSBwYWlyLgogICAgbm9kZTogbnVsbCwKICAgIC8vIFRoZSBIVE1MIG5vZGUgb2YgdGhlIGl0ZW0uCiAgICBtZW51OiBudWxsLAogICAgLy8gVGhlIHBhcmVudCBtZW51IGNvbnRhaW5pbmcgdGhhdCBpdGVtLiBIVE1MIG5vZGUuCiAgICBBdHRyaWJ1dGVzOiBmdW5jdGlvbiBBdHRyaWJ1dGVzKGRlZikgewogICAgICByZXR1cm4gSFVCLkluc2VydCh7CiAgICAgICAgb25tb3VzZXVwOiBNRU5VLk1vdXNldXAsCiAgICAgICAgb25kcmFnc3RhcnQ6IEZBTFNFLAogICAgICAgIG9uc2VsZWN0c3RhcnQ6IEZBTFNFLAogICAgICAgIG9uc2VsZWN0ZW5kOiBGQUxTRSwKICAgICAgICBvbnRvdWNoc3RhcnQ6IE1FTlUuVG91Y2hzdGFydCwKICAgICAgICBvbnRvdWNoZW5kOiBNRU5VLlRvdWNoZW5kLAogICAgICAgIGNsYXNzTmFtZTogIk1hdGhKYXhfTWVudUl0ZW0iLAogICAgICAgIHJvbGU6IHRoaXMucm9sZSwKICAgICAgICBtZW51SXRlbTogdGhpcwogICAgICB9LCBkZWYpOwogICAgfSwKICAgIENyZWF0ZTogZnVuY3Rpb24gQ3JlYXRlKG1lbnUpIHsKICAgICAgaWYgKCF0aGlzLmhpZGRlbikgewogICAgICAgIHZhciBkZWYgPSB0aGlzLkF0dHJpYnV0ZXMoKTsKICAgICAgICB2YXIgbGFiZWwgPSB0aGlzLkxhYmVsKGRlZiwgbWVudSk7CiAgICAgICAgSFRNTC5hZGRFbGVtZW50KG1lbnUsICJkaXYiLCBkZWYsIGxhYmVsKTsKICAgICAgfQogICAgfSwKICAgIE5hbWU6IGZ1bmN0aW9uIE5hbWUoKSB7CiAgICAgIHJldHVybiBfKHRoaXMubmFtZVswXSwgdGhpcy5uYW1lWzFdKTsKICAgIH0sCiAgICBNb3VzZW92ZXI6IGZ1bmN0aW9uIE1vdXNlb3ZlcihldmVudCwgbWVudSkgewogICAgICBpZiAobWVudS5wYXJlbnROb2RlID09PSBNRU5VLkFjdGl2ZU5vZGUoKS5wYXJlbnROb2RlKSB7CiAgICAgICAgdGhpcy5EZWFjdGl2YXRlKE1FTlUuQWN0aXZlTm9kZSgpKTsKICAgICAgfQoKICAgICAgdGhpcy5BY3RpdmF0ZShldmVudCwgbWVudSk7CiAgICB9LAogICAgTW91c2VvdXQ6IGZ1bmN0aW9uIE1vdXNlb3V0KGV2ZW50LCBtZW51KSB7CiAgICAgIHRoaXMuRGVhY3RpdmF0ZShtZW51KTsKICAgIH0sCiAgICBNb3VzZXVwOiBmdW5jdGlvbiBNb3VzZXVwKGV2ZW50LCBtZW51KSB7CiAgICAgIHJldHVybiB0aGlzLlJlbW92ZShldmVudCwgbWVudSk7CiAgICB9LAogICAgRGVhY3RpdmF0ZVN1Ym1lbnVzOiBmdW5jdGlvbiBEZWFjdGl2YXRlU3VibWVudXMobWVudSkgewogICAgICB2YXIgbWVudXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTWF0aEpheF9NZW51RnJhbWUiKS5jaGlsZE5vZGVzLAogICAgICAgICAgaXRlbXMgPSBJVEVNLkdldE1lbnVOb2RlKG1lbnUpLmNoaWxkTm9kZXM7CgogICAgICBmb3IgKHZhciBpID0gMCwgbSA9IGl0ZW1zLmxlbmd0aDsgaSA8IG07IGkrKykgewogICAgICAgIHZhciBpdGVtID0gaXRlbXNbaV0ubWVudUl0ZW07IC8vIERlYWN0aXZhdGVzIHN1Ym1lbnUgaXRlbXMuCgogICAgICAgIGlmIChpdGVtICYmIGl0ZW0uc3VibWVudSAmJiBpdGVtLnN1Ym1lbnUucG9zdGVkICYmIGl0ZW0gIT09IG1lbnUubWVudUl0ZW0pIHsKICAgICAgICAgIGl0ZW0uRGVhY3RpdmF0ZShpdGVtc1tpXSk7CiAgICAgICAgfQogICAgICB9CgogICAgICB0aGlzLlJlbW92ZVN1Ym1lbnVzKG1lbnUsIG1lbnVzKTsKICAgIH0sCiAgICBSZW1vdmVTdWJtZW51czogZnVuY3Rpb24gUmVtb3ZlU3VibWVudXMobWVudSwgbWVudXMpIHsKICAgICAgbWVudXMgPSBtZW51cyB8fCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiTWF0aEpheF9NZW51RnJhbWUiKS5jaGlsZE5vZGVzOwogICAgICB2YXIgbSA9IG1lbnVzLmxlbmd0aCAtIDE7CgogICAgICB3aGlsZSAobSA+PSAwICYmIElURU0uR2V0TWVudU5vZGUobWVudSkubWVudUl0ZW0gIT09IG1lbnVzW21dLm1lbnVJdGVtKSB7CiAgICAgICAgbWVudXNbbV0ubWVudUl0ZW0ucG9zdGVkID0gZmFsc2U7CiAgICAgICAgbWVudXNbbV0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChtZW51c1ttXSk7CiAgICAgICAgbS0tOwogICAgICB9CiAgICB9LAogICAgVG91Y2hzdGFydDogZnVuY3Rpb24gVG91Y2hzdGFydChldmVudCwgbWVudSkgewogICAgICByZXR1cm4gdGhpcy5Ub3VjaEV2ZW50KGV2ZW50LCBtZW51LCAiTW91c2Vkb3duIik7CiAgICB9LAogICAgVG91Y2hlbmQ6IGZ1bmN0aW9uIFRvdWNoZW5kKGV2ZW50LCBtZW51KSB7CiAgICAgIHJldHVybiB0aGlzLlRvdWNoRXZlbnQoZXZlbnQsIG1lbnUsICJNb3VzZXVwIik7CiAgICB9LAogICAgVG91Y2hFdmVudDogZnVuY3Rpb24gVG91Y2hFdmVudChldmVudCwgbWVudSwgdHlwZSkgewogICAgICBpZiAodGhpcyAhPT0gSVRFTS5sYXN0SXRlbSkgewogICAgICAgIGlmIChJVEVNLmxhc3RNZW51KSB7CiAgICAgICAgICBNRU5VLkV2ZW50KGV2ZW50LCBJVEVNLmxhc3RNZW51LCAiTW91c2VvdXQiKTsKICAgICAgICB9CgogICAgICAgIE1FTlUuRXZlbnQoZXZlbnQsIG1lbnUsICJNb3VzZW92ZXIiLCB0cnVlKTsKICAgICAgICBJVEVNLmxhc3RJdGVtID0gdGhpczsKICAgICAgICBJVEVNLmxhc3RNZW51ID0gbWVudTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubmF0aXZlVG91Y2gpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQoKICAgICAgTUVOVS5FdmVudChldmVudCwgbWVudSwgdHlwZSk7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICBSZW1vdmU6IGZ1bmN0aW9uIFJlbW92ZShldmVudCwgbWVudSkgewogICAgICBtZW51ID0gbWVudS5wYXJlbnROb2RlLm1lbnVJdGVtOwogICAgICByZXR1cm4gbWVudS5SZW1vdmUoZXZlbnQsIG1lbnUpOwogICAgfSwKICAgIFdpdGg6IGZ1bmN0aW9uIFdpdGgoZGVmKSB7CiAgICAgIGlmIChkZWYpIHsKICAgICAgICBIVUIuSW5zZXJ0KHRoaXMsIGRlZik7CiAgICAgIH0KCiAgICAgIDsKICAgICAgcmV0dXJuIHRoaXM7CiAgICB9LAogICAgaXNSVEw6IGZ1bmN0aW9uIGlzUlRMKCkgewogICAgICByZXR1cm4gTUVOVS5pc1JUTDsKICAgIH0sCiAgICBydGxDbGFzczogZnVuY3Rpb24gcnRsQ2xhc3MoKSB7CiAgICAgIHJldHVybiB0aGlzLmlzUlRMKCkgPyAiIFJUTCIgOiAiIjsKICAgIH0KICB9LCB7CiAgICBHZXRNZW51Tm9kZTogZnVuY3Rpb24gR2V0TWVudU5vZGUoaXRlbSkgewogICAgICByZXR1cm4gaXRlbS5wYXJlbnROb2RlOwogICAgfQogIH0pOwogIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAvKgogICAqICBBYnN0cmFjdCBjbGFzcyBvZiBtZW51IGl0ZW1zIHRoYXQgYXJlIGZvY3VzYWJsZSBhbmQgcGVyZm9ybSBzb21lIGFjdGlvbgogICAqLwoKICBNRU5VLkVOVFJZID0gTUVOVS5JVEVNLlN1YmNsYXNzKHsKICAgIHJvbGU6ICJtZW51aXRlbSIsCiAgICAvLyBBcmlhIHJvbGUuCiAgICBBdHRyaWJ1dGVzOiBmdW5jdGlvbiBBdHRyaWJ1dGVzKGRlZikgewogICAgICBkZWYgPSBIVUIuSW5zZXJ0KHsKICAgICAgICBvbm1vdXNlb3ZlcjogTUVOVS5Nb3VzZW92ZXIsCiAgICAgICAgb25tb3VzZW91dDogTUVOVS5Nb3VzZW91dCwKICAgICAgICBvbm1vdXNlZG93bjogTUVOVS5Nb3VzZWRvd24sCiAgICAgICAgb25rZXlkb3duOiBNRU5VLktleWRvd24sCiAgICAgICAgImFyaWEtZGlzYWJsZWQiOiAhIXRoaXMuZGlzYWJsZWQKICAgICAgfSwgZGVmKTsKICAgICAgZGVmID0gdGhpcy5TVVBFUihhcmd1bWVudHMpLkF0dHJpYnV0ZXMuY2FsbCh0aGlzLCBkZWYpOwoKICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHsKICAgICAgICBkZWYuY2xhc3NOYW1lICs9ICIgTWF0aEpheF9NZW51RGlzYWJsZWQiOwogICAgICB9CgogICAgICByZXR1cm4gZGVmOwogICAgfSwKICAgIE1vdmVWZXJ0aWNhbDogZnVuY3Rpb24gTW92ZVZlcnRpY2FsKGV2ZW50LCBpdGVtLCBtb3ZlKSB7CiAgICAgIHZhciBtZW51Tm9kZSA9IElURU0uR2V0TWVudU5vZGUoaXRlbSk7CiAgICAgIHZhciBpdGVtcyA9IFtdOwoKICAgICAgZm9yICh2YXIgaSA9IDAsIGFsbEl0ZW1zID0gbWVudU5vZGUubWVudUl0ZW0uaXRlbXMsIGl0OyBpdCA9IGFsbEl0ZW1zW2ldOyBpKyspIHsKICAgICAgICBpZiAoIWl0LmhpZGRlbikgewogICAgICAgICAgaXRlbXMucHVzaChpdCk7CiAgICAgICAgfQogICAgICB9CgogICAgICB2YXIgaW5kZXggPSBNRU5VLkluZGV4T2YoaXRlbXMsIHRoaXMpOwogICAgICBpZiAoaW5kZXggPT09IC0xKSByZXR1cm47CiAgICAgIHZhciBsZW4gPSBpdGVtcy5sZW5ndGg7CiAgICAgIHZhciBjaGlsZHJlbiA9IG1lbnVOb2RlLmNoaWxkTm9kZXM7CgogICAgICBkbyB7CiAgICAgICAgaW5kZXggPSBNRU5VLk1vZChtb3ZlKGluZGV4KSwgbGVuKTsKICAgICAgfSB3aGlsZSAoaXRlbXNbaW5kZXhdLmhpZGRlbiB8fCAhY2hpbGRyZW5baW5kZXhdLnJvbGUgfHwgY2hpbGRyZW5baW5kZXhdLnJvbGUgPT09ICJzZXBhcmF0b3IiKTsKCiAgICAgIHRoaXMuRGVhY3RpdmF0ZShpdGVtKTsKICAgICAgaXRlbXNbaW5kZXhdLkFjdGl2YXRlKGV2ZW50LCBjaGlsZHJlbltpbmRleF0pOwogICAgfSwKICAgIFVwOiBmdW5jdGlvbiBVcChldmVudCwgaXRlbSkgewogICAgICB0aGlzLk1vdmVWZXJ0aWNhbChldmVudCwgaXRlbSwgZnVuY3Rpb24gKHgpIHsKICAgICAgICByZXR1cm4geCAtIDE7CiAgICAgIH0pOwogICAgfSwKICAgIERvd246IGZ1bmN0aW9uIERvd24oZXZlbnQsIGl0ZW0pIHsKICAgICAgdGhpcy5Nb3ZlVmVydGljYWwoZXZlbnQsIGl0ZW0sIGZ1bmN0aW9uICh4KSB7CiAgICAgICAgcmV0dXJuIHggKyAxOwogICAgICB9KTsKICAgIH0sCiAgICBSaWdodDogZnVuY3Rpb24gUmlnaHQoZXZlbnQsIGl0ZW0pIHsKICAgICAgdGhpcy5Nb3ZlSG9yaXpvbnRhbChldmVudCwgaXRlbSwgTUVOVS5SaWdodCwgIXRoaXMuaXNSVEwoKSk7CiAgICB9LAogICAgTGVmdDogZnVuY3Rpb24gTGVmdChldmVudCwgaXRlbSkgewogICAgICB0aGlzLk1vdmVIb3Jpem9udGFsKGV2ZW50LCBpdGVtLCBNRU5VLkxlZnQsIHRoaXMuaXNSVEwoKSk7CiAgICB9LAogICAgTW92ZUhvcml6b250YWw6IGZ1bmN0aW9uIE1vdmVIb3Jpem9udGFsKGV2ZW50LCBpdGVtLCBtb3ZlLCBydGwpIHsKICAgICAgdmFyIG1lbnVOb2RlID0gSVRFTS5HZXRNZW51Tm9kZShpdGVtKTsKCiAgICAgIGlmIChtZW51Tm9kZS5tZW51SXRlbSA9PT0gTUVOVS5tZW51ICYmIGV2ZW50LnNoaWZ0S2V5KSB7CiAgICAgICAgbW92ZShldmVudCwgaXRlbSk7CiAgICAgIH0KCiAgICAgIGlmIChydGwpIHJldHVybjsKCiAgICAgIGlmIChtZW51Tm9kZS5tZW51SXRlbSAhPT0gTUVOVS5tZW51KSB7CiAgICAgICAgdGhpcy5EZWFjdGl2YXRlKGl0ZW0pOwogICAgICB9CgogICAgICB2YXIgcGFyZW50Tm9kZXMgPSBtZW51Tm9kZS5wcmV2aW91c1NpYmxpbmcuY2hpbGROb2RlczsKICAgICAgdmFyIGxlbmd0aCA9IHBhcmVudE5vZGVzLmxlbmd0aDsKCiAgICAgIHdoaWxlIChsZW5ndGgtLSkgewogICAgICAgIHZhciBwYXJlbnQgPSBwYXJlbnROb2Rlc1tsZW5ndGhdOwoKICAgICAgICBpZiAocGFyZW50Lm1lbnVJdGVtLnN1Ym1lbnUgJiYgcGFyZW50Lm1lbnVJdGVtLnN1Ym1lbnUgPT09IG1lbnVOb2RlLm1lbnVJdGVtKSB7CiAgICAgICAgICBNRU5VLkZvY3VzKHBhcmVudCk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuUmVtb3ZlU3VibWVudXMoaXRlbSk7CiAgICB9LAogICAgU3BhY2U6IGZ1bmN0aW9uIFNwYWNlKGV2ZW50LCBtZW51KSB7CiAgICAgIHRoaXMuTW91c2V1cChldmVudCwgbWVudSk7CiAgICB9LAogICAgQWN0aXZhdGU6IGZ1bmN0aW9uIEFjdGl2YXRlKGV2ZW50LCBtZW51KSB7CiAgICAgIHRoaXMuRGVhY3RpdmF0ZShtZW51KTsKCiAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkgewogICAgICAgIG1lbnUuY2xhc3NOYW1lICs9ICIgTWF0aEpheF9NZW51QWN0aXZlIjsKICAgICAgfQoKICAgICAgdGhpcy5EZWFjdGl2YXRlU3VibWVudXMobWVudSk7CiAgICAgIE1FTlUuRm9jdXMobWVudSk7CiAgICB9LAogICAgRGVhY3RpdmF0ZTogZnVuY3Rpb24gRGVhY3RpdmF0ZShtZW51KSB7CiAgICAgIG1lbnUuY2xhc3NOYW1lID0gbWVudS5jbGFzc05hbWUucmVwbGFjZSgvIE1hdGhKYXhfTWVudUFjdGl2ZS8sICIiKTsKICAgIH0KICB9KTsKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCiAgLyoKICAgKiAgQSBtZW51IGl0ZW0gdGhhdCBwZXJmb3JtcyBhIGNvbW1hbmQgd2hlbiBzZWxlY3RlZAogICAqLwoKICBNRU5VLklURU0uQ09NTUFORCA9IE1FTlUuRU5UUlkuU3ViY2xhc3MoewogICAgYWN0aW9uOiBmdW5jdGlvbiBhY3Rpb24oKSB7fSwKICAgIEluaXQ6IGZ1bmN0aW9uIEluaXQobmFtZSwgYWN0aW9uLCBkZWYpIHsKICAgICAgaWYgKCEobmFtZSBpbnN0YW5jZW9mIEFycmF5KSkgewogICAgICAgIG5hbWUgPSBbbmFtZSwgbmFtZV07CiAgICAgIH0gLy8gbWFrZSBbaWQsbGFiZWxdIHBhaXIKCgogICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICB0aGlzLmFjdGlvbiA9IGFjdGlvbjsKICAgICAgdGhpcy5XaXRoKGRlZik7CiAgICB9LAogICAgTGFiZWw6IGZ1bmN0aW9uIExhYmVsKGRlZiwgbWVudSkgewogICAgICByZXR1cm4gW3RoaXMuTmFtZSgpXTsKICAgIH0sCiAgICBNb3VzZXVwOiBmdW5jdGlvbiBNb3VzZXVwKGV2ZW50LCBtZW51KSB7CiAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkgewogICAgICAgIHRoaXMuUmVtb3ZlKGV2ZW50LCBtZW51KTsKICAgICAgICBTSUdOQUwuUG9zdChbImNvbW1hbmQiLCB0aGlzXSk7CiAgICAgICAgdGhpcy5hY3Rpb24uY2FsbCh0aGlzLCBldmVudCk7CiAgICAgIH0KCiAgICAgIHJldHVybiBGQUxTRShldmVudCk7CiAgICB9CiAgfSk7CiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogIC8qCiAgICogIEEgbWVudSBpdGVtIHRoYXQgcG9zdHMgYSBzdWJtZW51CiAgICovCgogIE1FTlUuSVRFTS5TVUJNRU5VID0gTUVOVS5FTlRSWS5TdWJjbGFzcyh7CiAgICBzdWJtZW51OiBudWxsLAogICAgLy8gdGhlIHN1Ym1lbnUKICAgIG1hcmtlcjogIlx1MjVCQSIsCiAgICAvLyB0aGUgc3VibWVudSBhcnJvdwogICAgbWFya2VyUlRMOiAiXHUyNUM0IiwKICAgIC8vIHRoZSBzdWJtZW51IGFycm93IGZvciBSVEwKICAgIEF0dHJpYnV0ZXM6IGZ1bmN0aW9uIEF0dHJpYnV0ZXMoZGVmKSB7CiAgICAgIGRlZiA9IEhVQi5JbnNlcnQoewogICAgICAgICJhcmlhLWhhc3BvcHVwIjogInRydWUiCiAgICAgIH0sIGRlZik7CiAgICAgIGRlZiA9IHRoaXMuU1VQRVIoYXJndW1lbnRzKS5BdHRyaWJ1dGVzLmNhbGwodGhpcywgZGVmKTsKICAgICAgcmV0dXJuIGRlZjsKICAgIH0sCiAgICBJbml0OiBmdW5jdGlvbiBJbml0KG5hbWUsIGRlZikgewogICAgICBpZiAoIShuYW1lIGluc3RhbmNlb2YgQXJyYXkpKSB7CiAgICAgICAgbmFtZSA9IFtuYW1lLCBuYW1lXTsKICAgICAgfSAvLyBtYWtlIFtpZCxsYWJlbF0gcGFpcgoKCiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHZhciBpID0gMTsKCiAgICAgIGlmICghKGRlZiBpbnN0YW5jZW9mIE1FTlUuSVRFTSkpIHsKICAgICAgICB0aGlzLldpdGgoZGVmKSwgaSsrOwogICAgICB9CgogICAgICB0aGlzLnN1Ym1lbnUgPSBNRU5VLmFwcGx5KE1FTlUsIFtdLnNsaWNlLmNhbGwoYXJndW1lbnRzLCBpKSk7CiAgICB9LAogICAgTGFiZWw6IGZ1bmN0aW9uIExhYmVsKGRlZiwgbWVudSkgewogICAgICB0aGlzLnN1Ym1lbnUucG9zdGVkID0gZmFsc2U7CiAgICAgIHJldHVybiBbdGhpcy5OYW1lKCkgKyAiICIsIFsic3BhbiIsIHsKICAgICAgICBjbGFzc05hbWU6ICJNYXRoSmF4X01lbnVBcnJvdyIgKyB0aGlzLnJ0bENsYXNzKCkKICAgICAgfSwgW3RoaXMuaXNSVEwoKSA/IHRoaXMubWFya2VyUlRMIDogdGhpcy5tYXJrZXJdXV07CiAgICB9LAogICAgVGltZXI6IGZ1bmN0aW9uIFRpbWVyKGV2ZW50LCBtZW51KSB7CiAgICAgIHRoaXMuQ2xlYXJUaW1lcigpOwogICAgICBldmVudCA9IHsKICAgICAgICB0eXBlOiBldmVudC50eXBlLAogICAgICAgIGNsaWVudFg6IGV2ZW50LmNsaWVudFgsCiAgICAgICAgY2xpZW50WTogZXZlbnQuY2xpZW50WQogICAgICB9OyAvLyBNU0lFIGNhbid0IHBhc3MgdGhlIGV2ZW50IGJlbG93CgogICAgICB0aGlzLnRpbWVyID0gc2V0VGltZW91dChDQUxMQkFDSyhbIk1vdXNldXAiLCB0aGlzLCBldmVudCwgbWVudV0pLCBDT05GSUcuZGVsYXkpOwogICAgfSwKICAgIENsZWFyVGltZXI6IGZ1bmN0aW9uIENsZWFyVGltZXIoKSB7CiAgICAgIGlmICh0aGlzLnRpbWVyKSB7CiAgICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZXIpOwogICAgICB9CiAgICB9LAogICAgVG91Y2hlbmQ6IGZ1bmN0aW9uIFRvdWNoZW5kKGV2ZW50LCBtZW51KSB7CiAgICAgIHZhciBmb3JjZW91dCA9IHRoaXMuc3VibWVudS5wb3N0ZWQ7CiAgICAgIHZhciByZXN1bHQgPSB0aGlzLlNVUEVSKGFyZ3VtZW50cykuVG91Y2hlbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCiAgICAgIGlmIChmb3JjZW91dCkgewogICAgICAgIHRoaXMuRGVhY3RpdmF0ZShtZW51KTsKICAgICAgICBkZWxldGUgSVRFTS5sYXN0SXRlbTsKICAgICAgICBkZWxldGUgSVRFTS5sYXN0TWVudTsKICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICBNb3VzZW91dDogZnVuY3Rpb24gTW91c2VvdXQoZXZlbnQsIG1lbnUpIHsKICAgICAgaWYgKCF0aGlzLnN1Ym1lbnUucG9zdGVkKSB7CiAgICAgICAgdGhpcy5EZWFjdGl2YXRlKG1lbnUpOwogICAgICB9CgogICAgICB0aGlzLkNsZWFyVGltZXIoKTsKICAgIH0sCiAgICBNb3VzZW92ZXI6IGZ1bmN0aW9uIE1vdXNlb3ZlcihldmVudCwgbWVudSkgewogICAgICB0aGlzLkFjdGl2YXRlKGV2ZW50LCBtZW51KTsKICAgIH0sCiAgICBNb3VzZXVwOiBmdW5jdGlvbiBNb3VzZXVwKGV2ZW50LCBtZW51KSB7CiAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkgewogICAgICAgIGlmICghdGhpcy5zdWJtZW51LnBvc3RlZCkgewogICAgICAgICAgdGhpcy5DbGVhclRpbWVyKCk7CiAgICAgICAgICB0aGlzLnN1Ym1lbnUuUG9zdChldmVudCwgbWVudSwgdGhpcy5sdHIpOwogICAgICAgICAgTUVOVS5Gb2N1cyhtZW51KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy5EZWFjdGl2YXRlU3VibWVudXMobWVudSk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gRkFMU0UoZXZlbnQpOwogICAgfSwKICAgIEFjdGl2YXRlOiBmdW5jdGlvbiBBY3RpdmF0ZShldmVudCwgbWVudSkgewogICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHsKICAgICAgICB0aGlzLkRlYWN0aXZhdGUobWVudSk7CiAgICAgICAgbWVudS5jbGFzc05hbWUgKz0gIiBNYXRoSmF4X01lbnVBY3RpdmUiOwogICAgICB9CgogICAgICBpZiAoIXRoaXMuc3VibWVudS5wb3N0ZWQpIHsKICAgICAgICB0aGlzLkRlYWN0aXZhdGVTdWJtZW51cyhtZW51KTsKCiAgICAgICAgaWYgKCFNRU5VLmlzTW9iaWxlKSB7CiAgICAgICAgICB0aGlzLlRpbWVyKGV2ZW50LCBtZW51KTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIE1FTlUuRm9jdXMobWVudSk7CiAgICB9LAogICAgTW92ZVZlcnRpY2FsOiBmdW5jdGlvbiBNb3ZlVmVydGljYWwoZXZlbnQsIGl0ZW0sIG1vdmUpIHsKICAgICAgdGhpcy5DbGVhclRpbWVyKCk7CiAgICAgIHRoaXMuU1VQRVIoYXJndW1lbnRzKS5Nb3ZlVmVydGljYWwuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH0sCiAgICBNb3ZlSG9yaXpvbnRhbDogZnVuY3Rpb24gTW92ZUhvcml6b250YWwoZXZlbnQsIG1lbnUsIG1vdmUsIHJ0bCkgewogICAgICBpZiAoIXJ0bCkgewogICAgICAgIHRoaXMuU1VQRVIoYXJndW1lbnRzKS5Nb3ZlSG9yaXpvbnRhbC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuZGlzYWJsZWQpIHJldHVybjsKCiAgICAgIGlmICghdGhpcy5zdWJtZW51LnBvc3RlZCkgewogICAgICAgIHRoaXMuQWN0aXZhdGUoZXZlbnQsIG1lbnUpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgdmFyIHN1Ym1lbnVOb2RlcyA9IElURU0uR2V0TWVudU5vZGUobWVudSkubmV4dFNpYmxpbmcuY2hpbGROb2RlczsKCiAgICAgIGlmIChzdWJtZW51Tm9kZXMubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMuc3VibWVudS5pdGVtc1swXS5BY3RpdmF0ZShldmVudCwgc3VibWVudU5vZGVzWzBdKTsKICAgICAgfQogICAgfQogIH0pOwogIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAvKgogICAqICBBIG1lbnUgaXRlbSB0aGF0IGlzIG9uZSBvZiBzZXZlcmFsIHJhZGlvIGJ1dHRvbnMKICAgKi8KCiAgTUVOVS5JVEVNLlJBRElPID0gTUVOVS5FTlRSWS5TdWJjbGFzcyh7CiAgICB2YXJpYWJsZTogbnVsbCwKICAgIC8vIHRoZSB2YXJpYWJsZSBuYW1lCiAgICBtYXJrZXI6IGlzUEMgPyAiXHUyNUNGIiA6ICJcdTI3MTMiLAogICAgLy8gdGhlIGNoZWNrbWFyawogICAgcm9sZTogIm1lbnVpdGVtcmFkaW8iLAogICAgQXR0cmlidXRlczogZnVuY3Rpb24gQXR0cmlidXRlcyhkZWYpIHsKICAgICAgdmFyIGNoZWNrZWQgPSBDT05GSUcuc2V0dGluZ3NbdGhpcy52YXJpYWJsZV0gPT09IHRoaXMudmFsdWUgPyAidHJ1ZSIgOiAiZmFsc2UiOwogICAgICBkZWYgPSBIVUIuSW5zZXJ0KHsKICAgICAgICAiYXJpYS1jaGVja2VkIjogY2hlY2tlZAogICAgICB9LCBkZWYpOwogICAgICBkZWYgPSB0aGlzLlNVUEVSKGFyZ3VtZW50cykuQXR0cmlidXRlcy5jYWxsKHRoaXMsIGRlZik7CiAgICAgIHJldHVybiBkZWY7CiAgICB9LAogICAgSW5pdDogZnVuY3Rpb24gSW5pdChuYW1lLCB2YXJpYWJsZSwgZGVmKSB7CiAgICAgIGlmICghKG5hbWUgaW5zdGFuY2VvZiBBcnJheSkpIHsKICAgICAgICBuYW1lID0gW25hbWUsIG5hbWVdOwogICAgICB9IC8vIG1ha2UgW2lkLGxhYmVsXSBwYWlyCgoKICAgICAgdGhpcy5uYW1lID0gbmFtZTsKICAgICAgdGhpcy52YXJpYWJsZSA9IHZhcmlhYmxlOwogICAgICB0aGlzLldpdGgoZGVmKTsKCiAgICAgIGlmICh0aGlzLnZhbHVlID09IG51bGwpIHsKICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy5uYW1lWzBdOwogICAgICB9CiAgICB9LAogICAgTGFiZWw6IGZ1bmN0aW9uIExhYmVsKGRlZiwgbWVudSkgewogICAgICB2YXIgc3BhbiA9IHsKICAgICAgICBjbGFzc05hbWU6ICJNYXRoSmF4X01lbnVSYWRpb0NoZWNrIiArIHRoaXMucnRsQ2xhc3MoKQogICAgICB9OwoKICAgICAgaWYgKENPTkZJRy5zZXR0aW5nc1t0aGlzLnZhcmlhYmxlXSAhPT0gdGhpcy52YWx1ZSkgewogICAgICAgIHNwYW4gPSB7CiAgICAgICAgICBzdHlsZTogewogICAgICAgICAgICBkaXNwbGF5OiAibm9uZSIKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9CgogICAgICByZXR1cm4gW1sic3BhbiIsIHNwYW4sIFt0aGlzLm1hcmtlcl1dLCAiICIgKyB0aGlzLk5hbWUoKV07CiAgICB9LAogICAgTW91c2V1cDogZnVuY3Rpb24gTW91c2V1cChldmVudCwgbWVudSkgewogICAgICBpZiAoIXRoaXMuZGlzYWJsZWQpIHsKICAgICAgICB2YXIgY2hpbGQgPSBtZW51LnBhcmVudE5vZGUuY2hpbGROb2RlczsKCiAgICAgICAgZm9yICh2YXIgaSA9IDAsIG0gPSBjaGlsZC5sZW5ndGg7IGkgPCBtOyBpKyspIHsKICAgICAgICAgIHZhciBpdGVtID0gY2hpbGRbaV0ubWVudUl0ZW07CgogICAgICAgICAgaWYgKGl0ZW0gJiYgaXRlbS52YXJpYWJsZSA9PT0gdGhpcy52YXJpYWJsZSkgewogICAgICAgICAgICBjaGlsZFtpXS5maXJzdENoaWxkLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBtZW51LmZpcnN0Q2hpbGQuZGlzcGxheSA9ICIiOwogICAgICAgIENPTkZJRy5zZXR0aW5nc1t0aGlzLnZhcmlhYmxlXSA9IHRoaXMudmFsdWU7CiAgICAgICAgTUVOVS5jb29raWVbdGhpcy52YXJpYWJsZV0gPSBDT05GSUcuc2V0dGluZ3NbdGhpcy52YXJpYWJsZV07CiAgICAgICAgTUVOVS5zYXZlQ29va2llKCk7CiAgICAgICAgU0lHTkFMLlBvc3QoWyJyYWRpbyBidXR0b24iLCB0aGlzXSk7CiAgICAgIH0KCiAgICAgIHRoaXMuUmVtb3ZlKGV2ZW50LCBtZW51KTsKCiAgICAgIGlmICh0aGlzLmFjdGlvbiAmJiAhdGhpcy5kaXNhYmxlZCkgewogICAgICAgIHRoaXMuYWN0aW9uLmNhbGwoTUVOVSwgdGhpcyk7CiAgICAgIH0KCiAgICAgIHJldHVybiBGQUxTRShldmVudCk7CiAgICB9CiAgfSk7CiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogIC8qCiAgICogIEEgbWVudSBpdGVtIHRoYXQgaXMgY2hlY2thYmxlCiAgICovCgogIE1FTlUuSVRFTS5DSEVDS0JPWCA9IE1FTlUuRU5UUlkuU3ViY2xhc3MoewogICAgdmFyaWFibGU6IG51bGwsCiAgICAvLyB0aGUgdmFyaWFibGUgbmFtZQogICAgbWFya2VyOiAiXHUyNzEzIiwKICAgIC8vIHRoZSBjaGVja21hcmsKICAgIHJvbGU6ICJtZW51aXRlbWNoZWNrYm94IiwKICAgIEF0dHJpYnV0ZXM6IGZ1bmN0aW9uIEF0dHJpYnV0ZXMoZGVmKSB7CiAgICAgIHZhciBjaGVja2VkID0gQ09ORklHLnNldHRpbmdzW3RoaXMudmFyaWFibGVdID8gInRydWUiIDogImZhbHNlIjsKICAgICAgZGVmID0gSFVCLkluc2VydCh7CiAgICAgICAgImFyaWEtY2hlY2tlZCI6IGNoZWNrZWQKICAgICAgfSwgZGVmKTsKICAgICAgZGVmID0gdGhpcy5TVVBFUihhcmd1bWVudHMpLkF0dHJpYnV0ZXMuY2FsbCh0aGlzLCBkZWYpOwogICAgICByZXR1cm4gZGVmOwogICAgfSwKICAgIEluaXQ6IGZ1bmN0aW9uIEluaXQobmFtZSwgdmFyaWFibGUsIGRlZikgewogICAgICBpZiAoIShuYW1lIGluc3RhbmNlb2YgQXJyYXkpKSB7CiAgICAgICAgbmFtZSA9IFtuYW1lLCBuYW1lXTsKICAgICAgfSAvLyBtYWtlIFtpZCxsYWJlbF0gcGFpcgoKCiAgICAgIHRoaXMubmFtZSA9IG5hbWU7CiAgICAgIHRoaXMudmFyaWFibGUgPSB2YXJpYWJsZTsKICAgICAgdGhpcy5XaXRoKGRlZik7CiAgICB9LAogICAgTGFiZWw6IGZ1bmN0aW9uIExhYmVsKGRlZiwgbWVudSkgewogICAgICB2YXIgc3BhbiA9IHsKICAgICAgICBjbGFzc05hbWU6ICJNYXRoSmF4X01lbnVDaGVjayIgKyB0aGlzLnJ0bENsYXNzKCkKICAgICAgfTsKCiAgICAgIGlmICghQ09ORklHLnNldHRpbmdzW3RoaXMudmFyaWFibGVdKSB7CiAgICAgICAgc3BhbiA9IHsKICAgICAgICAgIHN0eWxlOiB7CiAgICAgICAgICAgIGRpc3BsYXk6ICJub25lIgogICAgICAgICAgfQogICAgICAgIH07CiAgICAgIH0KCiAgICAgIHJldHVybiBbWyJzcGFuIiwgc3BhbiwgW3RoaXMubWFya2VyXV0sICIgIiArIHRoaXMuTmFtZSgpXTsKICAgIH0sCiAgICBNb3VzZXVwOiBmdW5jdGlvbiBNb3VzZXVwKGV2ZW50LCBtZW51KSB7CiAgICAgIGlmICghdGhpcy5kaXNhYmxlZCkgewogICAgICAgIG1lbnUuZmlyc3RDaGlsZC5kaXNwbGF5ID0gQ09ORklHLnNldHRpbmdzW3RoaXMudmFyaWFibGVdID8gIm5vbmUiIDogIiI7CiAgICAgICAgQ09ORklHLnNldHRpbmdzW3RoaXMudmFyaWFibGVdID0gIUNPTkZJRy5zZXR0aW5nc1t0aGlzLnZhcmlhYmxlXTsKICAgICAgICBNRU5VLmNvb2tpZVt0aGlzLnZhcmlhYmxlXSA9IENPTkZJRy5zZXR0aW5nc1t0aGlzLnZhcmlhYmxlXTsKICAgICAgICBNRU5VLnNhdmVDb29raWUoKTsKICAgICAgICBTSUdOQUwuUG9zdChbImNoZWNrYm94IiwgdGhpc10pOwogICAgICB9CgogICAgICB0aGlzLlJlbW92ZShldmVudCwgbWVudSk7CgogICAgICBpZiAodGhpcy5hY3Rpb24gJiYgIXRoaXMuZGlzYWJsZWQpIHsKICAgICAgICB0aGlzLmFjdGlvbi5jYWxsKE1FTlUsIHRoaXMpOwogICAgICB9CgogICAgICByZXR1cm4gRkFMU0UoZXZlbnQpOwogICAgfQogIH0pOwogIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAvKgogICAqICBBIG1lbnUgaXRlbSB0aGF0IGlzIGEgbGFiZWwKICAgKi8KCiAgTUVOVS5JVEVNLkxBQkVMID0gTUVOVS5FTlRSWS5TdWJjbGFzcyh7CiAgICByb2xlOiAibWVudWl0ZW0iLAogICAgLy8gQXJpYSByb2xlLgogICAgSW5pdDogZnVuY3Rpb24gSW5pdChuYW1lLCBkZWYpIHsKICAgICAgaWYgKCEobmFtZSBpbnN0YW5jZW9mIEFycmF5KSkgewogICAgICAgIG5hbWUgPSBbbmFtZSwgbmFtZV07CiAgICAgIH0gLy8gbWFrZSBbaWQsbGFiZWxdIHBhaXIKCgogICAgICB0aGlzLm5hbWUgPSBuYW1lOwogICAgICB0aGlzLldpdGgoZGVmKTsKICAgIH0sCiAgICBMYWJlbDogZnVuY3Rpb24gTGFiZWwoZGVmLCBtZW51KSB7CiAgICAgIGRlZi5jbGFzc05hbWUgKz0gIiBNYXRoSmF4X01lbnVMYWJlbCI7CiAgICAgIHJldHVybiBbdGhpcy5OYW1lKCldOwogICAgfSwKICAgIEFjdGl2YXRlOiBmdW5jdGlvbiBBY3RpdmF0ZShldmVudCwgbWVudSkgewogICAgICB0aGlzLkRlYWN0aXZhdGUobWVudSk7CiAgICAgIE1FTlUuRm9jdXMobWVudSk7CiAgICB9LAogICAgTW91c2V1cDogZnVuY3Rpb24gTW91c2V1cChldmVudCwgbWVudSkge30KICB9KTsKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCiAgLyoKICAgKiAgQSBydWxlIGluIGEgbWVudQogICAqLwoKICBNRU5VLklURU0uUlVMRSA9IE1FTlUuSVRFTS5TdWJjbGFzcyh7CiAgICByb2xlOiAic2VwYXJhdG9yIiwKICAgIEF0dHJpYnV0ZXM6IGZ1bmN0aW9uIEF0dHJpYnV0ZXMoZGVmKSB7CiAgICAgIGRlZiA9IEhVQi5JbnNlcnQoewogICAgICAgICJhcmlhLW9yaWVudGF0aW9uIjogInZlcnRpY2FsIgogICAgICB9LCBkZWYpOwogICAgICBkZWYgPSB0aGlzLlNVUEVSKGFyZ3VtZW50cykuQXR0cmlidXRlcy5jYWxsKHRoaXMsIGRlZik7CiAgICAgIHJldHVybiBkZWY7CiAgICB9LAogICAgTGFiZWw6IGZ1bmN0aW9uIExhYmVsKGRlZiwgbWVudSkgewogICAgICBkZWYuY2xhc3NOYW1lICs9ICIgTWF0aEpheF9NZW51UnVsZSI7CiAgICAgIHJldHVybiBudWxsOwogICAgfQogIH0pOwogIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCiAgLyoKICAgKiAgSGFuZGxlIHRoZSBBQk9VVCBib3gKICAgKi8KCiAgTUVOVS5BYm91dCA9IGZ1bmN0aW9uIChldmVudCkgewogICAgdmFyIGZvbnQgPSBNRU5VLkFib3V0LkdldEZvbnQoKTsKICAgIHZhciBmb3JtYXQgPSBNRU5VLkFib3V0LkdldEZvcm1hdCgpOwogICAgdmFyIGpheCA9IFsiTWF0aEpheC5qcyB2IiArIE1hdGhKYXguZmlsZXZlcnNpb24sIFsiYnIiXV07CiAgICBqYXgucHVzaChbImRpdiIsIHsKICAgICAgc3R5bGU6IHsKICAgICAgICAiYm9yZGVyLXRvcCI6ICJncm9vdmUgMnB4IiwKICAgICAgICBtYXJnaW46ICIuMjVlbSAwIgogICAgICB9CiAgICB9XSk7CiAgICBNRU5VLkFib3V0LkdldEpheChqYXgsIE1hdGhKYXguSW5wdXRKYXgsIFsiSW5wdXRKYXgiLCAiJTEgSW5wdXQgSmF4IHYlMiJdKTsKICAgIE1FTlUuQWJvdXQuR2V0SmF4KGpheCwgTWF0aEpheC5PdXRwdXRKYXgsIFsiT3V0cHV0SmF4IiwgIiUxIE91dHB1dCBKYXggdiUyIl0pOwogICAgTUVOVS5BYm91dC5HZXRKYXgoamF4LCBNYXRoSmF4LkVsZW1lbnRKYXgsIFsiRWxlbWVudEpheCIsICIlMSBFbGVtZW50IEpheCB2JTIiXSk7CiAgICBqYXgucHVzaChbImRpdiIsIHsKICAgICAgc3R5bGU6IHsKICAgICAgICAiYm9yZGVyLXRvcCI6ICJncm9vdmUgMnB4IiwKICAgICAgICBtYXJnaW46ICIuMjVlbSAwIgogICAgICB9CiAgICB9XSk7CiAgICBNRU5VLkFib3V0LkdldEpheChqYXgsIE1hdGhKYXguRXh0ZW5zaW9uLCBbIkV4dGVuc2lvbiIsICIlMSBFeHRlbnNpb24gdiUyIl0sIHRydWUpOwogICAgamF4LnB1c2goWyJkaXYiLCB7CiAgICAgIHN0eWxlOiB7CiAgICAgICAgImJvcmRlci10b3AiOiAiZ3Jvb3ZlIDJweCIsCiAgICAgICAgbWFyZ2luOiAiLjI1ZW0gMCIKICAgICAgfQogICAgfV0sIFsiY2VudGVyIiwge30sIFtIVUIuQnJvd3NlciArICIgdiIgKyBIVUIuQnJvd3Nlci52ZXJzaW9uICsgKGZvcm1hdCA/ICIgXHUyMDE0ICIgKyBfKGZvcm1hdC5yZXBsYWNlKC8gL2csICIiKSwgZm9ybWF0KSA6ICIiKV1dKTsKICAgIE1FTlUuQWJvdXQuZGl2ID0gTUVOVS5CYWNrZ3JvdW5kKE1FTlUuQWJvdXQpOwogICAgdmFyIGFib3V0ID0gSFRNTC5hZGRFbGVtZW50KE1FTlUuQWJvdXQuZGl2LCAiZGl2IiwgewogICAgICBpZDogIk1hdGhKYXhfQWJvdXQiLAogICAgICB0YWJJbmRleDogMCwKICAgICAgb25rZXlkb3duOiBNRU5VLkFib3V0LktleWRvd24KICAgIH0sIFtbImIiLCB7CiAgICAgIHN0eWxlOiB7CiAgICAgICAgZm9udFNpemU6ICIxMjAlIgogICAgICB9CiAgICB9LCBbIk1hdGhKYXgiXV0sICIgdiIgKyBNYXRoSmF4LnZlcnNpb24sIFsiYnIiXSwgXyhmb250LnJlcGxhY2UoLyAvZywgIiIpLCAidXNpbmcgIiArIGZvbnQpLCBbImJyIl0sIFsiYnIiXSwgWyJzcGFuIiwgewogICAgICBzdHlsZTogewogICAgICAgIGRpc3BsYXk6ICJpbmxpbmUtYmxvY2siLAogICAgICAgICJ0ZXh0LWFsaWduIjogImxlZnQiLAogICAgICAgICJmb250LXNpemUiOiAiODAlIiwKICAgICAgICAibWF4LWhlaWdodCI6ICIyMGVtIiwKICAgICAgICBvdmVyZmxvdzogImF1dG8iLAogICAgICAgICJiYWNrZ3JvdW5kLWNvbG9yIjogIiNFNEU0RTQiLAogICAgICAgIHBhZGRpbmc6ICIuNGVtIC42ZW0iLAogICAgICAgIGJvcmRlcjogIjFweCBpbnNldCIKICAgICAgfSwKICAgICAgdGFiSW5kZXg6IDAKICAgIH0sIGpheF0sIFsiYnIiXSwgWyJiciJdLCBbImEiLCB7CiAgICAgIGhyZWY6ICJodHRwOi8vd3d3Lm1hdGhqYXgub3JnLyIKICAgIH0sIFsid3d3Lm1hdGhqYXgub3JnIl1dLCBbInNwYW4iLCB7CiAgICAgIGNsYXNzTmFtZTogIk1hdGhKYXhfTWVudUNsb3NlIiwKICAgICAgaWQ6ICJNYXRoSmF4X0Fib3V0Q2xvc2UiLAogICAgICBvbmNsaWNrOiBNRU5VLkFib3V0LlJlbW92ZSwKICAgICAgb25rZXlkb3duOiBNRU5VLkFib3V0LktleWRvd24sCiAgICAgIHRhYkluZGV4OiAwLAogICAgICByb2xlOiAiYnV0dG9uIiwKICAgICAgImFyaWEtbGFiZWwiOiBfKCJDbG9zZUFib3V0RGlhbG9nIiwgIkNsb3NlIGFib3V0IE1hdGhKYXggZGlhbG9nIikKICAgIH0sIFtbInNwYW4iLCB7fSwgIlx4RDciXV1dXSk7CiAgICBpZiAoZXZlbnQudHlwZSA9PT0gIm1vdXNldXAiKSBhYm91dC5jbGFzc05hbWUgKz0gIiBNYXRoSmF4X01vdXNlUG9zdCI7CiAgICBhYm91dC5mb2N1cygpOwogICAgTWF0aEpheC5Mb2NhbGl6YXRpb24uc2V0Q1NTKGFib3V0KTsKICAgIHZhciBkb2MgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQgfHwge307CiAgICB2YXIgSCA9IHdpbmRvdy5pbm5lckhlaWdodCB8fCBkb2MuY2xpZW50SGVpZ2h0IHx8IGRvYy5zY3JvbGxIZWlnaHQgfHwgMDsKCiAgICBpZiAoTUVOVS5wcm90b3R5cGUubXNpZUFib3V0QnVnKSB7CiAgICAgIGFib3V0LnN0eWxlLndpZHRoID0gIjIwZW0iOwogICAgICBhYm91dC5zdHlsZS5wb3NpdGlvbiA9ICJhYnNvbHV0ZSI7CiAgICAgIGFib3V0LnN0eWxlLmxlZnQgPSBNYXRoLmZsb29yKChkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsV2lkdGggLSBhYm91dC5vZmZzZXRXaWR0aCkgLyAyKSArICJweCI7CiAgICAgIGFib3V0LnN0eWxlLnRvcCA9IE1hdGguZmxvb3IoKEggLSBhYm91dC5vZmZzZXRIZWlnaHQpIC8gMykgKyBkb2N1bWVudC5ib2R5LnNjcm9sbFRvcCArICJweCI7CiAgICB9IGVsc2UgewogICAgICBhYm91dC5zdHlsZS5tYXJnaW5MZWZ0ID0gTWF0aC5mbG9vcigtYWJvdXQub2Zmc2V0V2lkdGggLyAyKSArICJweCI7CiAgICAgIGFib3V0LnN0eWxlLnRvcCA9IE1hdGguZmxvb3IoKEggLSBhYm91dC5vZmZzZXRIZWlnaHQpIC8gMykgKyAicHgiOwogICAgfQogIH07CgogIE1FTlUuQWJvdXQuUmVtb3ZlID0gZnVuY3Rpb24gKGV2ZW50KSB7CiAgICBpZiAoTUVOVS5BYm91dC5kaXYpIHsKICAgICAgZG9jdW1lbnQuYm9keS5yZW1vdmVDaGlsZChNRU5VLkFib3V0LmRpdik7CiAgICAgIGRlbGV0ZSBNRU5VLkFib3V0LmRpdjsKICAgIH0KICB9OwoKICBNRU5VLkFib3V0LktleWRvd24gPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIGlmIChldmVudC5rZXlDb2RlID09PSBLRVkuRVNDQVBFIHx8IHRoaXMuaWQgPT09ICJNYXRoSmF4X0Fib3V0Q2xvc2UiICYmIChldmVudC5rZXlDb2RlID09PSBLRVkuU1BBQ0UgfHwgZXZlbnQua2V5Q29kZSA9PT0gS0VZLlJFVFVSTikpIHsKICAgICAgTUVOVS5BYm91dC5SZW1vdmUoZXZlbnQpOwogICAgICBNRU5VLkN1cnJlbnROb2RlKCkuZm9jdXMoKTsKICAgICAgRkFMU0UoZXZlbnQpOwogICAgfQogIH0sIE1FTlUuQWJvdXQuR2V0SmF4ID0gZnVuY3Rpb24gKGpheCwgSkFYLCB0eXBlLCBub1R5cGVDaGVjaykgewogICAgdmFyIGluZm8gPSBbXTsKCiAgICBmb3IgKHZhciBpZCBpbiBKQVgpIHsKICAgICAgaWYgKEpBWC5oYXNPd25Qcm9wZXJ0eShpZCkgJiYgSkFYW2lkXSkgewogICAgICAgIGlmIChub1R5cGVDaGVjayAmJiBKQVhbaWRdLnZlcnNpb24gfHwgSkFYW2lkXS5pc2EgJiYgSkFYW2lkXS5pc2EoSkFYKSkgewogICAgICAgICAgaW5mby5wdXNoKF8odHlwZVswXSwgdHlwZVsxXSwgSkFYW2lkXS5pZCB8fCBpZCwgSkFYW2lkXS52ZXJzaW9uKSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CgogICAgaW5mby5zb3J0KCk7CgogICAgZm9yICh2YXIgaSA9IDAsIG0gPSBpbmZvLmxlbmd0aDsgaSA8IG07IGkrKykgewogICAgICBqYXgucHVzaChpbmZvW2ldLCBbImJyIl0pOwogICAgfQoKICAgIHJldHVybiBqYXg7CiAgfTsKCiAgTUVOVS5BYm91dC5HZXRGb250ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIGpheCA9IE1hdGhKYXguSHViLm91dHB1dEpheFsiamF4L21tbCJdWzBdIHx8IHt9OwogICAgdmFyIGZvbnQgPSB7CiAgICAgIFNWRzogIndlYiBTVkciLAogICAgICBDb21tb25IVE1MOiAid2ViIFRlWCIsCiAgICAgICJIVE1MLUNTUyI6IGpheC5pbWdGb250cyA/ICJpbWFnZSIgOiAoamF4LndlYkZvbnRzID8gIndlYiIgOiAibG9jYWwiKSArICIgIiArIGpheC5mb250SW5Vc2UKICAgIH1bamF4LmlkXSB8fCAiZ2VuZXJpYyI7CiAgICByZXR1cm4gZm9udCArICIgZm9udHMiOwogIH07CgogIE1FTlUuQWJvdXQuR2V0Rm9ybWF0ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIGpheCA9IE1hdGhKYXguSHViLm91dHB1dEpheFsiamF4L21tbCJdWzBdIHx8IHt9OwogICAgaWYgKGpheC5pZCAhPT0gIkhUTUwtQ1NTIiB8fCAhamF4LndlYkZvbnRzIHx8IGpheC5pbWdGb250cykgcmV0dXJuOwogICAgcmV0dXJuIGpheC5hbGxvd1dlYkZvbnRzLnJlcGxhY2UoL290Zi8sICJ3b2ZmIG9yIG90ZiIpICsgIiBmb250cyI7CiAgfTsKICAvKgogICAqICBIYW5kbGUgdGhlIE1hdGhKYXggSEVMUCBtZW51CiAgICovCgoKICBNRU5VLkhlbHAgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgIEFKQVguUmVxdWlyZSgiW01hdGhKYXhdL2V4dGVuc2lvbnMvSGVscERpYWxvZy5qcyIsIGZ1bmN0aW9uICgpIHsKICAgICAgTWF0aEpheC5FeHRlbnNpb24uSGVscC5EaWFsb2coewogICAgICAgIHR5cGU6IGV2ZW50LnR5cGUKICAgICAgfSk7CiAgICB9KTsKICB9OwogIC8qCiAgICogIEhhbmRsZSBzaG93aW5nIG9mIGVsZW1lbnQncyBzb3VyY2UKICAgKi8KCgogIE1FTlUuU2hvd1NvdXJjZSA9IGZ1bmN0aW9uIChldmVudCkgewogICAgaWYgKCFldmVudCkgewogICAgICBldmVudCA9IHdpbmRvdy5ldmVudDsKICAgIH0KCiAgICB2YXIgRVZFTlQgPSB7CiAgICAgIHNjcmVlblg6IGV2ZW50LnNjcmVlblgsCiAgICAgIHNjcmVlblk6IGV2ZW50LnNjcmVlblkKICAgIH07CiAgICBpZiAoIU1FTlUuamF4KSByZXR1cm47CgogICAgaWYgKHRoaXMuZm9ybWF0ID09PSAiTWF0aE1MIikgewogICAgICB2YXIgTU1MID0gTWF0aEpheC5FbGVtZW50SmF4Lm1tbDsKCiAgICAgIGlmIChNTUwgJiYgdHlwZW9mIE1NTC5tYmFzZS5wcm90b3R5cGUudG9NYXRoTUwgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgLy8gdG9NYXRoTUwoKSBjYW4gY2FsbCBNYXRoSmF4Lkh1Yi5SZXN0YXJ0QWZ0ZXIsIHNvIHRyYXAgZXJyb3JzIGFuZCBjaGVjawogICAgICAgIHRyeSB7CiAgICAgICAgICBNRU5VLlNob3dTb3VyY2UuVGV4dChNRU5VLmpheC5yb290LnRvTWF0aE1MKCIiLCBNRU5VLmpheCksIGV2ZW50KTsKICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIGlmICghZXJyLnJlc3RhcnQpIHsKICAgICAgICAgICAgdGhyb3cgZXJyOwogICAgICAgICAgfQoKICAgICAgICAgIENBTExCQUNLLkFmdGVyKFt0aGlzLCBNRU5VLlNob3dTb3VyY2UsIEVWRU5UXSwgZXJyLnJlc3RhcnQpOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmICghQUpBWC5sb2FkaW5nVG9NYXRoTUwpIHsKICAgICAgICBBSkFYLmxvYWRpbmdUb01hdGhNTCA9IHRydWU7CiAgICAgICAgTUVOVS5TaG93U291cmNlLldpbmRvdyhldmVudCk7IC8vIFdlQktpdCBuZWVkcyB0byBvcGVuIHdpbmRvdyBvbiBjbGljayBldmVudAoKICAgICAgICBDQUxMQkFDSy5RdWV1ZShBSkFYLlJlcXVpcmUoIltNYXRoSmF4XS9leHRlbnNpb25zL3RvTWF0aE1MLmpzIiksIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIGRlbGV0ZSBBSkFYLmxvYWRpbmdUb01hdGhNTDsKCiAgICAgICAgICBpZiAoIU1NTC5tYmFzZS5wcm90b3R5cGUudG9NYXRoTUwpIHsKICAgICAgICAgICAgTU1MLm1iYXNlLnByb3RvdHlwZS50b01hdGhNTCA9IGZ1bmN0aW9uICgpIHt9OwogICAgICAgICAgfQogICAgICAgIH0sIFt0aGlzLCBNRU5VLlNob3dTb3VyY2UsIEVWRU5UXSAvLyBjYWxsIHRoaXMgZnVuY3Rpb24gYWdhaW4KICAgICAgICApOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgfSBlbHNlIGlmICh0aGlzLmZvcm1hdCA9PT0gIkVycm9yIikgewogICAgICBNRU5VLlNob3dTb3VyY2UuVGV4dChNRU5VLmpheC5lcnJvclRleHQsIGV2ZW50KTsKICAgIH0gZWxzZSBpZiAoQ09ORklHLnNlbWFudGljc0Fubm90YXRpb25zW3RoaXMuZm9ybWF0XSkgewogICAgICB2YXIgYW5ub3RhdGlvbiA9IE1FTlUuamF4LnJvb3QuZ2V0QW5ub3RhdGlvbih0aGlzLmZvcm1hdCk7CiAgICAgIGlmIChhbm5vdGF0aW9uLmRhdGFbMF0pIE1FTlUuU2hvd1NvdXJjZS5UZXh0KGFubm90YXRpb24uZGF0YVswXS50b1N0cmluZygpKTsKICAgIH0gZWxzZSB7CiAgICAgIGlmIChNRU5VLmpheC5vcmlnaW5hbFRleHQgPT0gbnVsbCkgewogICAgICAgIGFsZXJ0KF8oIk5vT3JpZ2luYWxGb3JtIiwgIk5vIG9yaWdpbmFsIGZvcm0gYXZhaWxhYmxlIikpOwogICAgICAgIHJldHVybjsKICAgICAgfQoKICAgICAgTUVOVS5TaG93U291cmNlLlRleHQoTUVOVS5qYXgub3JpZ2luYWxUZXh0LCBldmVudCk7CiAgICB9CiAgfTsKCiAgTUVOVS5TaG93U291cmNlLldpbmRvdyA9IGZ1bmN0aW9uIChldmVudCkgewogICAgaWYgKCFNRU5VLlNob3dTb3VyY2UudykgewogICAgICB2YXIgZGVmID0gW10sCiAgICAgICAgICBERUYgPSBDT05GSUcud2luZG93U2V0dGluZ3M7CgogICAgICBmb3IgKHZhciBpZCBpbiBERUYpIHsKICAgICAgICBpZiAoREVGLmhhc093blByb3BlcnR5KGlkKSkgewogICAgICAgICAgZGVmLnB1c2goaWQgKyAiPSIgKyBERUZbaWRdKTsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIE1FTlUuU2hvd1NvdXJjZS53ID0gd2luZG93Lm9wZW4oIiIsICJfYmxhbmsiLCBkZWYuam9pbigiLCIpKTsKICAgIH0KCiAgICByZXR1cm4gTUVOVS5TaG93U291cmNlLnc7CiAgfTsKCiAgTUVOVS5TaG93U291cmNlLlRleHQgPSBmdW5jdGlvbiAodGV4dCwgZXZlbnQpIHsKICAgIHZhciB3ID0gTUVOVS5TaG93U291cmNlLldpbmRvdyhldmVudCk7CiAgICBkZWxldGUgTUVOVS5TaG93U291cmNlLnc7CiAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC9eXHMqLywgIiIpLnJlcGxhY2UoL1xzKiQvLCAiIik7CiAgICB0ZXh0ID0gdGV4dC5yZXBsYWNlKC8mL2csICImYW1wOyIpLnJlcGxhY2UoLzwvZywgIiZsdDsiKS5yZXBsYWNlKC8+L2csICImZ3Q7Iik7CgogICAgdmFyIHRpdGxlID0gXygiRXFTb3VyY2UiLCAiTWF0aEpheCBFcXVhdGlvbiBTb3VyY2UiKTsKCiAgICBpZiAoTUVOVS5pc01vYmlsZSkgewogICAgICB3LmRvY3VtZW50Lm9wZW4oKTsKICAgICAgdy5kb2N1bWVudC53cml0ZSgiPGh0bWw+PGhlYWQ+PG1ldGEgbmFtZT0ndmlld3BvcnQnIGNvbnRlbnQ9J3dpZHRoPWRldmljZS13aWR0aCwgaW5pdGlhbC1zY2FsZT0xLjAnIC8+PHRpdGxlPiIgKyB0aXRsZSArICI8L3RpdGxlPjwvaGVhZD48Ym9keSBzdHlsZT0nZm9udC1zaXplOjg1JSc+Iik7CiAgICAgIHcuZG9jdW1lbnQud3JpdGUoIjxwcmU+IiArIHRleHQgKyAiPC9wcmU+Iik7CiAgICAgIHcuZG9jdW1lbnQud3JpdGUoIjxocj48aW5wdXQgdHlwZT0nYnV0dG9uJyB2YWx1ZT0nIiArIF8oIkNsb3NlIiwgIkNsb3NlIikgKyAiJyBvbmNsaWNrPSd3aW5kb3cuY2xvc2UoKScgLz4iKTsKICAgICAgdy5kb2N1bWVudC53cml0ZSgiPC9ib2R5PjwvaHRtbD4iKTsKICAgICAgdy5kb2N1bWVudC5jbG9zZSgpOwogICAgfSBlbHNlIHsKICAgICAgdy5kb2N1bWVudC5vcGVuKCk7CiAgICAgIHcuZG9jdW1lbnQud3JpdGUoIjxodG1sPjxoZWFkPjx0aXRsZT4iICsgdGl0bGUgKyAiPC90aXRsZT48L2hlYWQ+PGJvZHkgc3R5bGU9J2ZvbnQtc2l6ZTo4NSUnPiIpOwogICAgICB3LmRvY3VtZW50LndyaXRlKCI8dGFibGU+PHRyPjx0ZD48cHJlPiIgKyB0ZXh0ICsgIjwvcHJlPjwvdGQ+PC90cj48L3RhYmxlPiIpOwogICAgICB3LmRvY3VtZW50LndyaXRlKCI8L2JvZHk+PC9odG1sPiIpOwogICAgICB3LmRvY3VtZW50LmNsb3NlKCk7CiAgICAgIHZhciB0YWJsZSA9IHcuZG9jdW1lbnQuYm9keS5maXJzdENoaWxkOwogICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgSCA9IHcub3V0ZXJIZWlnaHQgLSB3LmlubmVySGVpZ2h0IHx8IDMwLAogICAgICAgICAgICBXID0gdy5vdXRlcldpZHRoIC0gdy5pbm5lcldpZHRoIHx8IDMwLAogICAgICAgICAgICB4LAogICAgICAgICAgICB5OwogICAgICAgIFcgPSBNYXRoLm1heCgxNDAsIE1hdGgubWluKE1hdGguZmxvb3IoLjUgKiBzY3JlZW4ud2lkdGgpLCB0YWJsZS5vZmZzZXRXaWR0aCArIFcgKyAyNSkpOwogICAgICAgIEggPSBNYXRoLm1heCg0MCwgTWF0aC5taW4oTWF0aC5mbG9vciguNSAqIHNjcmVlbi5oZWlnaHQpLCB0YWJsZS5vZmZzZXRIZWlnaHQgKyBIICsgMjUpKTsKCiAgICAgICAgaWYgKE1FTlUucHJvdG90eXBlLm1zaWVIZWlnaHRCdWcpIHsKICAgICAgICAgIEggKz0gMzU7CiAgICAgICAgfQoKICAgICAgICA7IC8vIGZvciB0aXRsZSBiYXIgaW4gWFAKCiAgICAgICAgdy5yZXNpemVUbyhXLCBIKTsKICAgICAgICB2YXIgWDsKCiAgICAgICAgdHJ5IHsKICAgICAgICAgIFggPSBldmVudC5zY3JlZW5YOwogICAgICAgIH0gY2F0Y2ggKGUpIHt9CgogICAgICAgIDsgLy8gSUU4IHRocm93cyBhbiBlcnJvciBhY2Nlc3Npbmcgc2NyZWVuWAoKICAgICAgICBpZiAoZXZlbnQgJiYgWCAhPSBudWxsKSB7CiAgICAgICAgICB4ID0gTWF0aC5tYXgoMCwgTWF0aC5taW4oZXZlbnQuc2NyZWVuWCAtIE1hdGguZmxvb3IoVyAvIDIpLCBzY3JlZW4ud2lkdGggLSBXIC0gMjApKTsKICAgICAgICAgIHkgPSBNYXRoLm1heCgwLCBNYXRoLm1pbihldmVudC5zY3JlZW5ZIC0gTWF0aC5mbG9vcihIIC8gMiksIHNjcmVlbi5oZWlnaHQgLSBIIC0gMjApKTsKICAgICAgICAgIHcubW92ZVRvKHgsIHkpOwogICAgICAgIH0KICAgICAgfSwgNTApOwogICAgfQogIH07CiAgLyoKICAgKiAgSGFuZGxlIHJlc2NhbGluZyBhbGwgdGhlIG1hdGgKICAgKi8KCgogIE1FTlUuU2NhbGUgPSBmdW5jdGlvbiAoKSB7CiAgICB2YXIgSkFYID0gWyJDb21tb25IVE1MIiwgIkhUTUwtQ1NTIiwgIlNWRyIsICJOYXRpdmVNTUwiLCAiUHJldmlld0hUTUwiXSwKICAgICAgICBtID0gSkFYLmxlbmd0aCwKICAgICAgICBTQ0FMRSA9IDEwMCwKICAgICAgICBpLAogICAgICAgIGpheDsKCiAgICBmb3IgKGkgPSAwOyBpIDwgbTsgaSsrKSB7CiAgICAgIGpheCA9IE9VVFBVVFtKQVhbaV1dOwoKICAgICAgaWYgKGpheCkgewogICAgICAgIFNDQUxFID0gamF4LmNvbmZpZy5zY2FsZTsKICAgICAgICBicmVhazsKICAgICAgfQogICAgfQoKICAgIHZhciBzY2FsZSA9IHByb21wdChfKCJTY2FsZU1hdGgiLCAiU2NhbGUgYWxsIG1hdGhlbWF0aWNzIChjb21wYXJlZCB0byBzdXJyb3VuZGluZyB0ZXh0KSBieSIpLCBTQ0FMRSArICIlIik7CgogICAgaWYgKHNjYWxlKSB7CiAgICAgIGlmIChzY2FsZS5tYXRjaCgvXlxzKlxkKyhcLlxkKik/XHMqJT9ccyokLykpIHsKICAgICAgICBzY2FsZSA9IHBhcnNlRmxvYXQoc2NhbGUpOwoKICAgICAgICBpZiAoc2NhbGUpIHsKICAgICAgICAgIGlmIChzY2FsZSAhPT0gU0NBTEUpIHsKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IG07IGkrKykgewogICAgICAgICAgICAgIGpheCA9IE9VVFBVVFtKQVhbaV1dOwogICAgICAgICAgICAgIGlmIChqYXgpIGpheC5jb25maWcuc2NhbGUgPSBzY2FsZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgTUVOVS5jb29raWUuc2NhbGUgPSBIVUIuY29uZmlnLnNjYWxlID0gc2NhbGU7CiAgICAgICAgICAgIE1FTlUuc2F2ZUNvb2tpZSgpOwogICAgICAgICAgICBIVUIuUXVldWUoWyJSZXJlbmRlciIsIEhVQl0pOwogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBhbGVydChfKCJOb25aZXJvU2NhbGUiLCAiVGhlIHNjYWxlIHNob3VsZCBub3QgYmUgemVybyIpKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgYWxlcnQoXygiUGVyY2VudFNjYWxlIiwgIlRoZSBzY2FsZSBzaG91bGQgYmUgYSBwZXJjZW50YWdlIChlLmcuLCAxMjAlJSkiKSk7CiAgICAgIH0KICAgIH0KICB9OwogIC8qCiAgICogIEhhbmRsZSBsb2FkaW5nIHRoZSB6b29tIGNvZGUKICAgKi8KCgogIE1FTlUuWm9vbSA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICghTWF0aEpheC5FeHRlbnNpb24uTWF0aFpvb20pIHsKICAgICAgQUpBWC5SZXF1aXJlKCJbTWF0aEpheF0vZXh0ZW5zaW9ucy9NYXRoWm9vbS5qcyIpOwogICAgfQogIH07CiAgLyoKICAgKiAgSGFuZGxlIGNoYW5naW5nIHRoZSByZW5kZXJlcgogICAqLwoKCiAgTUVOVS5SZW5kZXJlciA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciBqYXggPSBIVUIub3V0cHV0SmF4WyJqYXgvbW1sIl07CgogICAgaWYgKGpheFswXSAhPT0gQ09ORklHLnNldHRpbmdzLnJlbmRlcmVyKSB7CiAgICAgIHZhciBCUk9XU0VSID0gSFVCLkJyb3dzZXIsCiAgICAgICAgICBtZXNzYWdlLAogICAgICAgICAgTUVTU0FHRSA9IE1FTlUuUmVuZGVyZXIuTWVzc2FnZXMsCiAgICAgICAgICB3YXJuZWQ7IC8vCiAgICAgIC8vICBDaGVjayB0aGF0IHRoZSBuZXcgcmVuZGVyZXIgaXMgYXBwcm9wcmlhdGUgZm9yIHRoZSBicm93c2VyCiAgICAgIC8vCgogICAgICBzd2l0Y2ggKENPTkZJRy5zZXR0aW5ncy5yZW5kZXJlcikgewogICAgICAgIGNhc2UgIk5hdGl2ZU1NTCI6CiAgICAgICAgICBpZiAoIUNPTkZJRy5zZXR0aW5ncy53YXJuZWRNTUwpIHsKICAgICAgICAgICAgaWYgKEJST1dTRVIuaXNDaHJvbWUgJiYgQlJPV1NFUi52ZXJzaW9uLnN1YnN0cigwLCAzKSAhPT0gIjI0LiIpIHsKICAgICAgICAgICAgICBtZXNzYWdlID0gTUVTU0FHRS5NTUwuV2ViS2l0OwogICAgICAgICAgICB9IGVsc2UgaWYgKEJST1dTRVIuaXNTYWZhcmkgJiYgIUJST1dTRVIudmVyc2lvbkF0TGVhc3QoIjUuMCIpKSB7CiAgICAgICAgICAgICAgbWVzc2FnZSA9IE1FU1NBR0UuTU1MLldlYktpdDsKICAgICAgICAgICAgfSBlbHNlIGlmIChCUk9XU0VSLmlzTVNJRSkgewogICAgICAgICAgICAgIGlmICghQlJPV1NFUi5oYXNNYXRoUGxheWVyKSB7CiAgICAgICAgICAgICAgICBtZXNzYWdlID0gTUVTU0FHRS5NTUwuTVNJRTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoQlJPV1NFUi5pc0VkZ2UpIHsKICAgICAgICAgICAgICBtZXNzYWdlID0gTUVTU0FHRS5NTUwuV2ViS2l0OwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIG1lc3NhZ2UgPSBNRVNTQUdFLk1NTFtCUk9XU0VSXTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgd2FybmVkID0gIndhcm5lZE1NTCI7CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgIlNWRyI6CiAgICAgICAgICBpZiAoIUNPTkZJRy5zZXR0aW5ncy53YXJuZWRTVkcpIHsKICAgICAgICAgICAgaWYgKEJST1dTRVIuaXNNU0lFICYmICFpc0lFOSkgewogICAgICAgICAgICAgIG1lc3NhZ2UgPSBNRVNTQUdFLlNWRy5NU0lFOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgYnJlYWs7CiAgICAgIH0KCiAgICAgIGlmIChtZXNzYWdlKSB7CiAgICAgICAgbWVzc2FnZSA9IF8obWVzc2FnZVswXSwgbWVzc2FnZVsxXSk7CiAgICAgICAgbWVzc2FnZSArPSAiXG5cbiI7CiAgICAgICAgbWVzc2FnZSArPSBfKCJTd2l0Y2hBbnl3YXkiLCAiU3dpdGNoIHRoZSByZW5kZXJlciBhbnl3YXk/XG5cbiIgKyAiKFByZXNzIE9LIHRvIHN3aXRjaCwgQ0FOQ0VMIHRvIGNvbnRpbnVlIHdpdGggdGhlIGN1cnJlbnQgcmVuZGVyZXIpIik7CiAgICAgICAgTUVOVS5jb29raWUucmVuZGVyZXIgPSBqYXhbMF0uaWQ7CiAgICAgICAgTUVOVS5zYXZlQ29va2llKCk7CgogICAgICAgIGlmICghY29uZmlybShtZXNzYWdlKSkgewogICAgICAgICAgTUVOVS5jb29raWUucmVuZGVyZXIgPSBDT05GSUcuc2V0dGluZ3MucmVuZGVyZXIgPSBIVE1MLkNvb2tpZS5HZXQoIm1lbnUiKS5yZW5kZXJlcjsKICAgICAgICAgIE1FTlUuc2F2ZUNvb2tpZSgpOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KCiAgICAgICAgaWYgKHdhcm5lZCkgewogICAgICAgICAgTUVOVS5jb29raWUud2FybmVkID0gQ09ORklHLnNldHRpbmdzLndhcm5lZCA9IHRydWU7CiAgICAgICAgfQoKICAgICAgICBNRU5VLmNvb2tpZS5yZW5kZXJlciA9IENPTkZJRy5zZXR0aW5ncy5yZW5kZXJlcjsKICAgICAgICBNRU5VLnNhdmVDb29raWUoKTsKICAgICAgfQoKICAgICAgSFVCLlF1ZXVlKFsic2V0UmVuZGVyZXIiLCBIVUIsIENPTkZJRy5zZXR0aW5ncy5yZW5kZXJlciwgImpheC9tbWwiXSwgWyJSZXJlbmRlciIsIEhVQl0pOwogICAgfQogIH07CgogIE1FTlUuUmVuZGVyZXIuTWVzc2FnZXMgPSB7CiAgICBNTUw6IHsKICAgICAgV2ViS2l0OiBbIldlYmtpdE5hdGl2ZU1NTFdhcm5pbmciLCAiWW91ciBicm93c2VyIGRvZXNuJ3Qgc2VlbSB0byBzdXBwb3J0IE1hdGhNTCBuYXRpdmVseSwgIiArICJzbyBzd2l0Y2hpbmcgdG8gTWF0aE1MIG91dHB1dCBtYXkgY2F1c2UgdGhlIG1hdGhlbWF0aWNzICIgKyAib24gdGhlIHBhZ2UgdG8gYmVjb21lIHVucmVhZGFibGUuIl0sCiAgICAgIE1TSUU6IFsiTVNJRU5hdGl2ZU1NTFdhcm5pbmciLCAiSW50ZXJuZXQgRXhwbG9yZXIgcmVxdWlyZXMgdGhlIE1hdGhQbGF5ZXIgcGx1Z2luICIgKyAiaW4gb3JkZXIgdG8gcHJvY2VzcyBNYXRoTUwgb3V0cHV0LiJdLAogICAgICBPcGVyYTogWyJPcGVyYU5hdGl2ZU1NTFdhcm5pbmciLCAiT3BlcmEncyBzdXBwb3J0IGZvciBNYXRoTUwgaXMgbGltaXRlZCwgc28gc3dpdGNoaW5nIHRvICIgKyAiTWF0aE1MIG91dHB1dCBtYXkgY2F1c2Ugc29tZSBleHByZXNzaW9ucyB0byByZW5kZXIgcG9vcmx5LiJdLAogICAgICBTYWZhcmk6IFsiU2FmYXJpTmF0aXZlTU1MV2FybmluZyIsICJZb3VyIGJyb3dzZXIncyBuYXRpdmUgTWF0aE1MIGRvZXMgbm90IGltcGxlbWVudCBhbGwgdGhlIGZlYXR1cmVzICIgKyAidXNlZCBieSBNYXRoSmF4LCBzbyBzb21lIGV4cHJlc3Npb25zIG1heSBub3QgcmVuZGVyIHByb3Blcmx5LiJdLAogICAgICBGaXJlZm94OiBbIkZpcmVmb3hOYXRpdmVNTUxXYXJuaW5nIiwgIllvdXIgYnJvd3NlcidzIG5hdGl2ZSBNYXRoTUwgZG9lcyBub3QgaW1wbGVtZW50IGFsbCB0aGUgZmVhdHVyZXMgIiArICJ1c2VkIGJ5IE1hdGhKYXgsIHNvIHNvbWUgZXhwcmVzc2lvbnMgbWF5IG5vdCByZW5kZXIgcHJvcGVybHkuIl0KICAgIH0sCiAgICBTVkc6IHsKICAgICAgTVNJRTogWyJNU0lFU1ZHV2FybmluZyIsICJTVkcgaXMgbm90IGltcGxlbWVudGVkIGluIEludGVybmV0IEV4cGxvcmVyIHByaW9yIHRvICIgKyAiSUU5IG9yIHdoZW4gaXQgaXMgZW11bGF0aW5nIElFOCBvciBiZWxvdy4gIiArICJTd2l0Y2hpbmcgdG8gU1ZHIG91dHB1dCB3aWxsIGNhdXNlIHRoZSBtYXRoZW1hdGljcyB0byAiICsgIm5vdCBkaXNwbGF5IHByb3Blcmx5LiJdCiAgICB9CiAgfTsKICAvKgogICAqICBUb2dnbGUgYXNzaXN0aXZlIE1NTCBzZXR0aW5ncwogICAqLwoKICBNRU5VLkFzc2lzdGl2ZU1NTCA9IGZ1bmN0aW9uIChpdGVtLCByZXN0YXJ0KSB7CiAgICB2YXIgQU1NTCA9IE1hdGhKYXguRXh0ZW5zaW9uLkFzc2lzdGl2ZU1NTDsKCiAgICBpZiAoIUFNTUwpIHsKICAgICAgLy8gIFRyeSB0byBsb2FkIHRoZSBleHRlbnNpb24sIGJ1dCBvbmx5IHRyeSBvbmNlLgogICAgICBpZiAoIXJlc3RhcnQpIEFKQVguUmVxdWlyZSgiW01hdGhKYXhdL2V4dGVuc2lvbnMvQXNzaXN0aXZlTU1MLmpzIiwgWyJBc3Npc3RpdmVNTUwiLCBNRU5VLCBpdGVtLCB0cnVlXSk7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBNYXRoSmF4Lkh1Yi5RdWV1ZShbKENPTkZJRy5zZXR0aW5ncy5hc3Npc3RpdmVNTUwgPyAiQWRkIiA6ICJSZW1vdmUiKSArICJBc3Npc3RpdmVNYXRoTUwiLCBBTU1MXSk7CiAgfTsKICAvKgogICAqICBIYW5kbGUgc2V0dGluZyB0aGUgSFRNTENTUyBmb250cwogICAqLwoKCiAgTUVOVS5Gb250ID0gZnVuY3Rpb24gKCkgewogICAgdmFyIEhUTUxDU1MgPSBPVVRQVVRbIkhUTUwtQ1NTIl07CiAgICBpZiAoIUhUTUxDU1MpIHJldHVybjsKICAgIGRvY3VtZW50LmxvY2F0aW9uLnJlbG9hZCgpOwogIH07CiAgLyoKICAgKiAgSGFuZGxlIHNlbGVjdGlvbiBvZiBsb2NhbGUgYW5kIHJlcmVuZGVyIHRoZSBwYWdlCiAgICovCgoKICBNRU5VLkxvY2FsZSA9IGZ1bmN0aW9uICgpIHsKICAgIE1hdGhKYXguTG9jYWxpemF0aW9uLnNldExvY2FsZShDT05GSUcuc2V0dGluZ3MubG9jYWxlKTsKICAgIE1hdGhKYXguSHViLlF1ZXVlKFsiUmVwcm9jZXNzIiwgTWF0aEpheC5IdWJdKTsgLy8gRklYTUU6IEp1c3QgcmVwcm9jZXNzIGVycm9yIG1lc3NhZ2VzPwogIH07CgogIE1FTlUuTG9hZExvY2FsZSA9IGZ1bmN0aW9uICgpIHsKICAgIHZhciB1cmwgPSBwcm9tcHQoXygiTG9hZFVSTCIsICJMb2FkIHRyYW5zbGF0aW9uIGRhdGEgZnJvbSB0aGlzIFVSTDoiKSk7CgogICAgaWYgKHVybCkgewogICAgICBpZiAoIXVybC5tYXRjaCgvXC5qcyQvKSkgewogICAgICAgIGFsZXJ0KF8oIkJhZFVSTCIsICJUaGUgVVJMIHNob3VsZCBiZSBmb3IgYSBqYXZhc2NyaXB0IGZpbGUgdGhhdCBkZWZpbmVzIE1hdGhKYXggdHJhbnNsYXRpb24gZGF0YS4gICIgKyAiSmF2YXNjcmlwdCBmaWxlIG5hbWVzIHNob3VsZCBlbmQgd2l0aCAnLmpzJyIpKTsKICAgICAgfQoKICAgICAgQUpBWC5SZXF1aXJlKHVybCwgZnVuY3Rpb24gKHN0YXR1cykgewogICAgICAgIGlmIChzdGF0dXMgIT0gQUpBWC5TVEFUVVMuT0spIHsKICAgICAgICAgIGFsZXJ0KF8oIkJhZERhdGEiLCAiRmFpbGVkIHRvIGxvYWQgdHJhbnNsYXRpb24gZGF0YSBmcm9tICUxIiwgdXJsKSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0KICB9OwogIC8qCiAgICogIEhhbmRsZSBzZXR0aW5nIE1hdGhQbGF5ZXIgZXZlbnRzCiAgICovCgoKICBNRU5VLk1QRXZlbnRzID0gZnVuY3Rpb24gKGl0ZW0pIHsKICAgIHZhciBkaXNjb3ZlcmFibGUgPSBDT05GSUcuc2V0dGluZ3MuZGlzY292ZXJhYmxlLAogICAgICAgIE1FU1NBR0UgPSBNRU5VLk1QRXZlbnRzLk1lc3NhZ2VzOwoKICAgIGlmICghaXNJRTkpIHsKICAgICAgaWYgKENPTkZJRy5zZXR0aW5ncy5tcE1vdXNlICYmICFjb25maXJtKF8uYXBwbHkoXywgTUVTU0FHRS5JRTh3YXJuaW5nKSkpIHsKICAgICAgICBkZWxldGUgTUVOVS5jb29raWUubXBDb250ZXh0OwogICAgICAgIGRlbGV0ZSBDT05GSUcuc2V0dGluZ3MubXBDb250ZXh0OwogICAgICAgIGRlbGV0ZSBNRU5VLmNvb2tpZS5tcE1vdXNlOwogICAgICAgIGRlbGV0ZSBDT05GSUcuc2V0dGluZ3MubXBNb3VzZTsKICAgICAgICBNRU5VLnNhdmVDb29raWUoKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIENPTkZJRy5zZXR0aW5ncy5tcENvbnRleHQgPSBDT05GSUcuc2V0dGluZ3MubXBNb3VzZTsKICAgICAgTUVOVS5jb29raWUubXBDb250ZXh0ID0gTUVOVS5jb29raWUubXBNb3VzZSA9IENPTkZJRy5zZXR0aW5ncy5tcE1vdXNlOwogICAgICBNRU5VLnNhdmVDb29raWUoKTsKICAgICAgTWF0aEpheC5IdWIuUXVldWUoWyJSZXJlbmRlciIsIE1hdGhKYXguSHViXSk7CiAgICB9IGVsc2UgaWYgKCFkaXNjb3ZlcmFibGUgJiYgaXRlbS5uYW1lWzFdID09PSAiTWVudSBFdmVudHMiICYmIENPTkZJRy5zZXR0aW5ncy5tcENvbnRleHQpIHsKICAgICAgYWxlcnQoXy5hcHBseShfLCBNRVNTQUdFLklFOXdhcm5pbmcpKTsKICAgIH0KICB9OwoKICBNRU5VLk1QRXZlbnRzLk1lc3NhZ2VzID0gewogICAgSUU4d2FybmluZzogWyJJRTh3YXJuaW5nIiwgIlRoaXMgd2lsbCBkaXNhYmxlIHRoZSBNYXRoSmF4IG1lbnUgYW5kIHpvb20gZmVhdHVyZXMsICIgKyAiYnV0IHlvdSBjYW4gQWx0LUNsaWNrIG9uIGFuIGV4cHJlc3Npb24gdG8gb2J0YWluIHRoZSBNYXRoSmF4ICIgKyAibWVudSBpbnN0ZWFkLlxuXG5SZWFsbHkgY2hhbmdlIHRoZSBNYXRoUGxheWVyIHNldHRpbmdzPyJdLAogICAgSUU5d2FybmluZzogWyJJRTl3YXJuaW5nIiwgIlRoZSBNYXRoSmF4IGNvbnRleHR1YWwgbWVudSB3aWxsIGJlIGRpc2FibGVkLCBidXQgeW91IGNhbiAiICsgIkFsdC1DbGljayBvbiBhbiBleHByZXNzaW9uIHRvIG9idGFpbiB0aGUgTWF0aEpheCBtZW51IGluc3RlYWQuIl0KICB9OwogIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCiAgSFVCLkJyb3dzZXIuU2VsZWN0KHsKICAgIE1TSUU6IGZ1bmN0aW9uIE1TSUUoYnJvd3NlcikgewogICAgICB2YXIgcXVpcmtzID0gZG9jdW1lbnQuY29tcGF0TW9kZSA9PT0gIkJhY2tDb21wYXQiOwogICAgICB2YXIgaXNJRTggPSBicm93c2VyLnZlcnNpb25BdExlYXN0KCI4LjAiKSAmJiBkb2N1bWVudC5kb2N1bWVudE1vZGUgPiA3OwogICAgICBNRU5VLkF1Z21lbnQoewogICAgICAgIG1hcmdpbjogMjAsCiAgICAgICAgbXNpZUJhY2tncm91bmRCdWc6IChkb2N1bWVudC5kb2N1bWVudE1vZGUgfHwgMCkgPCA5LAogICAgICAgIG1zaWVGaXhlZFBvc2l0aW9uQnVnOiBxdWlya3MgfHwgIWlzSUU4LAogICAgICAgIG1zaWVBYm91dEJ1ZzogcXVpcmtzLAogICAgICAgIG1zaWVIZWlnaHRCdWc6IChkb2N1bWVudC5kb2N1bWVudE1vZGUgfHwgMCkgPCA5IC8vIGhlaWdodCBvZiB3aW5kb3cgZG9lc24ndCBpbmNsdWRlIHRpdGxlIGJhciBpbiBYUAoKICAgICAgfSk7CgogICAgICBpZiAoaXNJRTkpIHsKICAgICAgICBkZWxldGUgQ09ORklHLnN0eWxlc1siI01hdGhKYXhfQWJvdXQiXS5maWx0ZXI7CiAgICAgICAgZGVsZXRlIENPTkZJRy5zdHlsZXNbIi5NYXRoSmF4X01lbnUiXS5maWx0ZXI7CiAgICAgIH0KICAgIH0sCiAgICBGaXJlZm94OiBmdW5jdGlvbiBGaXJlZm94KGJyb3dzZXIpIHsKICAgICAgTUVOVS5za2lwTW91c2VvdmVyID0gYnJvd3Nlci5pc01vYmlsZSAmJiBicm93c2VyLnZlcnNpb25BdExlYXN0KCI2LjAiKTsKICAgICAgTUVOVS5za2lwTW91c2Vkb3duID0gYnJvd3Nlci5pc01vYmlsZTsKICAgIH0KICB9KTsKICBNRU5VLmlzTW9iaWxlID0gSFVCLkJyb3dzZXIuaXNNb2JpbGU7CiAgTUVOVS5ub0NvbnRleHRNZW51ID0gSFVCLkJyb3dzZXIubm9Db250ZXh0TWVudTsKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAvLwogIC8vICBDcmVhdGVzIHRoZSBsb2NhbGUgbWVudSBmcm9tIHRoZSBsaXN0IG9mIGxvY2FsZXMgaW4gTWF0aEpheC5Mb2NhbGl6YXRpb24uc3RyaW5ncwogIC8vCgogIE1FTlUuQ3JlYXRlTG9jYWxlTWVudSA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICghTUVOVS5tZW51KSByZXR1cm47CiAgICB2YXIgbWVudSA9IE1FTlUubWVudS5GaW5kKCJMYW5ndWFnZSIpLnN1Ym1lbnUsCiAgICAgICAgaXRlbXMgPSBtZW51Lml0ZW1zOyAvLwogICAgLy8gIEdldCB0aGUgbmFtZXMgb2YgdGhlIGxhbmd1YWdlcyBhbmQgc29ydCB0aGVtCiAgICAvLwoKICAgIHZhciBsb2NhbGVzID0gW10sCiAgICAgICAgTE9DQUxFID0gTWF0aEpheC5Mb2NhbGl6YXRpb24uc3RyaW5nczsKCiAgICBmb3IgKHZhciBpZCBpbiBMT0NBTEUpIHsKICAgICAgaWYgKExPQ0FMRS5oYXNPd25Qcm9wZXJ0eShpZCkpIHsKICAgICAgICBsb2NhbGVzLnB1c2goaWQpOwogICAgICB9CiAgICB9CgogICAgbG9jYWxlcyA9IGxvY2FsZXMuc29ydCgpOwogICAgbWVudS5pdGVtcyA9IFtdOyAvLwogICAgLy8gIEFkZCBhIG1lbnUgaXRlbSBmb3IgZWFjaAogICAgLy8KCiAgICBmb3IgKHZhciBpID0gMCwgbSA9IGxvY2FsZXMubGVuZ3RoOyBpIDwgbTsgaSsrKSB7CiAgICAgIHZhciB0aXRsZSA9IExPQ0FMRVtsb2NhbGVzW2ldXS5tZW51VGl0bGU7CgogICAgICBpZiAodGl0bGUpIHsKICAgICAgICB0aXRsZSArPSAiICgiICsgbG9jYWxlc1tpXSArICIpIjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aXRsZSA9IGxvY2FsZXNbaV07CiAgICAgIH0KCiAgICAgIG1lbnUuaXRlbXMucHVzaChJVEVNLlJBRElPKFtsb2NhbGVzW2ldLCB0aXRsZV0sICJsb2NhbGUiLCB7CiAgICAgICAgYWN0aW9uOiBNRU5VLkxvY2FsZQogICAgICB9KSk7CiAgICB9IC8vCiAgICAvLyAgQWRkIHRoZSBydWxlIGFuZCAiTG9hZCBmcm9tIFVSTCIgaXRlbXMKICAgIC8vCgoKICAgIG1lbnUuaXRlbXMucHVzaChpdGVtc1tpdGVtcy5sZW5ndGggLSAyXSwgaXRlbXNbaXRlbXMubGVuZ3RoIC0gMV0pOwogIH07IC8vCiAgLy8gQ3JlYXRlIHRoZSBhbm5vdGF0aW9uIG1lbnUgZnJvbSBNYXRoSmF4Lkh1Yi5jb25maWcuc2VtYW50aWNzQW5ub3RhdGlvbnMKICAvLwoKCiAgTUVOVS5DcmVhdGVBbm5vdGF0aW9uTWVudSA9IGZ1bmN0aW9uICgpIHsKICAgIGlmICghTUVOVS5tZW51KSByZXR1cm47CiAgICB2YXIgbWVudSA9IE1FTlUubWVudS5GaW5kKCJTaG93IE1hdGggQXMiLCAiQW5ub3RhdGlvbiIpLnN1Ym1lbnU7CiAgICB2YXIgYW5ub3RhdGlvbnMgPSBDT05GSUcuc2VtYW50aWNzQW5ub3RhdGlvbnM7CgogICAgZm9yICh2YXIgYSBpbiBhbm5vdGF0aW9ucykgewogICAgICBpZiAoYW5ub3RhdGlvbnMuaGFzT3duUHJvcGVydHkoYSkpIHsKICAgICAgICBtZW51Lml0ZW1zLnB1c2goSVRFTS5DT01NQU5EKFthLCBhXSwgTUVOVS5TaG93U291cmNlLCB7CiAgICAgICAgICBoaWRkZW46IHRydWUsCiAgICAgICAgICBuYXRpdmVUb3VjaDogdHJ1ZSwKICAgICAgICAgIGZvcm1hdDogYQogICAgICAgIH0pKTsKICAgICAgfQogICAgfQogIH07CiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgoKICBIVUIuUmVnaXN0ZXIuU3RhcnR1cEhvb2soIkVuZCBDb25maWciLCBmdW5jdGlvbiAoKSB7CiAgICAvKgogICAgICogIEdldCB0aGUgbWVudSBzZXR0aW5ncyBmcm9tIHRoZSBIVUIgKHdoaWNoIGluY2x1ZGVzIHRoZQogICAgICogIGRhdGEgZnJvbSB0aGUgY29va2llIGFscmVhZHkpLCBhbmQgYWRkIHRoZSBmb3JtYXQsIGlmCiAgICAgKiAgaXQgd2Fzbid0IHNldCBpbiB0aGUgY29va2llLgogICAgICovCiAgICBDT05GSUcuc2V0dGluZ3MgPSBIVUIuY29uZmlnLm1lbnVTZXR0aW5nczsKCiAgICBpZiAodHlwZW9mIENPTkZJRy5zZXR0aW5ncy5zaG93UmVuZGVyZXIgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIENPTkZJRy5zaG93UmVuZGVyZXIgPSBDT05GSUcuc2V0dGluZ3Muc2hvd1JlbmRlcmVyOwogICAgfQoKICAgIGlmICh0eXBlb2YgQ09ORklHLnNldHRpbmdzLnNob3dGb250TWVudSAhPT0gInVuZGVmaW5lZCIpIHsKICAgICAgQ09ORklHLnNob3dGb250TWVudSA9IENPTkZJRy5zZXR0aW5ncy5zaG93Rm9udE1lbnU7CiAgICB9CgogICAgaWYgKHR5cGVvZiBDT05GSUcuc2V0dGluZ3Muc2hvd0NvbnRleHQgIT09ICJ1bmRlZmluZWQiKSB7CiAgICAgIENPTkZJRy5zaG93Q29udGV4dCA9IENPTkZJRy5zZXR0aW5ncy5zaG93Q29udGV4dDsKICAgIH0KCiAgICBNRU5VLmdldENvb2tpZSgpOwogICAgLyoKICAgICAqICBUaGUgbWFpbiBtZW51CiAgICAgKi8KICAgIC8vIExvY2FsaXphdGlvbjogaXRlbXMgdXNlZCBhcyBrZXksIHNob3VsZCBiZSByZWZhY3RvcmVkLgoKICAgIE1FTlUubWVudSA9IE1FTlUoSVRFTS5TVUJNRU5VKFsiU2hvdyIsICJTaG93IE1hdGggQXMiXSwgSVRFTS5DT01NQU5EKFsiTWF0aE1MY29kZSIsICJNYXRoTUwgQ29kZSJdLCBNRU5VLlNob3dTb3VyY2UsIHsKICAgICAgbmF0aXZlVG91Y2g6IHRydWUsCiAgICAgIGZvcm1hdDogIk1hdGhNTCIKICAgIH0pLCBJVEVNLkNPTU1BTkQoWyJPcmlnaW5hbCIsICJPcmlnaW5hbCBGb3JtIl0sIE1FTlUuU2hvd1NvdXJjZSwgewogICAgICBuYXRpdmVUb3VjaDogdHJ1ZQogICAgfSksIElURU0uU1VCTUVOVShbIkFubm90YXRpb24iLCAiQW5ub3RhdGlvbiJdLCB7CiAgICAgIGRpc2FibGVkOiB0cnVlCiAgICB9KSwgSVRFTS5SVUxFKCksIElURU0uQ0hFQ0tCT1goWyJ0ZXhIaW50cyIsICJTaG93IFRlWCBoaW50cyBpbiBNYXRoTUwiXSwgInRleEhpbnRzIiksIElURU0uQ0hFQ0tCT1goWyJzZW1hbnRpY3MiLCAiQWRkIG9yaWdpbmFsIGZvcm0gYXMgYW5ub3RhdGlvbiJdLCAic2VtYW50aWNzIikpLCBJVEVNLlJVTEUoKSwgSVRFTS5TVUJNRU5VKFsiU2V0dGluZ3MiLCAiTWF0aCBTZXR0aW5ncyJdLCBJVEVNLlNVQk1FTlUoWyJab29tVHJpZ2dlciIsICJab29tIFRyaWdnZXIiXSwgSVRFTS5SQURJTyhbIkhvdmVyIiwgIkhvdmVyIl0sICJ6b29tIiwgewogICAgICBhY3Rpb246IE1FTlUuWm9vbQogICAgfSksIElURU0uUkFESU8oWyJDbGljayIsICJDbGljayJdLCAiem9vbSIsIHsKICAgICAgYWN0aW9uOiBNRU5VLlpvb20KICAgIH0pLCBJVEVNLlJBRElPKFsiRG91YmxlQ2xpY2siLCAiRG91YmxlLUNsaWNrIl0sICJ6b29tIiwgewogICAgICBhY3Rpb246IE1FTlUuWm9vbQogICAgfSksIElURU0uUkFESU8oWyJOb1pvb20iLCAiTm8gWm9vbSJdLCAiem9vbSIsIHsKICAgICAgdmFsdWU6ICJOb25lIgogICAgfSksIElURU0uUlVMRSgpLCBJVEVNLkxBQkVMKFsiVHJpZ2dlclJlcXVpcmVzIiwgIlRyaWdnZXIgUmVxdWlyZXM6Il0pLCBJVEVNLkNIRUNLQk9YKEhVQi5Ccm93c2VyLmlzTWFjID8gWyJPcHRpb24iLCAiT3B0aW9uIl0gOiBbIkFsdCIsICJBbHQiXSwgIkFMVCIpLCBJVEVNLkNIRUNLQk9YKFsiQ29tbWFuZCIsICJDb21tYW5kIl0sICJDTUQiLCB7CiAgICAgIGhpZGRlbjogIUhVQi5Ccm93c2VyLmlzTWFjCiAgICB9KSwgSVRFTS5DSEVDS0JPWChbIkNvbnRyb2wiLCAiQ29udHJvbCJdLCAiQ1RSTCIsIHsKICAgICAgaGlkZGVuOiBIVUIuQnJvd3Nlci5pc01hYwogICAgfSksIElURU0uQ0hFQ0tCT1goWyJTaGlmdCIsICJTaGlmdCJdLCAiU2hpZnQiKSksIElURU0uU1VCTUVOVShbIlpvb21GYWN0b3IiLCAiWm9vbSBGYWN0b3IiXSwgSVRFTS5SQURJTygiMTI1JSIsICJ6c2NhbGUiKSwgSVRFTS5SQURJTygiMTMzJSIsICJ6c2NhbGUiKSwgSVRFTS5SQURJTygiMTUwJSIsICJ6c2NhbGUiKSwgSVRFTS5SQURJTygiMTc1JSIsICJ6c2NhbGUiKSwgSVRFTS5SQURJTygiMjAwJSIsICJ6c2NhbGUiKSwgSVRFTS5SQURJTygiMjUwJSIsICJ6c2NhbGUiKSwgSVRFTS5SQURJTygiMzAwJSIsICJ6c2NhbGUiKSwgSVRFTS5SQURJTygiNDAwJSIsICJ6c2NhbGUiKSksIElURU0uUlVMRSgpLCBJVEVNLlNVQk1FTlUoWyJSZW5kZXJlciIsICJNYXRoIFJlbmRlcmVyIl0sIHsKICAgICAgaGlkZGVuOiAhQ09ORklHLnNob3dSZW5kZXJlcgogICAgfSwgSVRFTS5SQURJTyhbIkhUTUwtQ1NTIiwgIkhUTUwtQ1NTIl0sICJyZW5kZXJlciIsIHsKICAgICAgYWN0aW9uOiBNRU5VLlJlbmRlcmVyCiAgICB9KSwgSVRFTS5SQURJTyhbIkNvbW1vbkhUTUwiLCAiQ29tbW9uIEhUTUwiXSwgInJlbmRlcmVyIiwgewogICAgICBhY3Rpb246IE1FTlUuUmVuZGVyZXIsCiAgICAgIHZhbHVlOiAiQ29tbW9uSFRNTCIKICAgIH0pLCBJVEVNLlJBRElPKFsiUHJldmlld0hUTUwiLCAiUHJldmlldyBIVE1MIl0sICJyZW5kZXJlciIsIHsKICAgICAgYWN0aW9uOiBNRU5VLlJlbmRlcmVyLAogICAgICB2YWx1ZTogIlByZXZpZXdIVE1MIgogICAgfSksIElURU0uUkFESU8oWyJNYXRoTUwiLCAiTWF0aE1MIl0sICJyZW5kZXJlciIsIHsKICAgICAgYWN0aW9uOiBNRU5VLlJlbmRlcmVyLAogICAgICB2YWx1ZTogIk5hdGl2ZU1NTCIKICAgIH0pLCBJVEVNLlJBRElPKFsiU1ZHIiwgIlNWRyJdLCAicmVuZGVyZXIiLCB7CiAgICAgIGFjdGlvbjogTUVOVS5SZW5kZXJlcgogICAgfSksIElURU0uUkFESU8oWyJQbGFpblNvdXJjZSIsICJQbGFpbiBTb3VyY2UiXSwgInJlbmRlcmVyIiwgewogICAgICBhY3Rpb246IE1FTlUuUmVuZGVyZXIsCiAgICAgIHZhbHVlOiAiUGxhaW5Tb3VyY2UiCiAgICB9KSwgSVRFTS5SVUxFKCksIElURU0uQ0hFQ0tCT1goWyJGYXN0UHJldmlldyIsICJGYXN0IFByZXZpZXciXSwgIkZhc3RQcmV2aWV3IiksIElURU0uQ0hFQ0tCT1goWyJBc3Npc3RpdmVNTUwiLCAiQXNzaXN0aXZlIE1hdGhNTCJdLCAiYXNzaXN0aXZlTU1MIiwgewogICAgICBhY3Rpb246IE1FTlUuQXNzaXN0aXZlTU1MCiAgICB9KSwgSVRFTS5DSEVDS0JPWChbIkluVGFiT3JkZXIiLCAiSW5jbHVkZSBpbiBUYWIgT3JkZXIiXSwgImluVGFiT3JkZXIiKSksIElURU0uU1VCTUVOVSgiTWF0aFBsYXllciIsIHsKICAgICAgaGlkZGVuOiAhSFVCLkJyb3dzZXIuaXNNU0lFIHx8ICFDT05GSUcuc2hvd01hdGhQbGF5ZXIsCiAgICAgIGRpc2FibGVkOiAhSFVCLkJyb3dzZXIuaGFzTWF0aFBsYXllcgogICAgfSwgSVRFTS5MQUJFTChbIk1QSGFuZGxlcyIsICJMZXQgTWF0aFBsYXllciBIYW5kbGU6Il0pLCBJVEVNLkNIRUNLQk9YKFsiTWVudUV2ZW50cyIsICJNZW51IEV2ZW50cyJdLCAibXBDb250ZXh0IiwgewogICAgICBhY3Rpb246IE1FTlUuTVBFdmVudHMsCiAgICAgIGhpZGRlbjogIWlzSUU5CiAgICB9KSwgSVRFTS5DSEVDS0JPWChbIk1vdXNlRXZlbnRzIiwgIk1vdXNlIEV2ZW50cyJdLCAibXBNb3VzZSIsIHsKICAgICAgYWN0aW9uOiBNRU5VLk1QRXZlbnRzLAogICAgICBoaWRkZW46ICFpc0lFOQogICAgfSksIElURU0uQ0hFQ0tCT1goWyJNZW51QW5kTW91c2UiLCAiTW91c2UgYW5kIE1lbnUgRXZlbnRzIl0sICJtcE1vdXNlIiwgewogICAgICBhY3Rpb246IE1FTlUuTVBFdmVudHMsCiAgICAgIGhpZGRlbjogaXNJRTkKICAgIH0pKSwgSVRFTS5TVUJNRU5VKFsiRm9udFByZWZzIiwgIkZvbnQgUHJlZmVyZW5jZSJdLCB7CiAgICAgIGhpZGRlbjogIUNPTkZJRy5zaG93Rm9udE1lbnUKICAgIH0sIElURU0uTEFCRUwoWyJGb3JIVE1MQ1NTIiwgIkZvciBIVE1MLUNTUzoiXSksIElURU0uUkFESU8oWyJBdXRvIiwgIkF1dG8iXSwgImZvbnQiLCB7CiAgICAgIGFjdGlvbjogTUVOVS5Gb250CiAgICB9KSwgSVRFTS5SVUxFKCksIElURU0uUkFESU8oWyJUZVhMb2NhbCIsICJUZVggKGxvY2FsKSJdLCAiZm9udCIsIHsKICAgICAgYWN0aW9uOiBNRU5VLkZvbnQKICAgIH0pLCBJVEVNLlJBRElPKFsiVGVYV2ViIiwgIlRlWCAod2ViKSJdLCAiZm9udCIsIHsKICAgICAgYWN0aW9uOiBNRU5VLkZvbnQKICAgIH0pLCBJVEVNLlJBRElPKFsiVGVYSW1hZ2UiLCAiVGVYIChpbWFnZSkiXSwgImZvbnQiLCB7CiAgICAgIGFjdGlvbjogTUVOVS5Gb250CiAgICB9KSwgSVRFTS5SVUxFKCksIElURU0uUkFESU8oWyJTVElYTG9jYWwiLCAiU1RJWCAobG9jYWwpIl0sICJmb250IiwgewogICAgICBhY3Rpb246IE1FTlUuRm9udAogICAgfSksIElURU0uUkFESU8oWyJTVElYV2ViIiwgIlNUSVggKHdlYikiXSwgImZvbnQiLCB7CiAgICAgIGFjdGlvbjogTUVOVS5Gb250CiAgICB9KSwgSVRFTS5SVUxFKCksIElURU0uUkFESU8oWyJBc2FuYU1hdGhXZWIiLCAiQXNhbmEgTWF0aCAod2ViKSJdLCAiZm9udCIsIHsKICAgICAgYWN0aW9uOiBNRU5VLkZvbnQKICAgIH0pLCBJVEVNLlJBRElPKFsiR3lyZVBhZ2VsbGFXZWIiLCAiR3lyZSBQYWdlbGxhICh3ZWIpIl0sICJmb250IiwgewogICAgICBhY3Rpb246IE1FTlUuRm9udAogICAgfSksIElURU0uUkFESU8oWyJHeXJlVGVybWVzV2ViIiwgIkd5cmUgVGVybWVzICh3ZWIpIl0sICJmb250IiwgewogICAgICBhY3Rpb246IE1FTlUuRm9udAogICAgfSksIElURU0uUkFESU8oWyJMYXRpbk1vZGVybldlYiIsICJMYXRpbiBNb2Rlcm4gKHdlYikiXSwgImZvbnQiLCB7CiAgICAgIGFjdGlvbjogTUVOVS5Gb250CiAgICB9KSwgSVRFTS5SQURJTyhbIk5lb0V1bGVyV2ViIiwgIk5lbyBFdWxlciAod2ViKSJdLCAiZm9udCIsIHsKICAgICAgYWN0aW9uOiBNRU5VLkZvbnQKICAgIH0pKSwgSVRFTS5TVUJNRU5VKFsiQ29udGV4dE1lbnUiLCAiQ29udGV4dHVhbCBNZW51Il0sIHsKICAgICAgaGlkZGVuOiAhQ09ORklHLnNob3dDb250ZXh0CiAgICB9LCBJVEVNLlJBRElPKFsiTWF0aEpheCIsICJNYXRoSmF4Il0sICJjb250ZXh0IiksIElURU0uUkFESU8oWyJCcm93c2VyIiwgIkJyb3dzZXIiXSwgImNvbnRleHQiKSksIElURU0uQ09NTUFORChbIlNjYWxlIiwgIlNjYWxlIEFsbCBNYXRoIC4uLiJdLCBNRU5VLlNjYWxlKSwgSVRFTS5SVUxFKCkuV2l0aCh7CiAgICAgIGhpZGRlbjogIUNPTkZJRy5zaG93RGlzY292ZXJhYmxlLAogICAgICBuYW1lOiBbIiIsICJkaXNjb3Zlcl9ydWxlIl0KICAgIH0pLCBJVEVNLkNIRUNLQk9YKFsiRGlzY292ZXJhYmxlIiwgIkhpZ2hsaWdodCBvbiBIb3ZlciJdLCAiZGlzY292ZXJhYmxlIiwgewogICAgICBoaWRkZW46ICFDT05GSUcuc2hvd0Rpc2NvdmVyYWJsZQogICAgfSkpLCBJVEVNLlNVQk1FTlUoWyJMb2NhbGUiLCAiTGFuZ3VhZ2UiXSwgewogICAgICBoaWRkZW46ICFDT05GSUcuc2hvd0xvY2FsZSwKICAgICAgbHRyOiB0cnVlCiAgICB9LCBJVEVNLlJBRElPKCJlbiIsICJsb2NhbGUiLCB7CiAgICAgIGFjdGlvbjogTUVOVS5Mb2NhbGUKICAgIH0pLCBJVEVNLlJVTEUoKS5XaXRoKHsKICAgICAgaGlkZGVuOiAhQ09ORklHLnNob3dMb2NhbGVVUkwsCiAgICAgIG5hbWU6IFsiIiwgImxvY2FsVVJMX3J1bGUiXQogICAgfSksIElURU0uQ09NTUFORChbIkxvYWRMb2NhbGUiLCAiTG9hZCBmcm9tIFVSTCAuLi4iXSwgTUVOVS5Mb2FkTG9jYWxlLCB7CiAgICAgIGhpZGRlbjogIUNPTkZJRy5zaG93TG9jYWxlVVJMCiAgICB9KSksIElURU0uUlVMRSgpLCBJVEVNLkNPTU1BTkQoWyJBYm91dCIsICJBYm91dCBNYXRoSmF4Il0sIE1FTlUuQWJvdXQpLCBJVEVNLkNPTU1BTkQoWyJIZWxwIiwgIk1hdGhKYXggSGVscCJdLCBNRU5VLkhlbHApKTsKCiAgICBpZiAoTUVOVS5pc01vYmlsZSkgewogICAgICAoZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzZXR0aW5ncyA9IENPTkZJRy5zZXR0aW5nczsKICAgICAgICB2YXIgdHJpZ2dlciA9IE1FTlUubWVudS5GaW5kKCJNYXRoIFNldHRpbmdzIiwgIlpvb20gVHJpZ2dlciIpLnN1Ym1lbnU7CiAgICAgICAgdHJpZ2dlci5pdGVtc1swXS5kaXNhYmxlZCA9IHRyaWdnZXIuaXRlbXNbMV0uZGlzYWJsZWQgPSB0cnVlOwoKICAgICAgICBpZiAoc2V0dGluZ3Muem9vbSA9PT0gIkhvdmVyIiB8fCBzZXR0aW5ncy56b29tID09ICJDbGljayIpIHsKICAgICAgICAgIHNldHRpbmdzLnpvb20gPSAiTm9uZSI7CiAgICAgICAgfQoKICAgICAgICB0cmlnZ2VyLml0ZW1zID0gdHJpZ2dlci5pdGVtcy5zbGljZSgwLCA0KTsKCiAgICAgICAgaWYgKG5hdmlnYXRvci5hcHBWZXJzaW9uLm1hdGNoKC9bIChdQW5kcm9pZFspIF0vKSkgewogICAgICAgICAgTUVOVS5JVEVNLlNVQk1FTlUuQXVnbWVudCh7CiAgICAgICAgICAgIG1hcmtlcjogIlx4QkIiCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0pKCk7CiAgICB9CgogICAgTUVOVS5DcmVhdGVMb2NhbGVNZW51KCk7CiAgICBNRU5VLkNyZWF0ZUFubm90YXRpb25NZW51KCk7CiAgfSk7CgogIE1FTlUuc2hvd1JlbmRlcmVyID0gZnVuY3Rpb24gKHNob3cpIHsKICAgIE1FTlUuY29va2llLnNob3dSZW5kZXJlciA9IENPTkZJRy5zaG93UmVuZGVyZXIgPSBzaG93OwogICAgTUVOVS5zYXZlQ29va2llKCk7CiAgICBNRU5VLm1lbnUuRmluZCgiTWF0aCBTZXR0aW5ncyIsICJNYXRoIFJlbmRlcmVyIikuaGlkZGVuID0gIXNob3c7CiAgfTsKCiAgTUVOVS5zaG93TWF0aFBsYXllciA9IGZ1bmN0aW9uIChzaG93KSB7CiAgICBNRU5VLmNvb2tpZS5zaG93TWF0aFBsYXllciA9IENPTkZJRy5zaG93TWF0aFBsYXllciA9IHNob3c7CiAgICBNRU5VLnNhdmVDb29raWUoKTsKICAgIE1FTlUubWVudS5GaW5kKCJNYXRoIFNldHRpbmdzIiwgIk1hdGhQbGF5ZXIiKS5oaWRkZW4gPSAhc2hvdzsKICB9OwoKICBNRU5VLnNob3dGb250TWVudSA9IGZ1bmN0aW9uIChzaG93KSB7CiAgICBNRU5VLmNvb2tpZS5zaG93Rm9udE1lbnUgPSBDT05GSUcuc2hvd0ZvbnRNZW51ID0gc2hvdzsKICAgIE1FTlUuc2F2ZUNvb2tpZSgpOwogICAgTUVOVS5tZW51LkZpbmQoIk1hdGggU2V0dGluZ3MiLCAiRm9udCBQcmVmZXJlbmNlIikuaGlkZGVuID0gIXNob3c7CiAgfTsKCiAgTUVOVS5zaG93Q29udGV4dCA9IGZ1bmN0aW9uIChzaG93KSB7CiAgICBNRU5VLmNvb2tpZS5zaG93Q29udGV4dCA9IENPTkZJRy5zaG93Q29udGV4dCA9IHNob3c7CiAgICBNRU5VLnNhdmVDb29raWUoKTsKICAgIE1FTlUubWVudS5GaW5kKCJNYXRoIFNldHRpbmdzIiwgIkNvbnRleHR1YWwgTWVudSIpLmhpZGRlbiA9ICFzaG93OwogIH07CgogIE1FTlUuc2hvd0Rpc2NvdmVyYWJsZSA9IGZ1bmN0aW9uIChzaG93KSB7CiAgICBNRU5VLmNvb2tpZS5zaG93RGlzY292ZXJhYmxlID0gQ09ORklHLnNob3dEaXNjb3ZlcmFibGUgPSBzaG93OwogICAgTUVOVS5zYXZlQ29va2llKCk7CiAgICBNRU5VLm1lbnUuRmluZCgiTWF0aCBTZXR0aW5ncyIsICJIaWdobGlnaHQgb24gSG92ZXIiKS5oaWRkZW4gPSAhc2hvdzsKICAgIE1FTlUubWVudS5GaW5kKCJNYXRoIFNldHRpbmdzIiwgImRpc2NvdmVyX3J1bGUiKS5oaWRkZW4gPSAhc2hvdzsKICB9OwoKICBNRU5VLnNob3dMb2NhbGUgPSBmdW5jdGlvbiAoc2hvdykgewogICAgTUVOVS5jb29raWUuc2hvd0xvY2FsZSA9IENPTkZJRy5zaG93TG9jYWxlID0gc2hvdzsKICAgIE1FTlUuc2F2ZUNvb2tpZSgpOwogICAgTUVOVS5tZW51LkZpbmQoIkxhbmd1YWdlIikuaGlkZGVuID0gIXNob3c7CiAgfTsKCiAgTWF0aEpheC5IdWIuUmVnaXN0ZXIuU3RhcnR1cEhvb2soIkhUTUwtQ1NTIEpheCBSZWFkeSIsIGZ1bmN0aW9uICgpIHsKICAgIGlmICghTWF0aEpheC5PdXRwdXRKYXhbIkhUTUwtQ1NTIl0uY29uZmlnLmltYWdlRm9udCkgewogICAgICBNRU5VLm1lbnUuRmluZCgiTWF0aCBTZXR0aW5ncyIsICJGb250IFByZWZlcmVuY2UiLCAiVGVYIChpbWFnZSkiKS5kaXNhYmxlZCA9IHRydWU7CiAgICB9CiAgfSk7CiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogIENBTExCQUNLLlF1ZXVlKEhVQi5SZWdpc3Rlci5TdGFydHVwSG9vaygiRW5kIENvbmZpZyIsIHt9KSwgLy8gd2FpdCB1bnRpbCBjb25maWcgaXMgY29tcGxldGUKICBbIlN0eWxlcyIsIEFKQVgsIENPTkZJRy5zdHlsZXNdLCBbIlBvc3QiLCBIVUIuU3RhcnR1cC5zaWduYWwsICJNYXRoTWVudSBSZWFkeSJdLCBbImxvYWRDb21wbGV0ZSIsIEFKQVgsICJbTWF0aEpheF0vZXh0ZW5zaW9ucy9NYXRoTWVudS5qcyJdKTsKfSkoTWF0aEpheC5IdWIsIE1hdGhKYXguSFRNTCwgTWF0aEpheC5BamF4LCBNYXRoSmF4LkNhbGxCYWNrLCBNYXRoSmF4Lk91dHB1dEpheCk7"},{"version":3,"sources":["/home/hads/Downloads/pycharm-community-2020.1/plugins/python-ce/helpers/MathJax/extensions/MathMenu.js"],"names":["HUB","HTML","AJAX","CALLBACK","OUTPUT","VERSION","SIGNAL","MathJax","Callback","Signal","Extension","MathMenu","version","signal","_","id","Localization","apply","concat","slice","call","arguments","isPC","Browser","isMSIE","isIE9","document","documentMode","ROUND","CONFIG","CombineConfig","delay","showRenderer","showMathPlayer","showFontMenu","showContext","showDiscoverable","showLocale","showLocaleURL","semanticsAnnotations","windowSettings","status","toolbar","locationbar","menubar","directories","personalbar","resizable","scrollbars","width","height","left","Math","round","screen","top","styles","position","border","padding","color","cursor","filter","outline","margin","font","background","right","display","FALSE","HOVER","KEY","Register","StartupHook","MathEvents","Event","False","Hover","NAV","Object","Subclass","Keydown","event","menu","keyCode","ESCAPE","Remove","RIGHT","Right","LEFT","Left","UP","Up","DOWN","Down","RETURN","SPACE","Space","Escape","MENU","Menu","items","posted","title","Init","def","With","Insert","Post","parent","forceLTR","window","div","getElementById","Background","ITEM","lastItem","lastMenu","skipUp","jax","isRTL","fontDirection","Element","onmouseup","Mouseup","ondblclick","ondragstart","onselectstart","oncontextmenu","menuItem","className","onkeydown","role","type","setCSS","i","m","length","Create","isMobile","addElement","ontouchstart","Close","ontouchend","onmousedown","appendChild","offsetWidth","style","x","pageX","y","pageY","clientX","body","scrollLeft","documentElement","clientY","scrollTop","node","CurrentNode","target","offsetX","pageXOffset","offsetY","pageYOffset","rect","getBoundingClientRect","bottom","max","floor","isContextMenu","side","mw","offsetLeft","offsetTop","parentNode","selection","empty","oldX","oldY","Focus","skipMouseoverFromKey","setTimeout","scrollTo","removeChild","msieFixedPositionBug","detachEvent","Resize","hover","nofade","UnHover","Unfocus","blur","Find","name","FindN","FindId","n","names","submenu","IndexOf","IndexOfN","IndexOfId","lastChild","Activate","firstChild","config","Mouseover","Mouseout","Mousedown","Touchstart","Touchend","force","skipMouseover","match","skipMousedown","item","BGSTYLE","bg","msieBackgroundBug","backgroundColor","attachEvent","SetWH","scrollWidth","scrollHeight","active","GetNode","inputID","isMathJax","AllNodes","jaxs","Hub","getAllJax","nodes","push","ActiveNode","FocusNode","focus","tabIndex","UnsetTabIndex","SetTabIndex","MoveHorizontal","move","shiftKey","len","next","Mod","getJaxFor","j","oldTabIndex","undefined","getTabOrder","a","Array","prototype","indexOf","A","start","saveCookie","Cookie","Set","cookie","getCookie","Get","Attributes","onselectend","hidden","label","Label","Name","Deactivate","DeactivateSubmenus","menus","childNodes","GetMenuNode","RemoveSubmenus","TouchEvent","nativeTouch","rtlClass","ENTRY","onmouseover","onmouseout","disabled","SUPER","MoveVertical","menuNode","allItems","it","index","children","rtl","parentNodes","previousSibling","replace","COMMAND","action","SUBMENU","marker","markerRTL","Timer","ClearTimer","timer","clearTimeout","forceout","result","ltr","submenuNodes","nextSibling","RADIO","variable","checked","settings","value","span","child","CHECKBOX","LABEL","RULE","About","GetFont","format","GetFormat","fileversion","GetJax","InputJax","OutputJax","ElementJax","about","fontSize","overflow","href","onclick","doc","H","innerHeight","clientHeight","msieAboutBug","offsetHeight","marginLeft","JAX","noTypeCheck","info","hasOwnProperty","isa","sort","outputJax","SVG","CommonHTML","imgFonts","webFonts","fontInUse","allowWebFonts","Help","Require","Dialog","ShowSource","EVENT","screenX","screenY","MML","mml","mbase","toMathML","Text","root","err","restart","After","loadingToMathML","Window","Queue","errorText","annotation","getAnnotation","data","toString","originalText","alert","w","DEF","open","join","text","write","close","table","outerHeight","W","outerWidth","innerWidth","min","msieHeightBug","resizeTo","X","e","moveTo","Scale","SCALE","scale","prompt","parseFloat","Zoom","MathZoom","Renderer","renderer","BROWSER","message","MESSAGE","Messages","warned","warnedMML","isChrome","substr","WebKit","isSafari","versionAtLeast","hasMathPlayer","MSIE","isEdge","warnedSVG","confirm","Opera","Safari","Firefox","AssistiveMML","AMML","assistiveMML","Font","HTMLCSS","location","reload","Locale","setLocale","locale","LoadLocale","url","STATUS","OK","MPEvents","discoverable","mpMouse","IE8warning","mpContext","IE9warning","Select","browser","quirks","compatMode","isIE8","Augment","noContextMenu","CreateLocaleMenu","locales","LOCALE","strings","menuTitle","CreateAnnotationMenu","annotations","menuSettings","isMac","trigger","zoom","navigator","appVersion","show","imageFont","Startup","Ajax","CallBack"],"mappings":"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","sourcesContent":["/* -*- Mode: Javascript; indent-tabs-mode:nil; js-indent-level: 2 -*- */\n/* vim: set ts=2 et sw=2 tw=80: */\n\n/*************************************************************\n *\n *  MathJax/extensions/MathMenu.js\n *\n *  Implements a right-mouse (or CTRL-click) menu over mathematics\n *  elements that gives the user the ability to copy the source,\n *  change the math size, and zoom settings.\n *\n *  ---------------------------------------------------------------------\n *\n *  Copyright (c) 2010-2015 The MathJax Consortium\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\n(function (HUB,HTML,AJAX,CALLBACK,OUTPUT) {\n  var VERSION = \"2.6.1\";\n\n  var SIGNAL = MathJax.Callback.Signal(\"menu\");  // signal for menu events\n\n  MathJax.Extension.MathMenu = {\n    version: VERSION,\n    signal: SIGNAL\n  };\n\n  var _ = function (id) {\n    return MathJax.Localization._.apply(\n      MathJax.Localization,\n      [[\"MathMenu\",id]].concat([].slice.call(arguments,1))\n    );\n  };\n\n  var isPC = HUB.Browser.isPC, isMSIE = HUB.Browser.isMSIE, isIE9 = ((document.documentMode||0) > 8);\n  var ROUND = (isPC ? null : \"5px\");\n\n  var CONFIG = HUB.CombineConfig(\"MathMenu\",{\n    delay: 150,                                    // the delay for submenus\n\n    showRenderer: true,                            //  show the \"Math Renderer\" menu?\n    showMathPlayer: true,                          //  show the \"MathPlayer\" menu?\n    showFontMenu: false,                           //  show the \"Font Preference\" menu?\n    showContext:  false,                           //  show the \"Context Menu\" menu?\n    showDiscoverable: false,                       //  show the \"Discoverable\" menu?\n    showLocale: true,                              //  show the \"Locale\" menu?\n    showLocaleURL: false,                          //  show the \"Load from URL\" menu?\n\n    semanticsAnnotations: {\n      \"TeX\": [\"TeX\", \"LaTeX\", \"application/x-tex\"],\n      \"StarMath\": [\"StarMath 5.0\"],\n      \"Maple\": [\"Maple\"],\n      \"ContentMathML\": [\"MathML-Content\", \"application/mathml-content+xml\"],\n      \"OpenMath\": [\"OpenMath\"]\n    },\n\n    windowSettings: {                              // for source window\n      status: \"no\", toolbar: \"no\", locationbar: \"no\", menubar: \"no\",\n      directories: \"no\", personalbar: \"no\", resizable: \"yes\", scrollbars: \"yes\",\n      width: 400, height: 300,\n      left: Math.round((screen.width - 400)/2),\n      top:  Math.round((screen.height - 300)/3)\n    },\n\n    styles: {\n      \"#MathJax_About\": {\n        position:\"fixed\", left:\"50%\", width:\"auto\", \"text-align\":\"center\",\n        border:\"3px outset\", padding:\"1em 2em\", \"background-color\":\"#DDDDDD\", color:\"black\",\n        cursor: \"default\", \"font-family\":\"message-box\", \"font-size\":\"120%\",\n        \"font-style\":\"normal\", \"text-indent\":0, \"text-transform\":\"none\",\n        \"line-height\":\"normal\", \"letter-spacing\":\"normal\", \"word-spacing\":\"normal\",\n        \"word-wrap\":\"normal\", \"white-space\":\"nowrap\", \"float\":\"none\", \"z-index\":201,\n\n        \"border-radius\": \"15px\",                     // Opera 10.5 and IE9\n        \"-webkit-border-radius\": \"15px\",             // Safari and Chrome\n        \"-moz-border-radius\": \"15px\",                // Firefox\n        \"-khtml-border-radius\": \"15px\",              // Konqueror\n\n        \"box-shadow\":\"0px 10px 20px #808080\",         // Opera 10.5 and IE9\n        \"-webkit-box-shadow\":\"0px 10px 20px #808080\", // Safari 3 and Chrome\n        \"-moz-box-shadow\":\"0px 10px 20px #808080\",    // Forefox 3.5\n        \"-khtml-box-shadow\":\"0px 10px 20px #808080\",  // Konqueror\n        filter: \"progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')\" // IE\n      },\n      \"#MathJax_About.MathJax_MousePost\": {\n        outline:\"none\"\n      },\n\n      \".MathJax_Menu\": {\n        position:\"absolute\", \"background-color\":\"white\", color:\"black\",\n        width:\"auto\", padding:(isPC ? \"2px\" : \"5px 0px\"),\n        border:\"1px solid #CCCCCC\", margin:0, cursor:\"default\",\n        font: \"menu\", \"text-align\":\"left\", \"text-indent\":0, \"text-transform\":\"none\",\n        \"line-height\":\"normal\", \"letter-spacing\":\"normal\", \"word-spacing\":\"normal\",\n        \"word-wrap\":\"normal\", \"white-space\":\"nowrap\", \"float\":\"none\", \"z-index\":201,\n\n        \"border-radius\": ROUND,                     // Opera 10.5 and IE9\n        \"-webkit-border-radius\": ROUND,             // Safari and Chrome\n        \"-moz-border-radius\": ROUND,                // Firefox\n        \"-khtml-border-radius\": ROUND,              // Konqueror\n\n        \"box-shadow\":\"0px 10px 20px #808080\",         // Opera 10.5 and IE9\n        \"-webkit-box-shadow\":\"0px 10px 20px #808080\", // Safari 3 and Chrome\n        \"-moz-box-shadow\":\"0px 10px 20px #808080\",    // Forefox 3.5\n        \"-khtml-box-shadow\":\"0px 10px 20px #808080\",  // Konqueror\n        filter: \"progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')\" // IE\n      },\n\n      \".MathJax_MenuItem\": {\n        padding: (isPC ? \"2px 2em\" : \"1px 2em\"),\n        background:\"transparent\"\n      },\n\n      \".MathJax_MenuArrow\": {\n        position:\"absolute\", right:\".5em\", \"padding-top\":\".25em\", color:\"#666666\",\n        \"font-family\": (isMSIE ? \"'Arial unicode MS'\" : null), \"font-size\": \".75em\"\n      },\n      \".MathJax_MenuActive .MathJax_MenuArrow\": {color:\"white\"},\n      \".MathJax_MenuArrow.RTL\": {left:\".5em\", right:\"auto\"},\n\n      \".MathJax_MenuCheck\": {\n        position:\"absolute\", left:\".7em\",\n        \"font-family\": (isMSIE ? \"'Arial unicode MS'\" : null)\n      },\n      \".MathJax_MenuCheck.RTL\": {right:\".7em\", left:\"auto\"},\n\n      \".MathJax_MenuRadioCheck\": {\n        position:\"absolute\", left: (isPC ? \"1em\" : \".7em\")\n      },\n      \".MathJax_MenuRadioCheck.RTL\": {\n        right: (isPC ? \"1em\" : \".7em\"), left:\"auto\"\n      },\n\n      \".MathJax_MenuLabel\": {\n        padding: (isPC ? \"2px 2em 4px 1.33em\" : \"1px 2em 3px 1.33em\"),\n        \"font-style\":\"italic\"\n      },\n\n      \".MathJax_MenuRule\": {\n        \"border-top\": (isPC ? \"1px solid #CCCCCC\" : \"1px solid #DDDDDD\"),\n        margin: (isPC ? \"4px 1px 0px\" : \"4px 3px\")\n      },\n\n      \".MathJax_MenuDisabled\": {\n        color:\"GrayText\"\n      },\n      \".MathJax_MenuActive\": {\n        \"background-color\": (isPC ? \"Highlight\" : \"#606872\"),\n        color: (isPC ? \"HighlightText\" : \"white\")\n      },\n\n      \".MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus\": {\n        \"background-color\": \"#E8E8E8\"\n      },\n      \".MathJax_ContextMenu:focus\": {\n        outline:\"none\"\n      },\n      \".MathJax_ContextMenu .MathJax_MenuItem:focus\": {\n        outline:\"none\"\n      },\n\n      \"#MathJax_AboutClose\": {\n        top:\".2em\", right:\".2em\"\n      },\n      \".MathJax_Menu .MathJax_MenuClose\": {\n        top:\"-10px\", left:\"-10px\"\n      },\n\n      \".MathJax_MenuClose\": {\n        position:\"absolute\",\n        cursor:\"pointer\",\n        display:\"inline-block\",\n        border:\"2px solid #AAA\",\n        \"border-radius\":\"18px\",\n        \"-webkit-border-radius\": \"18px\",             // Safari and Chrome\n        \"-moz-border-radius\": \"18px\",                // Firefox\n        \"-khtml-border-radius\": \"18px\",              // Konqueror\n        \"font-family\":\"'Courier New',Courier\",\n        \"font-size\":\"24px\",\n        color:\"#F0F0F0\"\n      },\n      \".MathJax_MenuClose span\": {\n        display:\"block\", \"background-color\":\"#AAA\", border:\"1.5px solid\",\n        \"border-radius\":\"18px\",\n        \"-webkit-border-radius\": \"18px\",             // Safari and Chrome\n        \"-moz-border-radius\": \"18px\",                // Firefox\n        \"-khtml-border-radius\": \"18px\",              // Konqueror\n        \"line-height\":0,\n        padding:\"8px 0 6px\"     // may need to be browser-specific\n      },\n      \".MathJax_MenuClose:hover\": {\n        color:\"white!important\",\n        border:\"2px solid #CCC!important\"\n      },\n      \".MathJax_MenuClose:hover span\": {\n        \"background-color\":\"#CCC!important\"\n      },\n      \".MathJax_MenuClose:hover:focus\": {\n        outline:\"none\"\n      }\n    }\n  });\n\n  var FALSE, HOVER, KEY;\n  HUB.Register.StartupHook(\"MathEvents Ready\",function () {\n    FALSE = MathJax.Extension.MathEvents.Event.False;\n    HOVER = MathJax.Extension.MathEvents.Hover;\n    KEY = MathJax.Extension.MathEvents.Event.KEY;\n  });\n\n\n  /*************************************************************/\n  /*\n   *  Abstract class of all keyboard navigatable objects.\n   */\n  var NAV = MathJax.Object.Subclass({\n    /*\n     * Moving in the list of items.\n     */\n    Keydown: function(event, menu) {\n      switch (event.keyCode) {\n      case KEY.ESCAPE:\n        this.Remove(event, menu);\n        break;\n      case KEY.RIGHT:\n        this.Right(event, menu);\n        break;\n      case KEY.LEFT:\n        this.Left(event, menu);\n        break;\n      case KEY.UP:\n        this.Up(event, menu);\n        break;\n      case KEY.DOWN:\n        this.Down(event, menu);\n        break;\n      case KEY.RETURN:\n      case KEY.SPACE:\n        this.Space(event, menu);\n        break;\n      default:\n        return;\n        break;\n      }\n      return FALSE(event);\n    },\n    Escape: function(event, menu) { },\n    Right: function(event, menu) { },\n    Left: function(event, menu) { },\n    Up: function(event, menu) { },\n    Down: function(event, menu) { },\n    Space: function(event, menu) { }\n  }, {});\n\n\n  /*************************************************************/\n  /*\n   *  The main menu class\n   */\n  var MENU = MathJax.Menu = NAV.Subclass({\n    version: VERSION,\n    items: [],\n    posted: false,\n    title: null,\n    margin: 5,\n\n    Init: function (def) {this.items = [].slice.call(arguments,0)},\n    With: function (def) {if (def) {HUB.Insert(this,def)}; return this},\n\n    /*\n     *  Display the menu\n     */\n    Post: function (event,parent,forceLTR) {\n      if (!event) {event = window.event||{}}\n      var div = document.getElementById(\"MathJax_MenuFrame\");\n      if (!div) {\n        div = MENU.Background(this);\n        delete ITEM.lastItem; delete ITEM.lastMenu;\n        delete MENU.skipUp;\n        SIGNAL.Post([\"post\",MENU.jax]);\n        MENU.isRTL = (MathJax.Localization.fontDirection() === \"rtl\");\n      }\n      var menu = HTML.Element(\"div\",{\n        onmouseup: MENU.Mouseup, ondblclick: FALSE,\n        ondragstart: FALSE, onselectstart: FALSE, oncontextmenu: FALSE,\n        menuItem: this, className: \"MathJax_Menu\", onkeydown: MENU.Keydown,\n        role: \"menu\"\n      });\n      if (event.type === \"contextmenu\" || event.type === \"mouseover\")\n        menu.className += \" MathJax_ContextMenu\";\n      if (!forceLTR) {MathJax.Localization.setCSS(menu)}\n\n      for (var i = 0, m = this.items.length; i < m; i++) {this.items[i].Create(menu)}\n      if (MENU.isMobile) {\n        HTML.addElement(menu,\"span\",{\n          className: \"MathJax_MenuClose\", menu: parent,\n          ontouchstart: MENU.Close, ontouchend: FALSE, onmousedown: MENU.Close, onmouseup: FALSE\n        },[[\"span\",{},\"\\u00D7\"]]);\n      }\n\n      div.appendChild(menu);\n      this.posted = true;\n      if (menu.offsetWidth) menu.style.width = (menu.offsetWidth+2) + \"px\";\n      var x = event.pageX, y = event.pageY;\n      if (!x && !y && \"clientX\" in event) {\n        x = event.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;\n        y = event.clientY + document.body.scrollTop  + document.documentElement.scrollTop;\n      }\n      if (!parent) {\n        var node = MENU.CurrentNode() || event.target;\n        if ((event.type === \"keydown\" || (!x && !y)) && node) {\n          var offsetX = window.pageXOffset || document.documentElement.scrollLeft;\n          var offsetY = window.pageYOffset || document.documentElement.scrollTop;\n          var rect = node.getBoundingClientRect();\n          x = (rect.right + rect.left) / 2 + offsetX;\n          y = (rect.bottom + rect.top) / 2 + offsetY;\n        }\n        if (x + menu.offsetWidth > document.body.offsetWidth - this.margin)\n           {x = document.body.offsetWidth - menu.offsetWidth - this.margin}\n        if (MENU.isMobile) {x = Math.max(5,x-Math.floor(menu.offsetWidth/2)); y -= 20}\n        MENU.skipUp = event.isContextMenu;\n      } else {\n        var side = \"left\", mw = parent.offsetWidth;\n        x = (MENU.isMobile ? 30 : mw - 2); y = 0;\n        while (parent && parent !== div) {\n          x += parent.offsetLeft; y += parent.offsetTop;\n          parent = parent.parentNode;\n        }\n        if (!MENU.isMobile) {\n          if ((MENU.isRTL && x - mw - menu.offsetWidth > this.margin) ||\n              (!MENU.isRTL && x + menu.offsetWidth > document.body.offsetWidth - this.margin))\n            {side = \"right\"; x = Math.max(this.margin,x - mw - menu.offsetWidth + 6)}\n        }\n        if (!isPC) {\n          // in case these ever get implemented\n          menu.style[\"borderRadiusTop\"+side] = 0;       // Opera 10.5\n          menu.style[\"WebkitBorderRadiusTop\"+side] = 0; // Safari and Chrome\n          menu.style[\"MozBorderRadiusTop\"+side] = 0;    // Firefox\n          menu.style[\"KhtmlBorderRadiusTop\"+side] = 0;  // Konqueror\n        }\n      }\n\n      menu.style.left = x+\"px\"; menu.style.top = y+\"px\";\n      if (document.selection && document.selection.empty) {document.selection.empty()}\n\n      // Focusing while keeping the scroll position.\n      var oldX = window.pageXOffset || document.documentElement.scrollLeft;\n      var oldY = window.pageYOffset || document.documentElement.scrollTop;\n      MENU.Focus(menu);\n      if (event.type === \"keydown\") {\n        MENU.skipMouseoverFromKey = true;\n        setTimeout(function() {delete MENU.skipMouseoverFromKey;}, CONFIG.delay);\n      }\n      window.scrollTo(oldX, oldY);\n      return FALSE(event);\n    },\n\n    /*\n     *  Remove the menu from the screen\n     */\n    Remove: function (event,menu) {\n      SIGNAL.Post([\"unpost\",MENU.jax]);\n      var div = document.getElementById(\"MathJax_MenuFrame\");\n      if (div) {\n        div.parentNode.removeChild(div);\n        if (this.msieFixedPositionBug) {detachEvent(\"onresize\",MENU.Resize)}\n      }\n      if (MENU.jax.hover) {\n        delete MENU.jax.hover.nofade;\n        HOVER.UnHover(MENU.jax);\n      }\n      MENU.Unfocus(menu);\n      if (event.type === \"mousedown\") MENU.CurrentNode().blur();\n      return FALSE(event);\n    },\n\n    /*\n     *  Find an item in a menu (or submenu) by name (Find) or ID (FindID).\n     *  A list of names or IDs means descend into submenus.\n     */\n    Find: function (name) {return this.FindN(1,name,[].slice.call(arguments,1))},\n    FindId: function (name) {return this.FindN(0,name,[].slice.call(arguments,1))},\n    FindN: function (n,name,names) {\n      for (var i = 0, m = this.items.length; i < m; i++) {\n        if (this.items[i].name[n] === name) {\n          if (names.length) {\n            if (!this.items[i].submenu) {return null}\n            return this.items[i].submenu.FindN(n,names[0],names.slice(1));\n          }\n          return this.items[i];\n        }\n      }\n      return null;\n    },\n\n    /*\n     *  Find the index of a menu item (so we can insert before or after it)\n     */\n    IndexOf: function (name) {return this.IndexOfN(1,name)},\n    IndexOfId: function (name) {return this.IndexOfN(0,name)},\n    IndexOfN: function (n,name) {\n      for (var i = 0, m = this.items.length; i < m; i++)\n        {if (this.items[i].name[n] === name) {return i}}\n      return null;\n    },\n\n    Right: function(event, menu) {\n      MENU.Right(event, menu);\n    },\n    Left: function(event, menu) {\n      MENU.Left(event, menu);\n    },\n    Up: function(event, menu) {\n      var node = menu.lastChild;\n      node.menuItem.Activate(event, node);\n    },\n    Down: function(event, menu) {\n      var node = menu.firstChild;\n      node.menuItem.Activate(event, node);\n    },\n    Space: function(event, menu) {\n      this.Remove(event, menu);\n    }\n  },{\n\n    config: CONFIG,\n\n    Remove:     function (event) {return MENU.Event(event,this,\"Remove\")},\n    Mouseover:  function (event) {return MENU.Event(event,this,\"Mouseover\")},\n    Mouseout:   function (event) {return MENU.Event(event,this,\"Mouseout\")},\n    Mousedown:  function (event) {return MENU.Event(event,this,\"Mousedown\")},\n    Mouseup:    function (event) {return MENU.Event(event,this,\"Mouseup\")},\n    Keydown:    function (event) {return MENU.Event(event,this,\"Keydown\")},\n    /*\n     *  Events for mobile devices.\n     */\n    Touchstart: function (event) {return MENU.Event(event,this,\"Touchstart\")},\n    Touchend:   function (event) {return MENU.Event(event,this,\"Touchend\")},\n    Close:      function (event) {\n      return MENU.Event(event,this.menu||this.parentNode,(this.menu?\"Touchend\":\"Remove\"));\n    },\n    Event: function (event,menu,type,force) {\n      if (MENU.skipMouseover && type === \"Mouseover\" && !force) {return FALSE(event)}\n      if (MENU.skipMouseoverFromKey && type === \"Mouseover\") {\n        delete MENU.skipMouseoverFromKey;\n        return FALSE(event);\n      }\n      if (MENU.skipUp) {\n        if (type.match(/Mouseup|Touchend/)) {delete MENU.skipUp; return FALSE(event)}\n        if (type === \"Touchstart\" ||\n           (type === \"Mousedown\" && !MENU.skipMousedown)) {delete MENU.skipUp}\n      }\n      if (!event) {event = window.event}\n      var item = menu.menuItem;\n      if (item && item[type]) {return item[type](event,menu)}\n      return null;\n    },\n    /*\n     *  Style for the background DIV\n     */\n    BGSTYLE: {\n      position:\"absolute\", left:0, top:0, \"z-index\":200,\n      width:\"100%\", height:\"100%\", border:0, padding:0, margin:0\n    },\n\n    Background: function (menu) {\n      var div = HTML.addElement(document.body,\"div\",\n                    {style:this.BGSTYLE, id:\"MathJax_MenuFrame\"},\n                    [[\"div\",{style: this.BGSTYLE, menuItem: menu, onmousedown: this.Remove}]]);\n      var bg = div.firstChild;\n      if (MENU.msieBackgroundBug) {\n        //  MSIE doesn't allow transparent background to be hit boxes, so\n        //  fake it using opacity with solid background color\n        bg.style.backgroundColor = \"white\"; bg.style.filter = \"alpha(opacity=0)\";\n      }\n      if (MENU.msieFixedPositionBug) {\n        //  MSIE can't do fixed position, so use a full-sized background\n        //  and an onresize handler to update it (stupid, but necessary)\n        div.width = div.height = 0; this.Resize();\n        attachEvent(\"onresize\",this.Resize);\n      } else {\n        // otherwise, use a fixed position DIV to cover the viewport\n        bg.style.position = \"fixed\";\n      }\n      return div;\n    },\n    Resize: function () {setTimeout(MENU.SetWH,0)},\n    SetWH: function () {\n      var bg = document.getElementById(\"MathJax_MenuFrame\");\n      if (bg) {\n        bg = bg.firstChild;\n        bg.style.width = bg.style.height = \"1px\"; // so scrollWidth/Height will be right below\n        bg.style.width = document.body.scrollWidth + \"px\";\n        bg.style.height = document.body.scrollHeight + \"px\";\n      }\n    },\n\n    /*************************************************************/\n    /*\n     *  Keyboard navigation of menu.\n     */\n    posted: false,  // Is a menu open?\n    active: null,   // The focused in HTML node in the menu.\n\n    GetNode: function(jax) {\n      var node = document.getElementById(jax.inputID + \"-Frame\");\n      return node.isMathJax ? node : node.firstChild;\n    },\n    CurrentNode: function() {\n      return MENU.GetNode(MENU.jax);\n    },\n    AllNodes: function() {\n      var jaxs = MathJax.Hub.getAllJax();\n      var nodes = [];\n      for (var i = 0, jax; jax = jaxs[i]; i++) {\n        nodes.push(MENU.GetNode(jax));\n      }\n      return nodes;\n    },\n    ActiveNode: function() {\n      return MENU.active;\n    },\n    FocusNode: function(node) {\n      MENU.active = node;\n      node.focus();\n    },\n    //\n    // Focus is a global affair, since we only ever want a single focused item.\n    //\n    Focus: function(menu) {\n      !MENU.posted ? MENU.Activate(menu) : MENU.ActiveNode().tabIndex = -1;\n      menu.tabIndex = 0;\n      MENU.FocusNode(menu);\n    },\n    Activate: function(event, menu) {\n      MENU.UnsetTabIndex();\n      MENU.posted = true;\n    },\n    Unfocus: function() {\n      MENU.ActiveNode().tabIndex = -1;\n      MENU.SetTabIndex();\n      MENU.FocusNode(MENU.CurrentNode());\n      MENU.posted = false;\n    },\n    MoveHorizontal: function(event, menu, move) {\n      if (!event.shiftKey) return;\n      var jaxs = MENU.AllNodes();\n      var len = jaxs.length;\n      if (len === 0) return;\n      var next = jaxs[MENU.Mod(move(MENU.IndexOf(jaxs, MENU.CurrentNode())), len)];\n      if (next === MENU.CurrentNode()) return;\n      MENU.menu.Remove(event, menu);\n      MENU.jax = MathJax.Hub.getJaxFor(next);\n      MENU.FocusNode(next);\n      MENU.menu.Post(null);\n    },\n    Right: function(event, menu) {\n      MENU.MoveHorizontal(event, menu, function(x) {return x + 1;});\n    },\n    Left: function(event, menu) {\n      MENU.MoveHorizontal(event, menu, function(x) {return x - 1;});\n    },\n    UnsetTabIndex: function () {\n      var jaxs = MENU.AllNodes();\n      for (var j = 0, jax; jax = jaxs[j]; j++) {\n        if (jax.tabIndex > 0) {\n          jax.oldTabIndex = jax.tabIndex;\n        }\n        jax.tabIndex = -1;\n      }\n    },\n    SetTabIndex: function () {\n      var jaxs = MENU.AllNodes();\n      for (var j = 0, jax; jax = jaxs[j]; j++) {\n        if (jax.oldTabIndex !== undefined) {\n          jax.tabIndex = jax.oldTabIndex\n          delete jax.oldTabIndex;\n        } else {\n          jax.tabIndex = HUB.getTabOrder(jax);\n        }\n      }\n    },\n\n    //TODO: Move to utility class.\n    // Computes a mod n.\n    Mod: function(a, n) {\n      return ((a % n) + n) % n;\n    },\n    IndexOf: (Array.prototype.indexOf ?\n              function (A, item, start) {return A.indexOf(item, start);} :\n              function (A, item, start) {\n                for (var i = (start || 0), j = A.length; i < j; i++) {\n                  if (item === A[i]) return i;\n                }\n                return -1;\n              }),\n\n    saveCookie: function () {HTML.Cookie.Set(\"menu\",this.cookie)},\n    getCookie: function () {this.cookie = HTML.Cookie.Get(\"menu\")}\n\n  });\n\n  MathJax.Menu.NAV = NAV;\n\n  /*************************************************************/\n  /*\n   *  Abstract class of menu items.\n   */\n  var ITEM = MENU.ITEM = NAV.Subclass({\n\n    name: \"\", // The menu item's label as [id,label] pair.\n    node: null,  // The HTML node of the item.\n    menu: null,  // The parent menu containing that item. HTML node.\n\n    Attributes: function(def) {\n      return HUB.Insert(\n        {onmouseup: MENU.Mouseup,\n         ondragstart: FALSE, onselectstart: FALSE, onselectend: FALSE,\n         ontouchstart: MENU.Touchstart, ontouchend: MENU.Touchend,\n         className: \"MathJax_MenuItem\", role: this.role,\n         menuItem: this},\n        def);\n    },\n\n    Create: function (menu) {\n      if (!this.hidden) {\n        var def = this.Attributes();\n        var label = this.Label(def,menu);\n        HTML.addElement(menu, \"div\", def, label);\n      }\n    },\n    Name: function () {return _(this.name[0],this.name[1])},\n\n    Mouseover: function (event,menu) {\n      if (menu.parentNode === MENU.ActiveNode().parentNode) {\n       this.Deactivate(MENU.ActiveNode());\n      }\n      this.Activate(event, menu);\n    },\n    Mouseout: function (event,menu) {\n      this.Deactivate(menu);\n    },\n    Mouseup: function (event,menu) {return this.Remove(event,menu)},\n\n\n    DeactivateSubmenus: function(menu) {\n      var menus = document.getElementById(\"MathJax_MenuFrame\").childNodes,\n          items = ITEM.GetMenuNode(menu).childNodes;\n      for (var i = 0, m = items.length; i < m; i++) {\n        var item = items[i].menuItem;\n        // Deactivates submenu items.\n        if (item && item.submenu && item.submenu.posted &&\n            item !== menu.menuItem) {\n          item.Deactivate(items[i]);\n        }\n      }\n      this.RemoveSubmenus(menu, menus);\n    },\n    RemoveSubmenus: function(menu, menus) {\n      menus = menus || document.getElementById(\"MathJax_MenuFrame\").childNodes;\n      var m = menus.length-1;\n      while (m >= 0 && ITEM.GetMenuNode(menu).menuItem !== menus[m].menuItem) {\n        menus[m].menuItem.posted = false;\n        menus[m].parentNode.removeChild(menus[m]);\n        m--;\n      }\n    },\n\n    Touchstart: function (event,menu) {return this.TouchEvent(event,menu,\"Mousedown\")},\n    Touchend: function (event,menu)   {return this.TouchEvent(event,menu,\"Mouseup\")},\n    TouchEvent: function (event,menu,type) {\n      if (this !== ITEM.lastItem) {\n        if (ITEM.lastMenu) {MENU.Event(event,ITEM.lastMenu,\"Mouseout\")}\n        MENU.Event(event,menu,\"Mouseover\",true);\n        ITEM.lastItem = this; ITEM.lastMenu = menu;\n      }\n      if (this.nativeTouch) {return null}\n      MENU.Event(event,menu,type);\n      return false;\n    },\n\n    Remove: function (event,menu) {\n      menu = menu.parentNode.menuItem;\n      return menu.Remove(event,menu);\n    },\n\n    With: function (def) {if (def) {HUB.Insert(this,def)}; return this},\n\n    isRTL: function () {return MENU.isRTL},\n    rtlClass: function () {return (this.isRTL() ? \" RTL\" : \"\")}\n  }, {\n    GetMenuNode: function(item) {\n      return item.parentNode;\n    }\n  });\n\n  /*************************************************************/\n  /*\n   *  Abstract class of menu items that are focusable and perform some action\n   */\n  MENU.ENTRY = MENU.ITEM.Subclass({\n    role: \"menuitem\",  // Aria role.\n\n    Attributes: function(def) {\n      def = HUB.Insert(\n        {onmouseover: MENU.Mouseover, onmouseout: MENU.Mouseout,\n         onmousedown: MENU.Mousedown, onkeydown: MENU.Keydown,\n         \"aria-disabled\": !!this.disabled},\n        def);\n      def = this.SUPER(arguments).Attributes.call(this, def);\n      if (this.disabled) {\n        def.className += \" MathJax_MenuDisabled\";\n      }\n      return def;\n    },\n    MoveVertical: function(event, item, move) {\n      var menuNode = ITEM.GetMenuNode(item);\n      var items = [];\n      for (var i = 0, allItems = menuNode.menuItem.items, it;\n           it = allItems[i]; i++) {\n        if (!it.hidden) {\n          items.push(it);\n        }\n      }\n      var index = MENU.IndexOf(items, this);\n      if (index === -1) return;\n      var len = items.length;\n      var children = menuNode.childNodes;\n      do {\n        index = MENU.Mod(move(index), len);\n      } while (items[index].hidden || !children[index].role ||\n               children[index].role === \"separator\");\n      this.Deactivate(item);\n      items[index].Activate(event, children[index]);\n    },\n    Up: function(event, item) {\n      this.MoveVertical(event, item, function(x) { return x - 1; });\n    },\n    Down: function(event, item) {\n      this.MoveVertical(event, item, function(x) { return x + 1; });\n    },\n    Right: function(event, item) {\n      this.MoveHorizontal(event, item, MENU.Right, !this.isRTL());\n    },\n    Left: function(event, item) {\n      this.MoveHorizontal(event, item, MENU.Left, this.isRTL());\n    },\n    MoveHorizontal: function(event, item, move, rtl) {\n      var menuNode = ITEM.GetMenuNode(item);\n      if (menuNode.menuItem === MENU.menu && event.shiftKey) {\n        move(event, item);\n      }\n      if (rtl) return;\n      if (menuNode.menuItem !== MENU.menu) {\n        this.Deactivate(item);\n      }\n      var parentNodes = menuNode.previousSibling.childNodes;\n      var length = parentNodes.length;\n      while (length--) {\n        var parent = parentNodes[length];\n        if (parent.menuItem.submenu &&\n            parent.menuItem.submenu === menuNode.menuItem) {\n          MENU.Focus(parent);\n          break;\n        }\n      }\n      this.RemoveSubmenus(item);\n    },\n    Space: function (event, menu) {\n      this.Mouseup(event, menu);\n    },\n\n    Activate: function (event, menu) {\n      this.Deactivate(menu);\n      if (!this.disabled) {\n        menu.className += \" MathJax_MenuActive\";\n      }\n      this.DeactivateSubmenus(menu);\n      MENU.Focus(menu);\n    },\n    Deactivate: function (menu) {\n      menu.className = menu.className.replace(/ MathJax_MenuActive/,\"\");\n    }\n\n  });\n\n  /*************************************************************/\n  /*\n   *  A menu item that performs a command when selected\n   */\n  MENU.ITEM.COMMAND = MENU.ENTRY.Subclass({\n    action: function () {},\n\n    Init: function (name,action,def) {\n      if (!(name instanceof Array)) {name = [name,name]}  // make [id,label] pair\n      this.name = name; this.action = action;\n      this.With(def);\n    },\n\n    Label: function (def,menu) {return [this.Name()]},\n    Mouseup: function (event,menu) {\n      if (!this.disabled) {\n        this.Remove(event,menu);\n        SIGNAL.Post([\"command\",this]);\n        this.action.call(this,event);\n      }\n      return FALSE(event);\n    }\n  });\n\n  /*************************************************************/\n  /*\n   *  A menu item that posts a submenu\n   */\n  MENU.ITEM.SUBMENU = MENU.ENTRY.Subclass({\n    submenu: null,        // the submenu\n    marker: \"\\u25BA\",  // the submenu arrow\n    markerRTL: \"\\u25C4\", // the submenu arrow for RTL\n\n    Attributes: function(def) {\n      def = HUB.Insert({\"aria-haspopup\": \"true\"}, def);\n      def = this.SUPER(arguments).Attributes.call(this, def);\n      return def;\n    },\n    Init: function (name,def) {\n      if (!(name instanceof Array)) {name = [name,name]}  // make [id,label] pair\n      this.name = name; var i = 1;\n      if (!(def instanceof MENU.ITEM)) {this.With(def), i++}\n      this.submenu = MENU.apply(MENU,[].slice.call(arguments,i));\n    },\n    Label: function (def,menu) {\n      this.submenu.posted = false;\n      return [this.Name()+\" \",[\"span\",{\n        className:\"MathJax_MenuArrow\" + this.rtlClass()\n      },[this.isRTL() ? this.markerRTL : this.marker]]];\n    },\n    Timer: function (event,menu) {\n      this.ClearTimer();\n      event = {type: event.type,\n               clientX: event.clientX, clientY: event.clientY}; // MSIE can't pass the event below\n      this.timer = setTimeout(CALLBACK([\"Mouseup\",this,event,menu]),CONFIG.delay);\n    },\n    ClearTimer: function() {\n      if (this.timer) {\n        clearTimeout(this.timer);\n      }\n    },\n    Touchend: function (event,menu) {\n      var forceout = this.submenu.posted;\n      var result = this.SUPER(arguments).Touchend.apply(this,arguments);\n      if (forceout) {this.Deactivate(menu); delete ITEM.lastItem; delete ITEM.lastMenu}\n      return result;\n    },\n    Mouseout: function(event, menu) {\n      if (!this.submenu.posted) {\n        this.Deactivate(menu);\n      }\n      this.ClearTimer();\n    },\n    Mouseover: function(event, menu) {\n      this.Activate(event, menu);\n    },\n    Mouseup: function (event,menu) {\n      if (!this.disabled) {\n        if (!this.submenu.posted) {\n          this.ClearTimer();\n          this.submenu.Post(event, menu, this.ltr);\n          MENU.Focus(menu);\n        } else {\n          this.DeactivateSubmenus(menu);\n        }\n      }\n      return FALSE(event);\n    },\n    Activate: function (event, menu) {\n      if (!this.disabled) {\n        this.Deactivate(menu);\n        menu.className += \" MathJax_MenuActive\";\n      }\n      if (!this.submenu.posted) {\n        this.DeactivateSubmenus(menu);\n        if (!MENU.isMobile) {\n          this.Timer(event,menu);\n        }\n      }\n      MENU.Focus(menu);\n    },\n    MoveVertical: function(event, item, move) {\n      this.ClearTimer();\n      this.SUPER(arguments).MoveVertical.apply(this, arguments);\n    },\n    MoveHorizontal: function(event, menu, move, rtl) {\n      if (!rtl) {\n        this.SUPER(arguments).MoveHorizontal.apply(this, arguments);\n        return;\n      }\n      if (this.disabled) return;\n      if (!this.submenu.posted) {\n        this.Activate(event, menu);\n        return;\n      }\n      var submenuNodes = ITEM.GetMenuNode(menu).nextSibling.childNodes;\n      if (submenuNodes.length > 0) {\n        this.submenu.items[0].Activate(event, submenuNodes[0]);\n      }\n    }\n  });\n\n  /*************************************************************/\n  /*\n   *  A menu item that is one of several radio buttons\n   */\n  MENU.ITEM.RADIO = MENU.ENTRY.Subclass({\n    variable: null,     // the variable name\n    marker: (isPC ? \"\\u25CF\" : \"\\u2713\"),   // the checkmark\n    role: \"menuitemradio\",\n\n    Attributes: function(def) {\n      var checked = CONFIG.settings[this.variable] === this.value ? \"true\" : \"false\";\n      def = HUB.Insert({\"aria-checked\": checked}, def);\n      def = this.SUPER(arguments).Attributes.call(this, def);\n      return def;\n    },\n    Init: function (name,variable,def) {\n      if (!(name instanceof Array)) {name = [name,name]}  // make [id,label] pair\n      this.name = name; this.variable = variable; this.With(def);\n      if (this.value == null) {this.value = this.name[0]}\n    },\n    Label: function (def,menu) {\n      var span = {className:\"MathJax_MenuRadioCheck\" + this.rtlClass()};\n      if (CONFIG.settings[this.variable] !== this.value) {\n        span = {style:{display:\"none\"}};\n      }\n      return [[\"span\",span,[this.marker]],\" \"+this.Name()];\n    },\n    Mouseup: function (event,menu) {\n      if (!this.disabled) {\n        var child = menu.parentNode.childNodes;\n        for (var i = 0, m = child.length; i < m; i++) {\n          var item = child[i].menuItem;\n          if (item && item.variable === this.variable) {\n            child[i].firstChild.style.display = \"none\";\n          }\n        }\n        menu.firstChild.display = \"\";\n        CONFIG.settings[this.variable] = this.value;\n        MENU.cookie[this.variable] = CONFIG.settings[this.variable]; MENU.saveCookie();\n        SIGNAL.Post([\"radio button\",this]);\n      }\n      this.Remove(event,menu);\n      if (this.action && !this.disabled) {this.action.call(MENU,this)}\n      return FALSE(event);\n    }\n  });\n\n  /*************************************************************/\n  /*\n   *  A menu item that is checkable\n   */\n  MENU.ITEM.CHECKBOX = MENU.ENTRY.Subclass({\n    variable: null,     // the variable name\n    marker: \"\\u2713\",   // the checkmark\n    role: \"menuitemcheckbox\",\n\n    Attributes: function(def) {\n      var checked = CONFIG.settings[this.variable] ? \"true\" : \"false\";\n      def = HUB.Insert({\"aria-checked\": checked}, def);\n      def = this.SUPER(arguments).Attributes.call(this, def);\n      return def;\n    },\n    Init: function (name,variable,def) {\n      if (!(name instanceof Array)) {name = [name,name]}  // make [id,label] pair\n      this.name = name; this.variable = variable; this.With(def);\n    },\n    Label: function (def,menu) {\n      var span = {className:\"MathJax_MenuCheck\" + this.rtlClass()};\n      if (!CONFIG.settings[this.variable]) {span = {style:{display:\"none\"}}}\n      return [[\"span\",span,[this.marker]],\" \"+this.Name()];\n    },\n    Mouseup: function (event,menu) {\n      if (!this.disabled) {\n        menu.firstChild.display = (CONFIG.settings[this.variable] ? \"none\" : \"\");\n        CONFIG.settings[this.variable] = !CONFIG.settings[this.variable];\n        MENU.cookie[this.variable] = CONFIG.settings[this.variable]; MENU.saveCookie();\n        SIGNAL.Post([\"checkbox\",this]);\n      }\n      this.Remove(event,menu);\n      if (this.action && !this.disabled) {this.action.call(MENU,this)}\n      return FALSE(event);\n    }\n  });\n\n  /*************************************************************/\n  /*\n   *  A menu item that is a label\n   */\n  MENU.ITEM.LABEL = MENU.ENTRY.Subclass({\n    role: \"menuitem\",  // Aria role.\n\n    Init: function (name,def) {\n      if (!(name instanceof Array)) {name = [name,name]}  // make [id,label] pair\n      this.name = name; this.With(def);\n    },\n    Label: function (def,menu) {\n      def.className += \" MathJax_MenuLabel\";\n      return [this.Name()];\n    },\n    Activate: function(event, menu) {\n      this.Deactivate(menu);\n      MENU.Focus(menu);\n    },\n    Mouseup: function (event,menu) { }\n  });\n\n  /*************************************************************/\n  /*\n   *  A rule in a menu\n   */\n  MENU.ITEM.RULE = MENU.ITEM.Subclass({\n    role: \"separator\",\n\n    Attributes: function(def) {\n      def = HUB.Insert({\"aria-orientation\": \"vertical\"}, def);\n      def = this.SUPER(arguments).Attributes.call(this, def);\n      return def;\n    },\n    Label: function (def,menu) {\n      def.className += \" MathJax_MenuRule\";\n      return null;\n    }\n  });\n\n  /*************************************************************/\n  /*************************************************************/\n\n  /*\n   *  Handle the ABOUT box\n   */\n  MENU.About = function (event) {\n    var font = MENU.About.GetFont();\n    var format = MENU.About.GetFormat();\n    var jax = [\"MathJax.js v\"+MathJax.fileversion,[\"br\"]];\n    jax.push([\"div\",{style:{\"border-top\":\"groove 2px\",margin:\".25em 0\"}}]);\n    MENU.About.GetJax(jax,MathJax.InputJax,[\"InputJax\",\"%1 Input Jax v%2\"]);\n    MENU.About.GetJax(jax,MathJax.OutputJax,[\"OutputJax\",\"%1 Output Jax v%2\"]);\n    MENU.About.GetJax(jax,MathJax.ElementJax,[\"ElementJax\",\"%1 Element Jax v%2\"]);\n    jax.push([\"div\",{style:{\"border-top\":\"groove 2px\",margin:\".25em 0\"}}]);\n    MENU.About.GetJax(jax,MathJax.Extension,[\"Extension\",\"%1 Extension v%2\"],true);\n    jax.push([\"div\",{style:{\"border-top\":\"groove 2px\",margin:\".25em 0\"}}],[\"center\",{},[\n      HUB.Browser + \" v\"+HUB.Browser.version + (format ?\n        \" \\u2014 \" + _(format.replace(/ /g,\"\"),format) : \"\")\n    ]]);\n    MENU.About.div = MENU.Background(MENU.About);\n    var about = HTML.addElement(MENU.About.div,\"div\",{\n      id: \"MathJax_About\", tabIndex: 0, onkeydown: MENU.About.Keydown\n    },[\n      [\"b\",{style:{fontSize:\"120%\"}},[\"MathJax\"]],\" v\"+MathJax.version,[\"br\"],\n      _(font.replace(/ /g,\"\"),\"using \"+font),[\"br\"],[\"br\"],\n      [\"span\",{style:{\n        display:\"inline-block\", \"text-align\":\"left\", \"font-size\":\"80%\",\n        \"max-height\":\"20em\", overflow:\"auto\",\n        \"background-color\":\"#E4E4E4\", padding:\".4em .6em\", border:\"1px inset\"\n      }, tabIndex: 0},jax],[\"br\"],[\"br\"],\n      [\"a\",{href:\"http://www.mathjax.org/\"},[\"www.mathjax.org\"]],\n      [\"span\",{className:\"MathJax_MenuClose\",id:\"MathJax_AboutClose\",\n               onclick:MENU.About.Remove,\n               onkeydown: MENU.About.Keydown, tabIndex: 0, role: \"button\",\n               \"aria-label\": _(\"CloseAboutDialog\",\"Close about MathJax dialog\")},\n        [[\"span\",{},\"\\u00D7\"]]]\n    ]);\n    if (event.type === \"mouseup\") about.className += \" MathJax_MousePost\";\n    about.focus();\n    MathJax.Localization.setCSS(about);\n    var doc = (document.documentElement||{});\n    var H = window.innerHeight || doc.clientHeight || doc.scrollHeight || 0;\n    if (MENU.prototype.msieAboutBug) {\n      about.style.width = \"20em\"; about.style.position = \"absolute\";\n      about.style.left = Math.floor((document.documentElement.scrollWidth - about.offsetWidth)/2)+\"px\";\n      about.style.top = (Math.floor((H-about.offsetHeight)/3)+document.body.scrollTop)+\"px\";\n    } else {\n      about.style.marginLeft = Math.floor(-about.offsetWidth/2)+\"px\";\n      about.style.top = Math.floor((H-about.offsetHeight)/3)+\"px\";\n    }\n  };\n  MENU.About.Remove = function (event) {\n    if (MENU.About.div) {document.body.removeChild(MENU.About.div); delete MENU.About.div}\n  };\n  MENU.About.Keydown = function(event) {\n    if (event.keyCode === KEY.ESCAPE ||\n        (this.id === \"MathJax_AboutClose\" &&\n         (event.keyCode === KEY.SPACE || event.keyCode === KEY.RETURN))) {\n      MENU.About.Remove(event);\n      MENU.CurrentNode().focus();\n      FALSE(event);\n    }\n  },\n  MENU.About.GetJax = function (jax,JAX,type,noTypeCheck) {\n    var info = [];\n    for (var id in JAX) {if (JAX.hasOwnProperty(id) && JAX[id]) {\n      if ((noTypeCheck && JAX[id].version) || (JAX[id].isa && JAX[id].isa(JAX)))\n        {info.push(_(type[0],type[1],(JAX[id].id||id),JAX[id].version))}\n    }}\n    info.sort();\n    for (var i = 0, m = info.length; i < m; i++) {jax.push(info[i],[\"br\"])}\n    return jax;\n  };\n  MENU.About.GetFont = function () {\n    var jax = MathJax.Hub.outputJax[\"jax/mml\"][0] || {};\n    var font = {\n      SVG: \"web SVG\",\n      CommonHTML: \"web TeX\",\n      \"HTML-CSS\": (jax.imgFonts ? \"image\" : (jax.webFonts ? \"web\" : \"local\")+\" \"+jax.fontInUse)\n    }[jax.id] || \"generic\";\n    return font + \" fonts\";\n  };\n  MENU.About.GetFormat = function () {\n    var jax = MathJax.Hub.outputJax[\"jax/mml\"][0] || {};\n    if (jax.id !== \"HTML-CSS\"|| !jax.webFonts || jax.imgFonts) return;\n    return jax.allowWebFonts.replace(/otf/,\"woff or otf\") + \" fonts\";\n  };\n\n\n  /*\n   *  Handle the MathJax HELP menu\n   */\n  MENU.Help = function (event) {\n    AJAX.Require(\"[MathJax]/extensions/HelpDialog.js\",\n                 function () {MathJax.Extension.Help.Dialog({type:event.type})});\n  };\n\n  /*\n   *  Handle showing of element's source\n   */\n  MENU.ShowSource = function (event) {\n    if (!event) {event = window.event}\n    var EVENT = {screenX:event.screenX, screenY:event.screenY};\n    if (!MENU.jax) return;\n    if (this.format === \"MathML\") {\n      var MML = MathJax.ElementJax.mml;\n      if (MML && typeof(MML.mbase.prototype.toMathML) !== \"undefined\") {\n        // toMathML() can call MathJax.Hub.RestartAfter, so trap errors and check\n        try {MENU.ShowSource.Text(MENU.jax.root.toMathML(\"\",MENU.jax),event)} catch (err) {\n          if (!err.restart) {throw err}\n          CALLBACK.After([this,MENU.ShowSource,EVENT],err.restart);\n        }\n      } else if (!AJAX.loadingToMathML) {\n        AJAX.loadingToMathML = true;\n        MENU.ShowSource.Window(event); // WeBKit needs to open window on click event\n        CALLBACK.Queue(\n          AJAX.Require(\"[MathJax]/extensions/toMathML.js\"),\n          function () {\n            delete AJAX.loadingToMathML;\n            if (!MML.mbase.prototype.toMathML) {MML.mbase.prototype.toMathML = function () {}}\n          },\n          [this,MENU.ShowSource,EVENT]  // call this function again\n        );\n        return;\n      }\n    } else if (this.format === \"Error\") {\n      MENU.ShowSource.Text(MENU.jax.errorText,event);\n    } else if (CONFIG.semanticsAnnotations[this.format]) {\n      var annotation = MENU.jax.root.getAnnotation(this.format);\n      if (annotation.data[0]) MENU.ShowSource.Text(annotation.data[0].toString());\n    } else {\n      if (MENU.jax.originalText == null) {\n        alert(_(\"NoOriginalForm\",\"No original form available\"));\n        return;\n      }\n      MENU.ShowSource.Text(MENU.jax.originalText,event);\n    }\n  };\n  MENU.ShowSource.Window = function (event) {\n    if (!MENU.ShowSource.w) {\n      var def = [], DEF = CONFIG.windowSettings;\n      for (var id in DEF) {if (DEF.hasOwnProperty(id)) {def.push(id+\"=\"+DEF[id])}}\n      MENU.ShowSource.w = window.open(\"\",\"_blank\",def.join(\",\"));\n    }\n    return MENU.ShowSource.w;\n  };\n  MENU.ShowSource.Text = function (text,event) {\n    var w = MENU.ShowSource.Window(event); delete MENU.ShowSource.w;\n    text = text.replace(/^\\s*/,\"\").replace(/\\s*$/,\"\");\n    text = text.replace(/&/g,\"&amp;\").replace(/</g,\"&lt;\").replace(/>/g,\"&gt;\");\n    var title = _(\"EqSource\",\"MathJax Equation Source\");\n    if (MENU.isMobile) {\n      w.document.open();\n      w.document.write(\"<html><head><meta name='viewport' content='width=device-width, initial-scale=1.0' /><title>\"+title+\"</title></head><body style='font-size:85%'>\");\n      w.document.write(\"<pre>\"+text+\"</pre>\");\n      w.document.write(\"<hr><input type='button' value='\"+_(\"Close\",\"Close\")+\"' onclick='window.close()' />\");\n      w.document.write(\"</body></html>\");\n      w.document.close();\n    } else {\n      w.document.open();\n      w.document.write(\"<html><head><title>\"+title+\"</title></head><body style='font-size:85%'>\");\n      w.document.write(\"<table><tr><td><pre>\"+text+\"</pre></td></tr></table>\");\n      w.document.write(\"</body></html>\");\n      w.document.close();\n      var table = w.document.body.firstChild;\n      setTimeout(function () {\n        var H = (w.outerHeight-w.innerHeight)||30, W = (w.outerWidth-w.innerWidth)||30, x, y;\n        W = Math.max(140,Math.min(Math.floor(.5*screen.width),table.offsetWidth+W+25));\n        H = Math.max(40,Math.min(Math.floor(.5*screen.height),table.offsetHeight+H+25));\n        if (MENU.prototype.msieHeightBug) {H += 35}; // for title bar in XP\n        w.resizeTo(W,H);\n        var X; try {X = event.screenX} catch (e) {}; // IE8 throws an error accessing screenX\n        if (event && X != null) {\n          x = Math.max(0,Math.min(event.screenX-Math.floor(W/2), screen.width-W-20));\n          y = Math.max(0,Math.min(event.screenY-Math.floor(H/2), screen.height-H-20));\n          w.moveTo(x,y);\n        }\n      },50);\n    }\n  };\n\n  /*\n   *  Handle rescaling all the math\n   */\n  MENU.Scale = function () {\n    var JAX = [\"CommonHTML\",\"HTML-CSS\",\"SVG\",\"NativeMML\",\"PreviewHTML\"], m = JAX.length,\n        SCALE = 100, i, jax;\n    for (i = 0; i < m; i++) {\n      jax = OUTPUT[JAX[i]];\n      if (jax) {SCALE = jax.config.scale; break}\n    }\n    var scale = prompt(_(\"ScaleMath\",\"Scale all mathematics (compared to surrounding text) by\"),SCALE+\"%\");\n    if (scale) {\n      if (scale.match(/^\\s*\\d+(\\.\\d*)?\\s*%?\\s*$/)) {\n        scale = parseFloat(scale);\n        if (scale) {\n          if (scale !== SCALE) {\n            for (i = 0; i < m; i++) {\n              jax = OUTPUT[JAX[i]];\n              if (jax) jax.config.scale = scale;\n            }\n            MENU.cookie.scale = HUB.config.scale = scale;\n            MENU.saveCookie(); \n            HUB.Queue([\"Rerender\",HUB]);\n          }\n        } else {alert(_(\"NonZeroScale\",\"The scale should not be zero\"))}\n      } else {alert(_(\"PercentScale\",\n                      \"The scale should be a percentage (e.g., 120%%)\"))}\n    }\n  };\n\n  /*\n   *  Handle loading the zoom code\n   */\n  MENU.Zoom = function () {\n    if (!MathJax.Extension.MathZoom) {AJAX.Require(\"[MathJax]/extensions/MathZoom.js\")}\n  };\n\n  /*\n   *  Handle changing the renderer\n   */\n  MENU.Renderer = function () {\n    var jax = HUB.outputJax[\"jax/mml\"];\n    if (jax[0] !== CONFIG.settings.renderer) {\n      var BROWSER = HUB.Browser, message, MESSAGE = MENU.Renderer.Messages, warned;\n      //\n      //  Check that the new renderer is appropriate for the browser\n      //\n      switch (CONFIG.settings.renderer) {\n        case \"NativeMML\":\n          if (!CONFIG.settings.warnedMML) {\n            if (BROWSER.isChrome && BROWSER.version.substr(0,3) !== \"24.\") {message = MESSAGE.MML.WebKit}\n            else if (BROWSER.isSafari && !BROWSER.versionAtLeast(\"5.0\")) {message = MESSAGE.MML.WebKit}\n            else if (BROWSER.isMSIE) {if (!BROWSER.hasMathPlayer) {message = MESSAGE.MML.MSIE}}\n            else if (BROWSER.isEdge) {message = MESSAGE.MML.WebKit}\n            else {message = MESSAGE.MML[BROWSER]}\n            warned = \"warnedMML\";\n          }\n          break;\n\n        case \"SVG\":\n          if (!CONFIG.settings.warnedSVG) {\n            if (BROWSER.isMSIE && !isIE9) {message = MESSAGE.SVG.MSIE}\n          }\n          break;\n      }\n      if (message) {\n        message = _(message[0],message[1]);\n        message += \"\\n\\n\";\n        message += _(\"SwitchAnyway\",\n                     \"Switch the renderer anyway?\\n\\n\" +\n                     \"(Press OK to switch, CANCEL to continue with the current renderer)\");\n        MENU.cookie.renderer = jax[0].id; MENU.saveCookie();\n        if (!confirm(message)) {\n          MENU.cookie.renderer = CONFIG.settings.renderer = HTML.Cookie.Get(\"menu\").renderer;\n          MENU.saveCookie();\n          return;\n        }\n        if (warned) {MENU.cookie.warned  = CONFIG.settings.warned = true}\n        MENU.cookie.renderer = CONFIG.settings.renderer; MENU.saveCookie();\n      }\n      HUB.Queue(\n        [\"setRenderer\",HUB,CONFIG.settings.renderer,\"jax/mml\"],\n        [\"Rerender\",HUB]\n      );\n    }\n  };\n  MENU.Renderer.Messages = {\n    MML: {\n      WebKit:  [\"WebkitNativeMMLWarning\",\n                 \"Your browser doesn't seem to support MathML natively, \" +\n                 \"so switching to MathML output may cause the mathematics \" +\n                 \"on the page to become unreadable.\"],\n\n      MSIE:    [\"MSIENativeMMLWarning\",\n                 \"Internet Explorer requires the MathPlayer plugin \" +\n                 \"in order to process MathML output.\"],\n\n      Opera:   [\"OperaNativeMMLWarning\",\n                 \"Opera's support for MathML is limited, so switching to \" +\n                 \"MathML output may cause some expressions to render poorly.\"],\n\n      Safari:  [\"SafariNativeMMLWarning\",\n                 \"Your browser's native MathML does not implement all the features \" +\n                 \"used by MathJax, so some expressions may not render properly.\"],\n\n      Firefox: [\"FirefoxNativeMMLWarning\",\n                 \"Your browser's native MathML does not implement all the features \" +\n                 \"used by MathJax, so some expressions may not render properly.\"]\n    },\n\n    SVG: {\n      MSIE:    [\"MSIESVGWarning\",\n                 \"SVG is not implemented in Internet Explorer prior to \" +\n                 \"IE9 or when it is emulating IE8 or below. \" +\n                 \"Switching to SVG output will cause the mathematics to \" +\n                 \"not display properly.\"]\n    }\n  };\n  \n  /*\n   *  Toggle assistive MML settings\n   */\n  MENU.AssistiveMML = function (item,restart) {\n    var AMML = MathJax.Extension.AssistiveMML;\n    if (!AMML) {\n      //  Try to load the extension, but only try once.\n      if (!restart)\n        AJAX.Require(\"[MathJax]/extensions/AssistiveMML.js\",[\"AssistiveMML\",MENU,item,true]);\n      return;\n    }\n    MathJax.Hub.Queue([(CONFIG.settings.assistiveMML ? \"Add\" : \"Remove\")+\"AssistiveMathML\",AMML]);\n  };\n\n  /*\n   *  Handle setting the HTMLCSS fonts\n   */\n  MENU.Font = function () {\n    var HTMLCSS = OUTPUT[\"HTML-CSS\"]; if (!HTMLCSS) return;\n    document.location.reload();\n  };\n\n  /*\n   *  Handle selection of locale and rerender the page\n   */\n  MENU.Locale = function () {\n    MathJax.Localization.setLocale(CONFIG.settings.locale);\n    MathJax.Hub.Queue([\"Reprocess\",MathJax.Hub]); // FIXME: Just reprocess error messages?\n  };\n  MENU.LoadLocale = function () {\n    var url = prompt(_(\"LoadURL\",\"Load translation data from this URL:\"));\n    if (url) {\n      if (!url.match(/\\.js$/)) {\n        alert(_(\"BadURL\",\n          \"The URL should be for a javascript file that defines MathJax translation data.  \" +\n          \"Javascript file names should end with '.js'\"\n        ));\n      }\n      AJAX.Require(url,function (status) {\n        if (status != AJAX.STATUS.OK) {alert(_(\"BadData\",\"Failed to load translation data from %1\",url))}\n      });\n    }\n  };\n\n  /*\n   *  Handle setting MathPlayer events\n   */\n  MENU.MPEvents = function (item) {\n    var discoverable = CONFIG.settings.discoverable,\n        MESSAGE = MENU.MPEvents.Messages;\n    if (!isIE9) {\n      if (CONFIG.settings.mpMouse && !confirm(_.apply(_,MESSAGE.IE8warning))) {\n        delete MENU.cookie.mpContext; delete CONFIG.settings.mpContext;\n        delete MENU.cookie.mpMouse; delete CONFIG.settings.mpMouse;\n        MENU.saveCookie();\n        return;\n      }\n      CONFIG.settings.mpContext = CONFIG.settings.mpMouse;\n      MENU.cookie.mpContext = MENU.cookie.mpMouse = CONFIG.settings.mpMouse;\n      MENU.saveCookie();\n      MathJax.Hub.Queue([\"Rerender\",MathJax.Hub])\n    } else if (!discoverable && item.name[1] === \"Menu Events\" && CONFIG.settings.mpContext) {\n      alert(_.apply(_,MESSAGE.IE9warning));\n    }\n  };\n\n  MENU.MPEvents.Messages = {\n    IE8warning: [\"IE8warning\",\n      \"This will disable the MathJax menu and zoom features, \" +\n      \"but you can Alt-Click on an expression to obtain the MathJax \" +\n      \"menu instead.\\n\\nReally change the MathPlayer settings?\"],\n\n    IE9warning: [\"IE9warning\",\n      \"The MathJax contextual menu will be disabled, but you can \" +\n      \"Alt-Click on an expression to obtain the MathJax menu instead.\"]\n  };\n\n  /*************************************************************/\n  /*************************************************************/\n\n  HUB.Browser.Select({\n    MSIE: function (browser) {\n      var quirks = (document.compatMode === \"BackCompat\");\n      var isIE8 = browser.versionAtLeast(\"8.0\") && document.documentMode > 7;\n      MENU.Augment({\n        margin: 20,\n        msieBackgroundBug: ((document.documentMode||0) < 9),\n        msieFixedPositionBug: (quirks || !isIE8),\n        msieAboutBug: quirks,\n        msieHeightBug: ((document.documentMode||0) < 9)\n           // height of window doesn't include title bar in XP\n      });\n      if (isIE9) {\n        delete CONFIG.styles[\"#MathJax_About\"].filter;\n        delete CONFIG.styles[\".MathJax_Menu\"].filter;\n      }\n    },\n    Firefox: function (browser) {\n      MENU.skipMouseover = browser.isMobile && browser.versionAtLeast(\"6.0\");\n      MENU.skipMousedown = browser.isMobile;\n    }\n  });\n  MENU.isMobile      = HUB.Browser.isMobile;\n  MENU.noContextMenu = HUB.Browser.noContextMenu;\n\n  /*************************************************************/\n\n  //\n  //  Creates the locale menu from the list of locales in MathJax.Localization.strings\n  //\n  MENU.CreateLocaleMenu = function () {\n    if (!MENU.menu) return;\n    var menu = MENU.menu.Find(\"Language\").submenu, items = menu.items;\n    //\n    //  Get the names of the languages and sort them\n    //\n    var locales = [], LOCALE = MathJax.Localization.strings;\n    for (var id in LOCALE) {if (LOCALE.hasOwnProperty(id)) {locales.push(id)}}\n    locales = locales.sort(); menu.items = [];\n    //\n    //  Add a menu item for each\n    //\n    for (var i = 0, m = locales.length; i < m; i++) {\n      var title = LOCALE[locales[i]].menuTitle;\n      if (title) {title += \" (\"+locales[i]+\")\"} else {title = locales[i]}\n      menu.items.push(ITEM.RADIO([locales[i],title],\"locale\",{action:MENU.Locale}));\n    }\n    //\n    //  Add the rule and \"Load from URL\" items\n    //\n    menu.items.push(items[items.length-2],items[items.length-1]);\n  };\n\n  //\n  // Create the annotation menu from MathJax.Hub.config.semanticsAnnotations\n  //\n  MENU.CreateAnnotationMenu = function () {\n    if (!MENU.menu) return;\n    var menu = MENU.menu.Find(\"Show Math As\",\"Annotation\").submenu;\n    var annotations = CONFIG.semanticsAnnotations;\n    for (var a in annotations) {\n      if (annotations.hasOwnProperty(a)) {\n        menu.items.push(ITEM.COMMAND([a,a], MENU.ShowSource, {hidden: true, nativeTouch: true, format: a}));\n      }\n    }\n  };\n\n  /*************************************************************/\n\n  HUB.Register.StartupHook(\"End Config\",function () {\n\n    /*\n     *  Get the menu settings from the HUB (which includes the\n     *  data from the cookie already), and add the format, if\n     *  it wasn't set in the cookie.\n     */\n    CONFIG.settings = HUB.config.menuSettings;\n    if (typeof(CONFIG.settings.showRenderer) !== \"undefined\") {CONFIG.showRenderer = CONFIG.settings.showRenderer}\n    if (typeof(CONFIG.settings.showFontMenu) !== \"undefined\") {CONFIG.showFontMenu = CONFIG.settings.showFontMenu}\n    if (typeof(CONFIG.settings.showContext)  !== \"undefined\") {CONFIG.showContext  = CONFIG.settings.showContext}\n    MENU.getCookie();\n\n    /*\n     *  The main menu\n     */\n    // Localization: items used as key, should be refactored.\n    MENU.menu = MENU(\n      ITEM.SUBMENU([\"Show\",\"Show Math As\"],\n        ITEM.COMMAND([\"MathMLcode\",\"MathML Code\"],  MENU.ShowSource, {nativeTouch: true, format: \"MathML\"}),\n        ITEM.COMMAND([\"Original\",\"Original Form\"],  MENU.ShowSource, {nativeTouch: true}),\n        ITEM.SUBMENU([\"Annotation\",\"Annotation\"], {disabled:true}),\n        ITEM.RULE(),\n        ITEM.CHECKBOX([\"texHints\",\"Show TeX hints in MathML\"], \"texHints\"),\n        ITEM.CHECKBOX([\"semantics\",\"Add original form as annotation\"], \"semantics\")\n      ),\n      ITEM.RULE(),\n      ITEM.SUBMENU([\"Settings\",\"Math Settings\"],\n        ITEM.SUBMENU([\"ZoomTrigger\",\"Zoom Trigger\"],\n          ITEM.RADIO([\"Hover\",\"Hover\"],               \"zoom\", {action: MENU.Zoom}),\n          ITEM.RADIO([\"Click\",\"Click\"],               \"zoom\", {action: MENU.Zoom}),\n          ITEM.RADIO([\"DoubleClick\",\"Double-Click\"],  \"zoom\", {action: MENU.Zoom}),\n          ITEM.RADIO([\"NoZoom\",\"No Zoom\"],            \"zoom\", {value: \"None\"}),\n          ITEM.RULE(),\n          ITEM.LABEL([\"TriggerRequires\",\"Trigger Requires:\"]),\n          ITEM.CHECKBOX((HUB.Browser.isMac ? [\"Option\",\"Option\"] : [\"Alt\",\"Alt\"]), \"ALT\"),\n          ITEM.CHECKBOX([\"Command\",\"Command\"],    \"CMD\",  {hidden: !HUB.Browser.isMac}),\n          ITEM.CHECKBOX([\"Control\",\"Control\"],    \"CTRL\", {hidden:  HUB.Browser.isMac}),\n          ITEM.CHECKBOX([\"Shift\",\"Shift\"],        \"Shift\")\n        ),\n        ITEM.SUBMENU([\"ZoomFactor\",\"Zoom Factor\"],\n          ITEM.RADIO(\"125%\", \"zscale\"),\n          ITEM.RADIO(\"133%\", \"zscale\"),\n          ITEM.RADIO(\"150%\", \"zscale\"),\n          ITEM.RADIO(\"175%\", \"zscale\"),\n          ITEM.RADIO(\"200%\", \"zscale\"),\n          ITEM.RADIO(\"250%\", \"zscale\"),\n          ITEM.RADIO(\"300%\", \"zscale\"),\n          ITEM.RADIO(\"400%\", \"zscale\")\n        ),\n        ITEM.RULE(),\n        ITEM.SUBMENU([\"Renderer\",\"Math Renderer\"],    {hidden:!CONFIG.showRenderer},\n          ITEM.RADIO([\"HTML-CSS\",\"HTML-CSS\"],       \"renderer\", {action: MENU.Renderer}),\n          ITEM.RADIO([\"CommonHTML\",\"Common HTML\"],  \"renderer\", {action: MENU.Renderer, value:\"CommonHTML\"}),\n          ITEM.RADIO([\"PreviewHTML\",\"Preview HTML\"],\"renderer\", {action: MENU.Renderer, value:\"PreviewHTML\"}),\n          ITEM.RADIO([\"MathML\",\"MathML\"],           \"renderer\", {action: MENU.Renderer, value:\"NativeMML\"}),\n          ITEM.RADIO([\"SVG\",\"SVG\"],                 \"renderer\", {action: MENU.Renderer}),\n          ITEM.RADIO([\"PlainSource\",\"Plain Source\"],\"renderer\", {action: MENU.Renderer, value:\"PlainSource\"}),\n          ITEM.RULE(),\n          ITEM.CHECKBOX([\"FastPreview\",\"Fast Preview\"], \"FastPreview\"),\n          ITEM.CHECKBOX([\"AssistiveMML\",\"Assistive MathML\"], \"assistiveMML\", {action:MENU.AssistiveMML}),\n          ITEM.CHECKBOX([\"InTabOrder\",\"Include in Tab Order\"], \"inTabOrder\")\n        ),\n        ITEM.SUBMENU(\"MathPlayer\",  {hidden:!HUB.Browser.isMSIE || !CONFIG.showMathPlayer,\n                                                    disabled:!HUB.Browser.hasMathPlayer},\n          ITEM.LABEL([\"MPHandles\",\"Let MathPlayer Handle:\"]),\n          ITEM.CHECKBOX([\"MenuEvents\",\"Menu Events\"],             \"mpContext\", {action: MENU.MPEvents, hidden:!isIE9}),\n          ITEM.CHECKBOX([\"MouseEvents\",\"Mouse Events\"],           \"mpMouse\",   {action: MENU.MPEvents, hidden:!isIE9}),\n          ITEM.CHECKBOX([\"MenuAndMouse\",\"Mouse and Menu Events\"], \"mpMouse\",   {action: MENU.MPEvents, hidden:isIE9})\n        ),\n        ITEM.SUBMENU([\"FontPrefs\",\"Font Preference\"],       {hidden:!CONFIG.showFontMenu},\n          ITEM.LABEL([\"ForHTMLCSS\",\"For HTML-CSS:\"]),\n          ITEM.RADIO([\"Auto\",\"Auto\"],          \"font\", {action: MENU.Font}),\n          ITEM.RULE(),\n          ITEM.RADIO([\"TeXLocal\",\"TeX (local)\"],   \"font\", {action: MENU.Font}),\n          ITEM.RADIO([\"TeXWeb\",\"TeX (web)\"],       \"font\", {action: MENU.Font}),\n          ITEM.RADIO([\"TeXImage\",\"TeX (image)\"],   \"font\", {action: MENU.Font}),\n          ITEM.RULE(),\n          ITEM.RADIO([\"STIXLocal\",\"STIX (local)\"], \"font\", {action: MENU.Font}),\n          ITEM.RADIO([\"STIXWeb\",\"STIX (web)\"], \"font\", {action: MENU.Font}),\n          ITEM.RULE(),\n          ITEM.RADIO([\"AsanaMathWeb\",\"Asana Math (web)\"], \"font\", {action: MENU.Font}),\n          ITEM.RADIO([\"GyrePagellaWeb\",\"Gyre Pagella (web)\"], \"font\", {action: MENU.Font}),\n          ITEM.RADIO([\"GyreTermesWeb\",\"Gyre Termes (web)\"], \"font\", {action: MENU.Font}),\n          ITEM.RADIO([\"LatinModernWeb\",\"Latin Modern (web)\"], \"font\", {action: MENU.Font}),\n          ITEM.RADIO([\"NeoEulerWeb\",\"Neo Euler (web)\"], \"font\", {action: MENU.Font})\n        ),\n        ITEM.SUBMENU([\"ContextMenu\",\"Contextual Menu\"],    {hidden:!CONFIG.showContext},\n          ITEM.RADIO([\"MathJax\",\"MathJax\"], \"context\"),\n          ITEM.RADIO([\"Browser\",\"Browser\"], \"context\")\n        ),\n        ITEM.COMMAND([\"Scale\",\"Scale All Math ...\"],MENU.Scale),\n        ITEM.RULE().With({hidden:!CONFIG.showDiscoverable, name:[\"\",\"discover_rule\"]}),\n        ITEM.CHECKBOX([\"Discoverable\",\"Highlight on Hover\"], \"discoverable\", {hidden:!CONFIG.showDiscoverable})\n      ),\n      ITEM.SUBMENU([\"Locale\",\"Language\"],                  {hidden:!CONFIG.showLocale, ltr:true},\n        ITEM.RADIO(\"en\", \"locale\",  {action: MENU.Locale}),\n        ITEM.RULE().With({hidden:!CONFIG.showLocaleURL, name:[\"\",\"localURL_rule\"]}),\n        ITEM.COMMAND([\"LoadLocale\",\"Load from URL ...\"], MENU.LoadLocale, {hidden:!CONFIG.showLocaleURL})\n      ),\n      ITEM.RULE(),\n      ITEM.COMMAND([\"About\",\"About MathJax\"],MENU.About),\n      ITEM.COMMAND([\"Help\",\"MathJax Help\"],MENU.Help)\n    );\n\n    if (MENU.isMobile) {\n      (function () {\n        var settings = CONFIG.settings;\n        var trigger = MENU.menu.Find(\"Math Settings\",\"Zoom Trigger\").submenu;\n        trigger.items[0].disabled = trigger.items[1].disabled = true;\n        if (settings.zoom === \"Hover\" || settings.zoom == \"Click\") {settings.zoom = \"None\"}\n        trigger.items = trigger.items.slice(0,4);\n\n        if (navigator.appVersion.match(/[ (]Android[) ]/)) {\n          MENU.ITEM.SUBMENU.Augment({marker: \"\\u00BB\"});\n        }\n      })();\n    }\n\n    MENU.CreateLocaleMenu();\n    MENU.CreateAnnotationMenu();\n  });\n\n  MENU.showRenderer = function (show) {\n    MENU.cookie.showRenderer = CONFIG.showRenderer = show; MENU.saveCookie();\n    MENU.menu.Find(\"Math Settings\",\"Math Renderer\").hidden = !show;\n  };\n  MENU.showMathPlayer = function (show) {\n    MENU.cookie.showMathPlayer = CONFIG.showMathPlayer = show; MENU.saveCookie();\n    MENU.menu.Find(\"Math Settings\",\"MathPlayer\").hidden = !show;\n  };\n  MENU.showFontMenu = function (show) {\n    MENU.cookie.showFontMenu = CONFIG.showFontMenu = show; MENU.saveCookie();\n    MENU.menu.Find(\"Math Settings\",\"Font Preference\").hidden = !show;\n  };\n  MENU.showContext = function (show) {\n    MENU.cookie.showContext = CONFIG.showContext = show; MENU.saveCookie();\n    MENU.menu.Find(\"Math Settings\",\"Contextual Menu\").hidden = !show;\n  };\n  MENU.showDiscoverable = function (show) {\n    MENU.cookie.showDiscoverable = CONFIG.showDiscoverable = show; MENU.saveCookie();\n    MENU.menu.Find(\"Math Settings\",\"Highlight on Hover\").hidden = !show;\n    MENU.menu.Find(\"Math Settings\",\"discover_rule\").hidden = !show;\n  };\n  MENU.showLocale = function (show) {\n    MENU.cookie.showLocale = CONFIG.showLocale = show; MENU.saveCookie();\n    MENU.menu.Find(\"Language\").hidden = !show;\n  };\n\n  MathJax.Hub.Register.StartupHook(\"HTML-CSS Jax Ready\",function () {\n    if (!MathJax.OutputJax[\"HTML-CSS\"].config.imageFont)\n      {MENU.menu.Find(\"Math Settings\",\"Font Preference\",\"TeX (image)\").disabled = true}\n  });\n\n  /*************************************************************/\n\n  CALLBACK.Queue(\n    HUB.Register.StartupHook(\"End Config\",{}), // wait until config is complete\n    [\"Styles\",AJAX,CONFIG.styles],\n    [\"Post\",HUB.Startup.signal,\"MathMenu Ready\"],\n    [\"loadComplete\",AJAX,\"[MathJax]/extensions/MathMenu.js\"]\n  );\n\n})(MathJax.Hub,MathJax.HTML,MathJax.Ajax,MathJax.CallBack,MathJax.OutputJax);\n"]}]}