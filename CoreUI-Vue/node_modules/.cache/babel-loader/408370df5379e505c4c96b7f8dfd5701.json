{"remainingRequest":"/home/hads/Documents/CoreUI-Vue/node_modules/babel-loader/lib/index.js!/home/hads/Downloads/pycharm-community-2020.1/plugins/python-ce/helpers/MathJax/jax/output/HTML-CSS/autoload/multiline.js","dependencies":[{"path":"/home/hads/Downloads/pycharm-community-2020.1/plugins/python-ce/helpers/MathJax/jax/output/HTML-CSS/autoload/multiline.js","mtime":1586259854000},{"path":"/home/hads/Documents/CoreUI-Vue/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/hads/Documents/CoreUI-Vue/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:LyogLSotIE1vZGU6IEphdmFzY3JpcHQ7IGluZGVudC10YWJzLW1vZGU6bmlsOyBqcy1pbmRlbnQtbGV2ZWw6IDIgLSotICovCgovKiB2aW06IHNldCB0cz0yIGV0IHN3PTIgdHc9ODA6ICovCgovKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogKgogKiAgTWF0aEpheC9qYXgvb3V0cHV0L0hUTUwtQ1NTL2F1dG9sb2FkL211bHRpbGluZS5qcwogKiAgCiAqICBJbXBsZW1lbnRzIHRoZSBIVE1MLUNTUyBvdXRwdXQgZm9yIDxtcm93PidzIHRoYXQgY29udGFpbiBsaW5lIGJyZWFrcy4KICoKICogIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQogKiAgCiAqICBDb3B5cmlnaHQgKGMpIDIwMTAtMjAxNSBUaGUgTWF0aEpheCBDb25zb3J0aXVtCiAqIAogKiAgTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlICJMaWNlbnNlIik7CiAqICB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuCiAqICBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXQKICogCiAqICAgICAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wCiAqIAogKiAgVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQogKiAgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywKICogIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLgogKiAgU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZAogKiAgbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuCiAqLwpNYXRoSmF4Lkh1Yi5SZWdpc3Rlci5TdGFydHVwSG9vaygiSFRNTC1DU1MgSmF4IFJlYWR5IiwgZnVuY3Rpb24gKCkgewogIHZhciBWRVJTSU9OID0gIjIuNi4wIjsKICB2YXIgTU1MID0gTWF0aEpheC5FbGVtZW50SmF4Lm1tbCwKICAgICAgSFRNTENTUyA9IE1hdGhKYXguT3V0cHV0SmF4WyJIVE1MLUNTUyJdOyAvLwogIC8vICBQZW5hbHRpZXMgZm9yIHRoZSB2YXJpb3VzIGxpbmUgYnJlYWtzCiAgLy8KCiAgdmFyIFBFTkFMVFkgPSB7CiAgICBuZXdsaW5lOiAwLAogICAgbm9icmVhazogMTAwMDAwMCwKICAgIGdvb2RicmVhazogWy0yMDBdLAogICAgYmFkYnJlYWs6IFsrMjAwXSwKICAgIGF1dG86IFswXSwKICAgIHRvb2JpZzogODAwLAogICAgbmVzdGZhY3RvcjogNDAwLAogICAgc3BhY2VmYWN0b3I6IC0xMDAsCiAgICBzcGFjZW9mZnNldDogMiwKICAgIHNwYWNlbGltaXQ6IDEsCiAgICAvLyBzcGFjZXMgbGFyZ2VyIHRoYW4gdGhpcyBnZXQgYSBwZW5hbHR5IGJvb3N0CiAgICBmZW5jZTogNTAwLAogICAgY2xvc2U6IDUwMAogIH07CiAgdmFyIEVORFZBTFVFUyA9IHsKICAgIGxpbmVicmVha3N0eWxlOiAiYWZ0ZXIiCiAgfTsKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogIE1NTC5tYmFzZS5BdWdtZW50KHsKICAgIEhUTUxsaW5lYnJlYWtQZW5hbHR5OiBQRU5BTFRZLAoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgLy8KICAgIC8vIEhhbmRsZSBicmVha2luZyBhbiBtcm93IGludG8gc2VwYXJhdGUgbGluZXMKICAgIC8vCiAgICBIVE1MbXVsdGlsaW5lOiBmdW5jdGlvbiBIVE1MbXVsdGlsaW5lKHNwYW4pIHsKICAgICAgLy8KICAgICAgLy8gIEZpbmQgdGhlIHBhcmVudCBlbGVtZW50IGFuZCBtYXJrIGl0IGFzIG11bHRpbGluZQogICAgICAvLwogICAgICB2YXIgcGFyZW50ID0gdGhpczsKCiAgICAgIHdoaWxlIChwYXJlbnQuaW5mZXJyZWQgfHwgcGFyZW50LnBhcmVudCAmJiBwYXJlbnQucGFyZW50LnR5cGUgPT09ICJtcm93IiAmJiBwYXJlbnQucGFyZW50LmRhdGEubGVuZ3RoID09PSAxKSB7CiAgICAgICAgcGFyZW50ID0gcGFyZW50LnBhcmVudDsKICAgICAgfQoKICAgICAgdmFyIGlzVG9wID0gcGFyZW50LnR5cGUgPT09ICJtYXRoIiAmJiBwYXJlbnQuR2V0KCJkaXNwbGF5IikgPT09ICJibG9jayIgfHwgcGFyZW50LnR5cGUgPT09ICJtdGQiOwogICAgICBwYXJlbnQuaXNNdWx0aWxpbmUgPSB0cnVlOyAvLwogICAgICAvLyAgRGVmYXVsdCB2YWx1ZXMgZm9yIHRoZSBsaW5lLWJyZWFraW5nIHBhcmFtZXRlcnMKICAgICAgLy8KCiAgICAgIHZhciBWQUxVRVMgPSB0aGlzLmdldFZhbHVlcygibGluZWJyZWFrIiwgImxpbmVicmVha3N0eWxlIiwgImxpbmVsZWFkaW5nIiwgImxpbmVicmVha211bHRjaGFyIiwgImluZGVudGFsaWduIiwgImluZGVudHNoaWZ0IiwgImluZGVudGFsaWduZmlyc3QiLCAiaW5kZW50c2hpZnRmaXJzdCIsICJpbmRlbnRhbGlnbmxhc3QiLCAiaW5kZW50c2hpZnRsYXN0Iik7CgogICAgICBpZiAoVkFMVUVTLmxpbmVicmVha3N0eWxlID09PSBNTUwuTElORUJSRUFLU1RZTEUuSU5GSVhMSU5FQlJFQUtTVFlMRSkgewogICAgICAgIFZBTFVFUy5saW5lYnJlYWtzdHlsZSA9IHRoaXMuR2V0KCJpbmZpeGxpbmVicmVha3N0eWxlIik7CiAgICAgIH0KCiAgICAgIFZBTFVFUy5saW5lbGVhZGluZyA9IEhUTUxDU1MubGVuZ3RoMmVtKFZBTFVFUy5saW5lbGVhZGluZywgMSwgMC41KTsgLy8KICAgICAgLy8gIFJlbW92ZSBvbGQgY29sb3IgYW5kIGJyZWFrIHRoZSBzcGFuIGF0IGl0cyBiZXN0IGxpbmUgYnJlYWtzCiAgICAgIC8vCgogICAgICB0aGlzLkhUTUxyZW1vdmVDb2xvcihzcGFuKTsKICAgICAgdmFyIHN0YWNrID0gSFRNTENTUy5jcmVhdGVTdGFjayhzcGFuKTsKICAgICAgdGhpcy5IVE1MZ2V0U2NhbGUoKTsKICAgICAgdmFyIHN0YXRlID0gewogICAgICAgIG46IDAsCiAgICAgICAgWTogMCwKICAgICAgICBzY2FsZTogdGhpcy5zY2FsZSB8fCAxLAogICAgICAgIGlzVG9wOiBpc1RvcCwKICAgICAgICB2YWx1ZXM6IHt9LAogICAgICAgIFZBTFVFUzogVkFMVUVTCiAgICAgIH0sCiAgICAgICAgICBhbGlnbiA9IHRoaXMuSFRNTGdldEFsaWduKHN0YXRlLCB7fSksCiAgICAgICAgICBzaGlmdCA9IHRoaXMuSFRNTGdldFNoaWZ0KHN0YXRlLCB7fSwgYWxpZ24pLAogICAgICAgICAgc3RhcnQgPSBbXSwKICAgICAgICAgIGVuZCA9IHsKICAgICAgICBpbmRleDogW10sCiAgICAgICAgcGVuYWx0eTogUEVOQUxUWS5ub2JyZWFrLAogICAgICAgIHc6IDAsCiAgICAgICAgVzogc2hpZnQsCiAgICAgICAgc2hpZnQ6IHNoaWZ0LAogICAgICAgIHNjYW5XOiBzaGlmdCwKICAgICAgICBuZXN0OiAwCiAgICAgIH0sCiAgICAgICAgICBicm9rZW4gPSBmYWxzZTsKCiAgICAgIHdoaWxlICh0aGlzLkhUTUxiZXR0ZXJCcmVhayhlbmQsIHN0YXRlKSAmJiAoZW5kLnNjYW5XID49IEhUTUxDU1MubGluZWJyZWFrV2lkdGggfHwgZW5kLnBlbmFsdHkgPT09IFBFTkFMVFkubmV3bGluZSkpIHsKICAgICAgICB0aGlzLkhUTUxhZGRMaW5lKHN0YWNrLCBzdGFydCwgZW5kLmluZGV4LCBzdGF0ZSwgZW5kLnZhbHVlcywgYnJva2VuKTsKICAgICAgICBzdGFydCA9IGVuZC5pbmRleC5zbGljZSgwKTsKICAgICAgICBicm9rZW4gPSB0cnVlOwogICAgICAgIGFsaWduID0gdGhpcy5IVE1MZ2V0QWxpZ24oc3RhdGUsIGVuZC52YWx1ZXMpOwogICAgICAgIHNoaWZ0ID0gdGhpcy5IVE1MZ2V0U2hpZnQoc3RhdGUsIGVuZC52YWx1ZXMsIGFsaWduKTsKCiAgICAgICAgaWYgKGFsaWduID09PSBNTUwuSU5ERU5UQUxJR04uQ0VOVEVSKSB7CiAgICAgICAgICBzaGlmdCA9IDA7CiAgICAgICAgfQoKICAgICAgICBlbmQuVyA9IGVuZC5zaGlmdCA9IGVuZC5zY2FuVyA9IHNoaWZ0OwogICAgICAgIGVuZC5wZW5hbHR5ID0gUEVOQUxUWS5ub2JyZWFrOwogICAgICB9CgogICAgICBzdGF0ZS5pc0xhc3QgPSB0cnVlOwogICAgICB0aGlzLkhUTUxhZGRMaW5lKHN0YWNrLCBzdGFydCwgW10sIHN0YXRlLCBFTkRWQUxVRVMsIGJyb2tlbik7IC8vCiAgICAgIC8vICBNYWtlIHRvcC1sZXZlbCBzcGFucyAxMDAlIHdpZGUuCiAgICAgIC8vICBGaW5pc2ggdXAgdGhlIHNwYWNlIGFuZCBhZGQgdGhlIGNvbG9yIGFnYWluCiAgICAgIC8vCgogICAgICBpZiAoaXNUb3ApIHsKICAgICAgICBzdGFjay5zdHlsZS53aWR0aCA9ICIxMDAlIjsKCiAgICAgICAgaWYgKHBhcmVudC50eXBlID09PSAibWF0aCIpIHsKICAgICAgICAgIHNwYW4uYmJveC53aWR0aCA9ICIxMDAlIjsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHRoaXMuSFRNTGhhbmRsZVNwYWNlKHNwYW4pOwogICAgICB0aGlzLkhUTUxoYW5kbGVDb2xvcihzcGFuKTsKICAgICAgc3Bhbi5iYm94LmlzTXVsdGlsaW5lID0gdHJ1ZTsKICAgICAgcmV0dXJuIHNwYW47CiAgICB9LAoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgLy8KICAgIC8vICBMb2NhdGUgdGhlIG5leHQgbGluZWJyZWFrIHRoYXQgaXMgYmV0dGVyIHRoYW4gdGhlIGN1cnJlbnQgb25lCiAgICAvLwogICAgSFRNTGJldHRlckJyZWFrOiBmdW5jdGlvbiBIVE1MYmV0dGVyQnJlYWsoaW5mbywgc3RhdGUpIHsKICAgICAgaWYgKHRoaXMuaXNUb2tlbikgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyBGSVhNRTogaGFuZGxlIGJyZWFraW5nIG9mIHRva2VuIGVsZW1lbnRzCgoKICAgICAgaWYgKHRoaXMuaXNFbWJlbGxpc2hlZCgpKSB7CiAgICAgICAgaW5mby5lbWJlbGxpc2hlZCA9IHRoaXM7CiAgICAgICAgcmV0dXJuIHRoaXMuQ29yZU1PKCkuSFRNTGJldHRlckJyZWFrKGluZm8sIHN0YXRlKTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMubGluZWJyZWFrQ29udGFpbmVyKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vCiAgICAgIC8vICBHZXQgdGhlIGN1cnJlbnQgYnJlYWtwb2ludCBwb3NpdGlvbiBhbmQgb3RoZXIgZGF0YQogICAgICAvLwoKCiAgICAgIHZhciBpbmRleCA9IGluZm8uaW5kZXguc2xpY2UoMCksCiAgICAgICAgICBpID0gaW5mby5pbmRleC5zaGlmdCgpLAogICAgICAgICAgbSA9IHRoaXMuZGF0YS5sZW5ndGgsCiAgICAgICAgICBXLAogICAgICAgICAgdywKICAgICAgICAgIHNjYW5XLAogICAgICAgICAgYnJva2VuID0gaW5mby5pbmRleC5sZW5ndGggPiAwLAogICAgICAgICAgYmV0dGVyID0gZmFsc2U7CgogICAgICBpZiAoaSA9PSBudWxsKSB7CiAgICAgICAgaSA9IC0xOwogICAgICB9CgogICAgICA7CgogICAgICBpZiAoIWJyb2tlbikgewogICAgICAgIGkrKzsKICAgICAgICBpbmZvLlcgKz0gaW5mby53OwogICAgICAgIGluZm8udyA9IDA7CiAgICAgIH0KCiAgICAgIHNjYW5XID0gaW5mby5zY2FuVyA9IGluZm8uVzsKICAgICAgaW5mby5uZXN0Kys7IC8vCiAgICAgIC8vICBMb29rIHRocm91Z2ggdGhlIGxpbmUgZm9yIGJyZWFrcG9pbnRzLAogICAgICAvLyAgICAoYXMgbG9uZyBhcyB3ZSBhcmUgbm90IHRvbyBmYXIgcGFzdCB0aGUgYnJlYWtpbmcgd2lkdGgpCiAgICAgIC8vCgogICAgICB3aGlsZSAoaSA8IG0gJiYgaW5mby5zY2FuVyA8IDEuMzMgKiBIVE1MQ1NTLmxpbmVicmVha1dpZHRoKSB7CiAgICAgICAgaWYgKHRoaXMuZGF0YVtpXSkgewogICAgICAgICAgaWYgKHRoaXMuZGF0YVtpXS5IVE1MYmV0dGVyQnJlYWsoaW5mbywgc3RhdGUpKSB7CiAgICAgICAgICAgIGJldHRlciA9IHRydWU7CiAgICAgICAgICAgIGluZGV4ID0gW2ldLmNvbmNhdChpbmZvLmluZGV4KTsKICAgICAgICAgICAgVyA9IGluZm8uVzsKICAgICAgICAgICAgdyA9IGluZm8udzsKCiAgICAgICAgICAgIGlmIChpbmZvLnBlbmFsdHkgPT09IFBFTkFMVFkubmV3bGluZSkgewogICAgICAgICAgICAgIGluZm8uaW5kZXggPSBpbmRleDsKCiAgICAgICAgICAgICAgaWYgKGluZm8ubmVzdCkgewogICAgICAgICAgICAgICAgaW5mby5uZXN0LS07CiAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQoKICAgICAgICAgIHNjYW5XID0gYnJva2VuID8gaW5mby5zY2FuVyA6IHRoaXMuSFRNTGFkZFdpZHRoKGksIGluZm8sIHNjYW5XKTsKICAgICAgICB9CgogICAgICAgIGluZm8uaW5kZXggPSBbXTsKICAgICAgICBpKys7CiAgICAgICAgYnJva2VuID0gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChpbmZvLm5lc3QpIHsKICAgICAgICBpbmZvLm5lc3QtLTsKICAgICAgfQoKICAgICAgaW5mby5pbmRleCA9IGluZGV4OwoKICAgICAgaWYgKGJldHRlcikgewogICAgICAgIGluZm8uVyA9IFc7CiAgICAgICAgaW5mby53ID0gdzsKICAgICAgfQoKICAgICAgcmV0dXJuIGJldHRlcjsKICAgIH0sCiAgICBIVE1MYWRkV2lkdGg6IGZ1bmN0aW9uIEhUTUxhZGRXaWR0aChpLCBpbmZvLCBzY2FuVykgewogICAgICBpZiAodGhpcy5kYXRhW2ldKSB7CiAgICAgICAgdmFyIHNwYW4gPSB0aGlzLmRhdGFbaV0uSFRNTHNwYW5FbGVtZW50KCk7CiAgICAgICAgc2NhblcgKz0gc3Bhbi5iYm94Lnc7CgogICAgICAgIGlmIChzcGFuLnN0eWxlLnBhZGRpbmdMZWZ0KSB7CiAgICAgICAgICBzY2FuVyArPSBIVE1MQ1NTLnVuRW0oc3Bhbi5zdHlsZS5wYWRkaW5nTGVmdCk7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3Bhbi5zdHlsZS5wYWRkaW5nUmlnaHQpIHsKICAgICAgICAgIHNjYW5XICs9IEhUTUxDU1MudW5FbShzcGFuLnN0eWxlLnBhZGRpbmdSaWdodCk7CiAgICAgICAgfQoKICAgICAgICBpbmZvLlcgPSBpbmZvLnNjYW5XID0gc2Nhblc7CiAgICAgICAgaW5mby53ID0gMDsKICAgICAgfQoKICAgICAgcmV0dXJuIHNjYW5XOwogICAgfSwKCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIC8vCiAgICAvLyAgQ3JlYXRlIGEgbmV3IGxpbmUgYW5kIG1vdmUgdGhlIHJlcXVpcmVkIGVsZW1lbnRzIGludG8gaXQKICAgIC8vICBQb3NpdGlvbiBpdCB1c2luZyBwcm9wZXIgYWxpZ25tZW50IGFuZCBpbmRlbnRpbmcKICAgIC8vCiAgICBIVE1MYWRkTGluZTogZnVuY3Rpb24gSFRNTGFkZExpbmUoc3RhY2ssIHN0YXJ0LCBlbmQsIHN0YXRlLCB2YWx1ZXMsIGJyb2tlbikgewogICAgICAvLwogICAgICAvLyAgQ3JlYXRlIGEgYm94IGZvciB0aGUgbGluZSwgd2l0aCBlbXB0eSBCQm94CiAgICAgIC8vICAgIGZpbGwgaXQgd2l0aCB0aGUgcHJvcGVyIGVsZW1lbnRzLAogICAgICAvLyAgICBhbmQgY2xlYW4gdXAgdGhlIGJib3gKICAgICAgLy8KICAgICAgbGluZSA9IEhUTUxDU1MuY3JlYXRlQm94KHN0YWNrKTsKICAgICAgbGluZS5iYm94ID0gdGhpcy5IVE1MZW1wdHlCQm94KHt9KTsKICAgICAgc3RhdGUuZmlyc3QgPSBicm9rZW47CiAgICAgIHN0YXRlLmxhc3QgPSB0cnVlOwogICAgICB0aGlzLkhUTUxtb3ZlTGluZShzdGFydCwgZW5kLCBsaW5lLCBzdGF0ZSwgdmFsdWVzKTsKICAgICAgdGhpcy5IVE1MY2xlYW5CQm94KGxpbmUuYmJveCk7IC8vCiAgICAgIC8vICBHZXQgdGhlIGFsaWdubWVudCBhbmQgc2hpZnQgdmFsdWVzCiAgICAgIC8vCgogICAgICB2YXIgYWxpZ24gPSB0aGlzLkhUTUxnZXRBbGlnbihzdGF0ZSwgdmFsdWVzKSwKICAgICAgICAgIHNoaWZ0ID0gdGhpcy5IVE1MZ2V0U2hpZnQoc3RhdGUsIHZhbHVlcywgYWxpZ24pOyAvLwogICAgICAvLyAgU2V0IHRoZSBZIG9mZnNldCBiYXNlZCBvbiBwcmV2aW91cyBkZXB0aCwgbGVhZGluZywgYW5kIGN1cnJlbnQgaGVpZ2h0CiAgICAgIC8vCgogICAgICBpZiAoc3RhdGUubiA+IDApIHsKICAgICAgICB2YXIgTEhEID0gSFRNTENTUy5GT05UREFUQS5iYXNlbGluZXNraXAgKiBzdGF0ZS5zY2FsZTsKICAgICAgICB2YXIgbGVhZGluZyA9IChzdGF0ZS52YWx1ZXMubGluZWxlYWRpbmcgPT0gbnVsbCA/IHN0YXRlLlZBTFVFUyA6IHN0YXRlLnZhbHVlcykubGluZWxlYWRpbmcgKiBzdGF0ZS5zY2FsZTsKICAgICAgICBzdGF0ZS5ZIC09IE1hdGgubWF4KExIRCwgc3RhdGUuZCArIGxpbmUuYmJveC5oICsgbGVhZGluZyk7CiAgICAgIH0gLy8KICAgICAgLy8gIFBsYWNlIHRoZSBuZXcgbGluZQogICAgICAvLwoKCiAgICAgIEhUTUxDU1MuYWxpZ25Cb3gobGluZSwgYWxpZ24sIHN0YXRlLlksIHNoaWZ0KTsgLy8KICAgICAgLy8gIFNhdmUgdGhlIHZhbHVlcyBuZWVkZWQgZm9yIHRoZSBmdXR1cmUKICAgICAgLy8KCiAgICAgIHN0YXRlLmQgPSBsaW5lLmJib3guZDsKICAgICAgc3RhdGUudmFsdWVzID0gdmFsdWVzOwogICAgICBzdGF0ZS5uKys7CiAgICB9LAoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgLy8KICAgIC8vICBHZXQgYWxpZ25tZW50IGFuZCBzaGlmdCB2YWx1ZXMgZnJvbSB0aGUgZ2l2ZW4gZGF0YQogICAgLy8KICAgIEhUTUxnZXRBbGlnbjogZnVuY3Rpb24gSFRNTGdldEFsaWduKHN0YXRlLCB2YWx1ZXMpIHsKICAgICAgdmFyIGN1ciA9IHZhbHVlcywKICAgICAgICAgIHByZXYgPSBzdGF0ZS52YWx1ZXMsCiAgICAgICAgICBkZWYgPSBzdGF0ZS5WQUxVRVMsCiAgICAgICAgICBhbGlnbjsKCiAgICAgIGlmIChzdGF0ZS5uID09PSAwKSB7CiAgICAgICAgYWxpZ24gPSBjdXIuaW5kZW50YWxpZ25maXJzdCB8fCBwcmV2LmluZGVudGFsaWduZmlyc3QgfHwgZGVmLmluZGVudGFsaWduZmlyc3Q7CiAgICAgIH0gZWxzZSBpZiAoc3RhdGUuaXNMYXN0KSB7CiAgICAgICAgYWxpZ24gPSBwcmV2LmluZGVudGFsaWdubGFzdCB8fCBkZWYuaW5kZW50YWxpZ25sYXN0OwogICAgICB9IGVsc2UgewogICAgICAgIGFsaWduID0gcHJldi5pbmRlbnRhbGlnbiB8fCBkZWYuaW5kZW50YWxpZ247CiAgICAgIH0KCiAgICAgIGlmIChhbGlnbiA9PT0gTU1MLklOREVOVEFMSUdOLklOREVOVEFMSUdOKSB7CiAgICAgICAgYWxpZ24gPSBwcmV2LmluZGVudGFsaWduIHx8IGRlZi5pbmRlbnRhbGlnbjsKICAgICAgfQoKICAgICAgaWYgKGFsaWduID09PSBNTUwuSU5ERU5UQUxJR04uQVVUTykgewogICAgICAgIGFsaWduID0gc3RhdGUuaXNUb3AgPyB0aGlzLmRpc3BsYXlBbGlnbiA6IE1NTC5JTkRFTlRBTElHTi5MRUZUOwogICAgICB9CgogICAgICByZXR1cm4gYWxpZ247CiAgICB9LAogICAgSFRNTGdldFNoaWZ0OiBmdW5jdGlvbiBIVE1MZ2V0U2hpZnQoc3RhdGUsIHZhbHVlcywgYWxpZ24pIHsKICAgICAgdmFyIGN1ciA9IHZhbHVlcywKICAgICAgICAgIHByZXYgPSBzdGF0ZS52YWx1ZXMsCiAgICAgICAgICBkZWYgPSBzdGF0ZS5WQUxVRVMsCiAgICAgICAgICBzaGlmdDsKCiAgICAgIGlmIChzdGF0ZS5uID09PSAwKSB7CiAgICAgICAgc2hpZnQgPSBjdXIuaW5kZW50c2hpZnRmaXJzdCB8fCBwcmV2LmluZGVudHNoaWZ0Zmlyc3QgfHwgZGVmLmluZGVudHNoaWZ0Zmlyc3Q7CiAgICAgIH0gZWxzZSBpZiAoc3RhdGUuaXNMYXN0KSB7CiAgICAgICAgc2hpZnQgPSBwcmV2LmluZGVudHNoaWZ0bGFzdCB8fCBkZWYuaW5kZW50c2hpZnRsYXN0OwogICAgICB9IGVsc2UgewogICAgICAgIHNoaWZ0ID0gcHJldi5pbmRlbnRzaGlmdCB8fCBkZWYuaW5kZW50c2hpZnQ7CiAgICAgIH0KCiAgICAgIGlmIChzaGlmdCA9PT0gTU1MLklOREVOVFNISUZULklOREVOVFNISUZUKSB7CiAgICAgICAgc2hpZnQgPSBwcmV2LmluZGVudHNoaWZ0IHx8IGRlZi5pbmRlbnRzaGlmdDsKICAgICAgfQoKICAgICAgaWYgKHNoaWZ0ID09PSAiYXV0byIgfHwgc2hpZnQgPT09ICIiKSB7CiAgICAgICAgc2hpZnQgPSAiMCI7CiAgICAgIH0KCiAgICAgIHNoaWZ0ID0gSFRNTENTUy5sZW5ndGgyZW0oc2hpZnQsIDEsIEhUTUxDU1MuY3dpZHRoKTsKCiAgICAgIGlmIChzdGF0ZS5pc1RvcCAmJiB0aGlzLmRpc3BsYXlJbmRlbnQgIT09ICIwIikgewogICAgICAgIHZhciBpbmRlbnQgPSBIVE1MQ1NTLmxlbmd0aDJlbSh0aGlzLmRpc3BsYXlJbmRlbnQsIDEsIEhUTUxDU1MuY3dpZHRoKTsKICAgICAgICBzaGlmdCArPSBhbGlnbiA9PT0gTU1MLklOREVOVEFMSUdOLlJJR0hUID8gLWluZGVudCA6IGluZGVudDsKICAgICAgfQoKICAgICAgcmV0dXJuIHNoaWZ0OwogICAgfSwKCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIC8vCiAgICAvLyAgTW92ZSB0aGUgc2VsZWN0ZWQgZWxlbWVudHMgaW50byB0aGUgbmV3IGxpbmUncyBzcGFuLAogICAgLy8gICAgbW92aW5nIHdob2xlIGl0ZW1zIHdoZW4gcG9zc2libGUsIGFuZCBwYXJ0cyBvZiBvbmVzCiAgICAvLyAgICB0aGF0IGFyZSBzcGxpdCBieSBhIGxpbmUgYnJlYWsuCiAgICAvLyAgCiAgICBIVE1MbW92ZUxpbmU6IGZ1bmN0aW9uIEhUTUxtb3ZlTGluZShzdGFydCwgZW5kLCBzcGFuLCBzdGF0ZSwgdmFsdWVzKSB7CiAgICAgIHZhciBpID0gc3RhcnRbMF0sCiAgICAgICAgICBqID0gZW5kWzBdOwoKICAgICAgaWYgKGkgPT0gbnVsbCkgewogICAgICAgIGkgPSAtMTsKICAgICAgfQoKICAgICAgOwoKICAgICAgaWYgKGogPT0gbnVsbCkgewogICAgICAgIGogPSB0aGlzLmRhdGEubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGkgPT09IGogJiYgc3RhcnQubGVuZ3RoID4gMSkgewogICAgICAgIC8vCiAgICAgICAgLy8gIElmIHN0YXJ0aW5nIGFuZCBlbmRpbmcgaW4gdGhlIHNhbWUgZWxlbWVudCBtb3ZlIHRoZSBzdWJwaWVjZSB0byB0aGUgbmV3IGxpbmUKICAgICAgICAvLwogICAgICAgIHRoaXMuZGF0YVtpXS5IVE1MbW92ZVNsaWNlKHN0YXJ0LnNsaWNlKDEpLCBlbmQuc2xpY2UoMSksIHNwYW4sIHN0YXRlLCB2YWx1ZXMsICJwYWRkaW5nTGVmdCIpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vCiAgICAgICAgLy8gIE90aGVyd2lzZSwgbW92ZSB0aGUgcmVtYWluZGVyIG9mIHRoZSBpbml0aWFsIGl0ZW0KICAgICAgICAvLyAgYW5kIGFueSBvdGhlcnMgdXAgdG8gdGhlIGxhc3Qgb25lCiAgICAgICAgLy8KICAgICAgICB2YXIgbGFzdCA9IHN0YXRlLmxhc3Q7CiAgICAgICAgc3RhdGUubGFzdCA9IGZhbHNlOwoKICAgICAgICB3aGlsZSAoaSA8IGopIHsKICAgICAgICAgIGlmICh0aGlzLmRhdGFbaV0pIHsKICAgICAgICAgICAgaWYgKHN0YXJ0Lmxlbmd0aCA8PSAxKSB7CiAgICAgICAgICAgICAgdGhpcy5kYXRhW2ldLkhUTUxtb3ZlU3BhbihzcGFuLCBzdGF0ZSwgdmFsdWVzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLmRhdGFbaV0uSFRNTG1vdmVTbGljZShzdGFydC5zbGljZSgxKSwgW10sIHNwYW4sIHN0YXRlLCB2YWx1ZXMsICJwYWRkaW5nTGVmdCIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaSsrOwogICAgICAgICAgc3RhdGUuZmlyc3QgPSBmYWxzZTsKICAgICAgICAgIHN0YXJ0ID0gW107CiAgICAgICAgfSAvLwogICAgICAgIC8vICBJZiB0aGUgbGFzdCBpdGVtIGlzIGNvbXBsZXRlLCBtb3ZlIGl0LAogICAgICAgIC8vICAgIG90aGVyd2lzZSBtb3ZlIHRoZSBmaXJzdCBwYXJ0IG9mIGl0IHVwIHRvIHRoZSBzcGxpdAogICAgICAgIC8vCgoKICAgICAgICBzdGF0ZS5sYXN0ID0gbGFzdDsKCiAgICAgICAgaWYgKHRoaXMuZGF0YVtpXSkgewogICAgICAgICAgaWYgKGVuZC5sZW5ndGggPD0gMSkgewogICAgICAgICAgICB0aGlzLmRhdGFbaV0uSFRNTG1vdmVTcGFuKHNwYW4sIHN0YXRlLCB2YWx1ZXMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5kYXRhW2ldLkhUTUxtb3ZlU2xpY2UoW10sIGVuZC5zbGljZSgxKSwgc3Bhbiwgc3RhdGUsIHZhbHVlcywgInBhZGRpbmdSaWdodCIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KICAgIC8vCiAgICAvLyAgU3BsaXQgYW4gZWxlbWVudCBhbmQgY29weSB0aGUgc2VsZWN0ZWQgaXRlbXMgaW50byB0aGUgbmV3IHBhcnQKICAgIC8vCiAgICBIVE1MbW92ZVNsaWNlOiBmdW5jdGlvbiBIVE1MbW92ZVNsaWNlKHN0YXJ0LCBlbmQsIHNwYW4sIHN0YXRlLCB2YWx1ZXMsIHBhZGRpbmcpIHsKICAgICAgLy8KICAgICAgLy8gIEdldCByaWQgb2YgY29sb3IsIGlmIGFueSAoYWRkZWQgYmFjayBpbiBsYXRlcikKICAgICAgLy8gIENyZWF0ZSBhIG5ldyBzcGFuIGZvciB0aGUgc2xpY2Ugb2YgdGhlIGVsZW1lbnQKICAgICAgLy8gIE1vdmUgdGhlIHNlbGVjdGVkIHBvcnRpb24gaW50byB0aGUgc2xpY2UKICAgICAgLy8gIElmIGl0IGlzIHRoZSBsYXN0IHNsaWNlCiAgICAgIC8vICAgIFJlbW92ZSB0aGUgb3JpZ2luYWwgKG5vdyBlbXB0eSkgc3BhbgogICAgICAvLyAgICBSZW5hbWUgdGhlIENvbnRpbnVlLTAgc3BhbiB3aXRoIHRoZSBvcmlnaW5hbCBuYW1lIChmb3IgSFRNTHNwYW5FbGVtZW50KQogICAgICAvLyAgICBBZGQgYmFjayB0aGUgY29sb3IKICAgICAgLy8KICAgICAgdGhpcy5IVE1McmVtb3ZlQ29sb3IoKTsKICAgICAgdmFyIHNsaWNlID0gdGhpcy5IVE1MY3JlYXRlU2xpY2VTcGFuKHNwYW4pOwogICAgICB0aGlzLkhUTUxtb3ZlTGluZShzdGFydCwgZW5kLCBzbGljZSwgc3RhdGUsIHZhbHVlcyk7CiAgICAgIHNsaWNlLnN0eWxlW3BhZGRpbmddID0gIiI7CiAgICAgIHRoaXMuSFRNTGNvbWJpbmVCQm94ZXMoc2xpY2UsIHNwYW4uYmJveCk7CiAgICAgIHRoaXMuSFRNTGNsZWFuQkJveChzbGljZS5iYm94KTsKCiAgICAgIGlmIChlbmQubGVuZ3RoID09PSAwKSB7CiAgICAgICAgc3BhbiA9IHRoaXMuSFRNTHNwYW5FbGVtZW50KCk7CiAgICAgICAgc3Bhbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNwYW4pOwogICAgICAgIHNwYW4ubmV4dE1hdGhKYXhTcGFuLmlkID0gc3Bhbi5pZDsKICAgICAgICB2YXIgbiA9IDA7CgogICAgICAgIHdoaWxlIChzcGFuID0gc3Bhbi5uZXh0TWF0aEpheFNwYW4pIHsKICAgICAgICAgIHZhciBjb2xvciA9IHRoaXMuSFRNTGhhbmRsZUNvbG9yKHNwYW4pOwoKICAgICAgICAgIGlmIChjb2xvcikgewogICAgICAgICAgICBjb2xvci5pZCArPSAiLU1hdGhKYXgtQ29udGludWUtIiArIG47CiAgICAgICAgICAgIG4rKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiBzbGljZTsKICAgIH0sCgogICAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCiAgICAvLwogICAgLy8gIENyZWF0ZSBhIG5ldyBzcGFuIGZvciBhbiBlbGVtZW50IHRoYXQgaXMgc3BsaXQgaW4gdHdvCiAgICAvLyAgICBDbG9uZSB0aGUgb3JpZ2luYWwgYW5kIHVwZGF0ZSBpdHMgSUQuCiAgICAvLyAgICBMaW5rIHRoZSBvbGQgc3BhbiB0byB0aGUgbmV3IG9uZSBzbyB3ZSBjYW4gZmluZCBpdCBsYXRlcgogICAgLy8KICAgIEhUTUxjcmVhdGVTbGljZVNwYW46IGZ1bmN0aW9uIEhUTUxjcmVhdGVTbGljZVNwYW4oc3BhbikgewogICAgICB2YXIgU1BBTiA9IHRoaXMuSFRNTHNwYW5FbGVtZW50KCksCiAgICAgICAgICBuID0gMDsKICAgICAgdmFyIExBU1QgPSBTUEFOOwoKICAgICAgd2hpbGUgKExBU1QubmV4dE1hdGhKYXhTcGFuKSB7CiAgICAgICAgTEFTVCA9IExBU1QubmV4dE1hdGhKYXhTcGFuOwogICAgICAgIG4rKzsKICAgICAgfQoKICAgICAgdmFyIFNMSUNFID0gU1BBTi5jbG9uZU5vZGUoZmFsc2UpOwogICAgICBMQVNULm5leHRNYXRoSmF4U3BhbiA9IFNMSUNFOwogICAgICBTTElDRS5uZXh0TWF0aEpheFNwYW4gPSBudWxsOwogICAgICBTTElDRS5pZCArPSAiLU1hdGhKYXgtQ29udGludWUtIiArIG47CiAgICAgIFNMSUNFLmJib3ggPSB0aGlzLkhUTUxlbXB0eUJCb3goe30pOwogICAgICByZXR1cm4gc3Bhbi5hcHBlbmRDaGlsZChTTElDRSk7CiAgICB9LAoKICAgIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwogICAgLy8KICAgIC8vICBNb3ZlIGFuIGVsZW1lbnQgZnJvbSBpdHMgb3JpZ2luYWwgc3BhbiB0byBpdHMgbmV3IGxvY2F0aW9uIGluCiAgICAvLyAgICBhIHNwbGl0IGVsZW1lbnQgb3IgdGhlIG5ldyBsaW5lJ3Mgc3BhbgogICAgLy8KICAgIEhUTUxtb3ZlU3BhbjogZnVuY3Rpb24gSFRNTG1vdmVTcGFuKGxpbmUsIHN0YXRlLCB2YWx1ZXMpIHsKICAgICAgLy8gRklYTUU6ICBoYW5kbGUgbGluZWJyZWFrc3R5bGUgPT09ICJkdXBsaWNhdGUiCiAgICAgIC8vIEZJWE1FOiAgaGFuZGxlIGxpbmVicmVha211bHRjaGFyCiAgICAgIGlmICghKHN0YXRlLmZpcnN0IHx8IHN0YXRlLmxhc3QpIHx8IHN0YXRlLmZpcnN0ICYmIHN0YXRlLnZhbHVlcy5saW5lYnJlYWtzdHlsZSA9PT0gTU1MLkxJTkVCUkVBS1NUWUxFLkJFRk9SRSB8fCBzdGF0ZS5sYXN0ICYmIHZhbHVlcy5saW5lYnJlYWtzdHlsZSA9PT0gTU1MLkxJTkVCUkVBS1NUWUxFLkFGVEVSKSB7CiAgICAgICAgLy8KICAgICAgICAvLyAgTW92ZSBjb2xvciBhbmQgc3BhbgogICAgICAgIC8vCiAgICAgICAgdmFyIGNvbG9yID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIk1hdGhKYXgtQ29sb3ItIiArIHRoaXMuc3BhbklEICsgSFRNTENTUy5pZFBvc3RmaXgpOwoKICAgICAgICBpZiAoY29sb3IpIHsKICAgICAgICAgIGxpbmUuYXBwZW5kQ2hpbGQoY29sb3IpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHNwYW4gPSB0aGlzLkhUTUxzcGFuRWxlbWVudCgpOwogICAgICAgIGxpbmUuYXBwZW5kQ2hpbGQoc3Bhbik7IC8vCiAgICAgICAgLy8gIElmIGl0IGlzIGxhc3QsIHJlbW92ZSByaWdodCBwYWRkaW5nCiAgICAgICAgLy8gIElmIGl0IGlzIGZpcnN0LCByZW1vdmUgbGVmdCBwYWRkaW5nIGFuZCByZWNvbG9yCiAgICAgICAgLy8KCiAgICAgICAgaWYgKHN0YXRlLmxhc3QpIHsKICAgICAgICAgIHNwYW4uc3R5bGUucGFkZGluZ1JpZ2h0ID0gIiI7CiAgICAgICAgfQoKICAgICAgICBpZiAoc3RhdGUuZmlyc3QgfHwgc3RhdGUubmV4dElzRmlyc3QpIHsKICAgICAgICAgIHNwYW4uc3R5bGUucGFkZGluZ0xlZnQgPSAiIjsKCiAgICAgICAgICBpZiAoY29sb3IpIHsKICAgICAgICAgICAgdGhpcy5IVE1McmVtb3ZlQ29sb3Ioc3Bhbik7CiAgICAgICAgICAgIHRoaXMuSFRNTGhhbmRsZUNvbG9yKHNwYW4pOwogICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgaWYgKHN0YXRlLmZpcnN0ICYmIHNwYW4uYmJveC53ID09PSAwKSB7CiAgICAgICAgICBzdGF0ZS5uZXh0SXNGaXJzdCA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGRlbGV0ZSBzdGF0ZS5uZXh0SXNGaXJzdDsKICAgICAgICB9IC8vCiAgICAgICAgLy8gIFVwZGF0ZSBib3VuZGluZyBib3gKICAgICAgICAvLwoKCiAgICAgICAgdGhpcy5IVE1MY29tYmluZUJCb3hlcyh0aGlzLCBsaW5lLmJib3gpOwogICAgICB9CiAgICB9CiAgfSk7CiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICBNTUwubWZlbmNlZC5BdWdtZW50KHsKICAgIEhUTUxiZXR0ZXJCcmVhazogZnVuY3Rpb24gSFRNTGJldHRlckJyZWFrKGluZm8sIHN0YXRlKSB7CiAgICAgIC8vCiAgICAgIC8vICBHZXQgdGhlIGN1cnJlbnQgYnJlYWtwb2ludCBwb3NpdGlvbiBhbmQgb3RoZXIgZGF0YQogICAgICAvLwogICAgICB2YXIgaW5kZXggPSBpbmZvLmluZGV4LnNsaWNlKDApLAogICAgICAgICAgaSA9IGluZm8uaW5kZXguc2hpZnQoKSwKICAgICAgICAgIG0gPSB0aGlzLmRhdGEubGVuZ3RoLAogICAgICAgICAgVywKICAgICAgICAgIHcsCiAgICAgICAgICBzY2FuVywKICAgICAgICAgIGJyb2tlbiA9IGluZm8uaW5kZXgubGVuZ3RoID4gMCwKICAgICAgICAgIGJldHRlciA9IGZhbHNlOwoKICAgICAgaWYgKGkgPT0gbnVsbCkgewogICAgICAgIGkgPSAtMTsKICAgICAgfQoKICAgICAgOwoKICAgICAgaWYgKCFicm9rZW4pIHsKICAgICAgICBpKys7CiAgICAgICAgaW5mby5XICs9IGluZm8udzsKICAgICAgICBpbmZvLncgPSAwOwogICAgICB9CgogICAgICBzY2FuVyA9IGluZm8uc2NhblcgPSBpbmZvLlc7CiAgICAgIGluZm8ubmVzdCsrOyAvLwogICAgICAvLyAgQ3JlYXRlIGluZGljZXMgdGhhdCBpbmNsdWRlIHRoZSBkZWxpbWl0ZXJzIGFuZCBzZXBhcmF0b3JzCiAgICAgIC8vCgogICAgICBpZiAoIXRoaXMuZGF0YUkpIHsKICAgICAgICB0aGlzLmRhdGFJID0gW107CgogICAgICAgIGlmICh0aGlzLmRhdGEub3BlbikgewogICAgICAgICAgdGhpcy5kYXRhSS5wdXNoKCJvcGVuIik7CiAgICAgICAgfQoKICAgICAgICBpZiAobSkgewogICAgICAgICAgdGhpcy5kYXRhSS5wdXNoKDApOwogICAgICAgIH0KCiAgICAgICAgZm9yICh2YXIgaiA9IDE7IGogPCBtOyBqKyspIHsKICAgICAgICAgIGlmICh0aGlzLmRhdGFbInNlcCIgKyBqXSkgewogICAgICAgICAgICB0aGlzLmRhdGFJLnB1c2goInNlcCIgKyBqKTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLmRhdGFJLnB1c2goaik7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5kYXRhLmNsb3NlKSB7CiAgICAgICAgICB0aGlzLmRhdGFJLnB1c2goImNsb3NlIik7CiAgICAgICAgfQogICAgICB9CgogICAgICBtID0gdGhpcy5kYXRhSS5sZW5ndGg7IC8vCiAgICAgIC8vICBMb29rIHRocm91Z2ggdGhlIGxpbmUgZm9yIGJyZWFrcG9pbnRzLCBpbmNsdWRpbmcgdGhlIG9wZW4sIGNsb3NlLCBhbmQgc2VwYXJhdG9ycwogICAgICAvLyAgICAoYXMgbG9uZyBhcyB3ZSBhcmUgbm90IHRvbyBmYXIgcGFzdCB0aGUgYnJlYWtpbmcgd2lkdGgpCiAgICAgIC8vCgogICAgICB3aGlsZSAoaSA8IG0gJiYgaW5mby5zY2FuVyA8IDEuMzMgKiBIVE1MQ1NTLmxpbmVicmVha1dpZHRoKSB7CiAgICAgICAgdmFyIGsgPSB0aGlzLmRhdGFJW2ldOwoKICAgICAgICBpZiAodGhpcy5kYXRhW2tdKSB7CiAgICAgICAgICBpZiAodGhpcy5kYXRhW2tdLkhUTUxiZXR0ZXJCcmVhayhpbmZvLCBzdGF0ZSkpIHsKICAgICAgICAgICAgYmV0dGVyID0gdHJ1ZTsKICAgICAgICAgICAgaW5kZXggPSBbaV0uY29uY2F0KGluZm8uaW5kZXgpOwogICAgICAgICAgICBXID0gaW5mby5XOwogICAgICAgICAgICB3ID0gaW5mby53OwoKICAgICAgICAgICAgaWYgKGluZm8ucGVuYWx0eSA9PT0gUEVOQUxUWS5uZXdsaW5lKSB7CiAgICAgICAgICAgICAgaW5mby5pbmRleCA9IGluZGV4OwoKICAgICAgICAgICAgICBpZiAoaW5mby5uZXN0KSB7CiAgICAgICAgICAgICAgICBpbmZvLm5lc3QtLTsKICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgc2NhblcgPSBicm9rZW4gPyBpbmZvLnNjYW5XIDogdGhpcy5IVE1MYWRkV2lkdGgoaSwgaW5mbywgc2NhblcpOwogICAgICAgIH0KCiAgICAgICAgaW5mby5pbmRleCA9IFtdOwogICAgICAgIGkrKzsKICAgICAgICBicm9rZW4gPSBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKGluZm8ubmVzdCkgewogICAgICAgIGluZm8ubmVzdC0tOwogICAgICB9CgogICAgICBpbmZvLmluZGV4ID0gaW5kZXg7CgogICAgICBpZiAoYmV0dGVyKSB7CiAgICAgICAgaW5mby5XID0gVzsKICAgICAgICBpbmZvLncgPSB3OwogICAgICB9CgogICAgICByZXR1cm4gYmV0dGVyOwogICAgfSwKICAgIEhUTUxtb3ZlTGluZTogZnVuY3Rpb24gSFRNTG1vdmVMaW5lKHN0YXJ0LCBlbmQsIHNwYW4sIHN0YXRlLCB2YWx1ZXMpIHsKICAgICAgdmFyIGkgPSBzdGFydFswXSwKICAgICAgICAgIGogPSBlbmRbMF07CgogICAgICBpZiAoaSA9PSBudWxsKSB7CiAgICAgICAgaSA9IC0xOwogICAgICB9CgogICAgICA7CgogICAgICBpZiAoaiA9PSBudWxsKSB7CiAgICAgICAgaiA9IHRoaXMuZGF0YUkubGVuZ3RoIC0gMTsKICAgICAgfQoKICAgICAgaWYgKGkgPT09IGogJiYgc3RhcnQubGVuZ3RoID4gMSkgewogICAgICAgIC8vCiAgICAgICAgLy8gIElmIHN0YXJ0aW5nIGFuZCBlbmRpbmcgaW4gdGhlIHNhbWUgZWxlbWVudCBtb3ZlIHRoZSBzdWJwaWVjZSB0byB0aGUgbmV3IGxpbmUKICAgICAgICAvLwogICAgICAgIHRoaXMuZGF0YVt0aGlzLmRhdGFJW2ldXS5IVE1MbW92ZVNsaWNlKHN0YXJ0LnNsaWNlKDEpLCBlbmQuc2xpY2UoMSksIHNwYW4sIHN0YXRlLCB2YWx1ZXMsICJwYWRkaW5nTGVmdCIpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vCiAgICAgICAgLy8gIE90aGVyd2lzZSwgbW92ZSB0aGUgcmVtYWluZGVyIG9mIHRoZSBpbml0aWFsIGl0ZW0KICAgICAgICAvLyAgYW5kIGFueSBvdGhlcnMgKGluY2x1ZGluZyBvcGVuIGFuZCBzZXBhcmF0b3JzKSB1cCB0byB0aGUgbGFzdCBvbmUKICAgICAgICAvLwogICAgICAgIHZhciBsYXN0ID0gc3RhdGUubGFzdDsKICAgICAgICBzdGF0ZS5sYXN0ID0gZmFsc2U7CiAgICAgICAgdmFyIGsgPSB0aGlzLmRhdGFJW2ldOwoKICAgICAgICB3aGlsZSAoaSA8IGopIHsKICAgICAgICAgIGlmICh0aGlzLmRhdGFba10pIHsKICAgICAgICAgICAgaWYgKHN0YXJ0Lmxlbmd0aCA8PSAxKSB7CiAgICAgICAgICAgICAgdGhpcy5kYXRhW2tdLkhUTUxtb3ZlU3BhbihzcGFuLCBzdGF0ZSwgdmFsdWVzKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLmRhdGFba10uSFRNTG1vdmVTbGljZShzdGFydC5zbGljZSgxKSwgW10sIHNwYW4sIHN0YXRlLCB2YWx1ZXMsICJwYWRkaW5nTGVmdCIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CgogICAgICAgICAgaSsrOwogICAgICAgICAgayA9IHRoaXMuZGF0YUlbaV07CiAgICAgICAgICBzdGF0ZS5maXJzdCA9IGZhbHNlOwogICAgICAgICAgc3RhcnQgPSBbXTsKICAgICAgICB9IC8vCiAgICAgICAgLy8gIElmIHRoZSBsYXN0IGl0ZW0gaXMgY29tcGxldGUsIG1vdmUgaXQKICAgICAgICAvLwoKCiAgICAgICAgc3RhdGUubGFzdCA9IGxhc3Q7CgogICAgICAgIGlmICh0aGlzLmRhdGFba10pIHsKICAgICAgICAgIGlmIChlbmQubGVuZ3RoIDw9IDEpIHsKICAgICAgICAgICAgdGhpcy5kYXRhW2tdLkhUTUxtb3ZlU3BhbihzcGFuLCBzdGF0ZSwgdmFsdWVzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuZGF0YVtrXS5IVE1MbW92ZVNsaWNlKFtdLCBlbmQuc2xpY2UoMSksIHNwYW4sIHN0YXRlLCB2YWx1ZXMsICJwYWRkaW5nUmlnaHQiKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9KTsKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogIE1NTC5tc3Vic3VwLkF1Z21lbnQoewogICAgSFRNTGJldHRlckJyZWFrOiBmdW5jdGlvbiBIVE1MYmV0dGVyQnJlYWsoaW5mbywgc3RhdGUpIHsKICAgICAgaWYgKCF0aGlzLmRhdGFbdGhpcy5iYXNlXSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLwogICAgICAvLyAgR2V0IHRoZSBjdXJyZW50IGJyZWFrcG9pbnQgcG9zaXRpb24gYW5kIG90aGVyIGRhdGEKICAgICAgLy8KCgogICAgICB2YXIgaW5kZXggPSBpbmZvLmluZGV4LnNsaWNlKDApLAogICAgICAgICAgaSA9IGluZm8uaW5kZXguc2hpZnQoKSwKICAgICAgICAgIFcsCiAgICAgICAgICB3LAogICAgICAgICAgc2NhblcsCiAgICAgICAgICBicm9rZW4gPSBpbmZvLmluZGV4Lmxlbmd0aCA+IDAsCiAgICAgICAgICBiZXR0ZXIgPSBmYWxzZTsKCiAgICAgIGlmICghYnJva2VuKSB7CiAgICAgICAgaW5mby5XICs9IGluZm8udzsKICAgICAgICBpbmZvLncgPSAwOwogICAgICB9CgogICAgICBzY2FuVyA9IGluZm8uc2NhblcgPSBpbmZvLlc7IC8vCiAgICAgIC8vICBSZWNvcmQgdGhlIHdpZHRoIG9mIHRoZSBiYXNlIGFuZCB0aGUgc3VwZXItIGFuZCBzdWJzY3JpcHRzCiAgICAgIC8vCgogICAgICBpZiAoaSA9PSBudWxsKSB7CiAgICAgICAgdGhpcy5IVE1MYmFzZVcgPSB0aGlzLmRhdGFbdGhpcy5iYXNlXS5IVE1Mc3BhbkVsZW1lbnQoKS5iYm94Lnc7CiAgICAgICAgdGhpcy5IVE1MZHcgPSB0aGlzLkhUTUxzcGFuRWxlbWVudCgpLmJib3gudyAtIHRoaXMuSFRNTGJhc2VXOwogICAgICB9IC8vCiAgICAgIC8vICBDaGVjayBpZiB0aGUgYmFzZSBjYW4gYmUgYnJva2VuCiAgICAgIC8vCgoKICAgICAgaWYgKHRoaXMuZGF0YVt0aGlzLmJhc2VdLkhUTUxiZXR0ZXJCcmVhayhpbmZvLCBzdGF0ZSkpIHsKICAgICAgICBiZXR0ZXIgPSB0cnVlOwogICAgICAgIGluZGV4ID0gW3RoaXMuYmFzZV0uY29uY2F0KGluZm8uaW5kZXgpOwogICAgICAgIFcgPSBpbmZvLlc7CiAgICAgICAgdyA9IGluZm8udzsKCiAgICAgICAgaWYgKGluZm8ucGVuYWx0eSA9PT0gUEVOQUxUWS5uZXdsaW5lKSB7CiAgICAgICAgICBiZXR0ZXIgPSBicm9rZW4gPSB0cnVlOwogICAgICAgIH0KICAgICAgfSAvLwogICAgICAvLyAgQWRkIGluIHRoZSBiYXNlIGlmIGl0IGlzIHVuYnJva2VuLCBhbmQgYWRkIHRoZSBzY3JpcHRzCiAgICAgIC8vCgoKICAgICAgaWYgKCFicm9rZW4pIHsKICAgICAgICB0aGlzLkhUTUxhZGRXaWR0aCh0aGlzLmJhc2UsIGluZm8sIHNjYW5XKTsKICAgICAgfQoKICAgICAgaW5mby5zY2FuVyArPSB0aGlzLkhUTUxkdzsKICAgICAgaW5mby5XID0gaW5mby5zY2FuVzsKICAgICAgaW5mby5pbmRleCA9IFtdOwoKICAgICAgaWYgKGJldHRlcikgewogICAgICAgIGluZm8uVyA9IFc7CiAgICAgICAgaW5mby53ID0gdzsKICAgICAgICBpbmZvLmluZGV4ID0gaW5kZXg7CiAgICAgIH0KCiAgICAgIHJldHVybiBiZXR0ZXI7CiAgICB9LAogICAgSFRNTG1vdmVMaW5lOiBmdW5jdGlvbiBIVE1MbW92ZUxpbmUoc3RhcnQsIGVuZCwgc3Bhbiwgc3RhdGUsIHZhbHVlcykgewogICAgICAvLwogICAgICAvLyAgTW92ZSB0aGUgcHJvcGVyIHBhcnQgb2YgdGhlIGJhc2UKICAgICAgLy8KICAgICAgaWYgKHRoaXMuZGF0YVt0aGlzLmJhc2VdKSB7CiAgICAgICAgaWYgKHN0YXJ0Lmxlbmd0aCA+IDEpIHsKICAgICAgICAgIHRoaXMuZGF0YVt0aGlzLmJhc2VdLkhUTUxtb3ZlU2xpY2Uoc3RhcnQuc2xpY2UoMSksIGVuZC5zbGljZSgxKSwgc3Bhbiwgc3RhdGUsIHZhbHVlcywgInBhZGRpbmdMZWZ0Iik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChlbmQubGVuZ3RoIDw9IDEpIHsKICAgICAgICAgICAgdGhpcy5kYXRhW3RoaXMuYmFzZV0uSFRNTG1vdmVTcGFuKHNwYW4sIHN0YXRlLCB2YWx1ZXMpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5kYXRhW3RoaXMuYmFzZV0uSFRNTG1vdmVTbGljZShbXSwgZW5kLnNsaWNlKDEpLCBzcGFuLCBzdGF0ZSwgdmFsdWVzLCAicGFkZGluZ1JpZ2h0Iik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IC8vCiAgICAgIC8vICBJZiB0aGlzIGlzIHRoZSBlbmQsIGNoZWNrIGZvciBzdXBlciBhbmQgc3Vic2NyaXB0cywgYW5kIG1vdmUgdGhvc2UKICAgICAgLy8gIGJ5IG1vdmluZyB0aGUgc3RhY2sgdGhhdCBjb250YWlucyB0aGVtLCBhbmQgc2hpZnRpbmcgYnkgdGhlIGFtb3VudCBvZiB0aGUKICAgICAgLy8gIGJhc2UgdGhhdCBoYXMgYmVlbiByZW1vdmVkLiAgUmVtb3ZlIHRoZSBlbXB0eSBiYXNlIGJveCBmcm9tIHRoZSBzdGFjay4KICAgICAgLy8KCgogICAgICBpZiAoZW5kLmxlbmd0aCA9PT0gMCkgewogICAgICAgIHZhciBzID0gdGhpcy5kYXRhW3RoaXMuc3VwXSB8fCB0aGlzLmRhdGFbdGhpcy5zdWJdOwoKICAgICAgICBpZiAocyAmJiB0aGlzLkhUTUxub3RFbXB0eShzKSkgewogICAgICAgICAgdmFyIGJveCA9IHMuSFRNTHNwYW5FbGVtZW50KCkucGFyZW50Tm9kZSwKICAgICAgICAgICAgICBzdGFjayA9IGJveC5wYXJlbnROb2RlOwoKICAgICAgICAgIGlmICh0aGlzLmRhdGFbdGhpcy5iYXNlXSkgewogICAgICAgICAgICBzdGFjay5yZW1vdmVDaGlsZChzdGFjay5maXJzdENoaWxkKTsKICAgICAgICAgIH0KCiAgICAgICAgICBmb3IgKGJveCA9IHN0YWNrLmZpcnN0Q2hpbGQ7IGJveDsgYm94ID0gYm94Lm5leHRTaWJsaW5nKSB7CiAgICAgICAgICAgIGJveC5zdHlsZS5sZWZ0ID0gSFRNTENTUy5FbShIVE1MQ1NTLnVuRW0oYm94LnN0eWxlLmxlZnQpIC0gdGhpcy5IVE1MYmFzZVcpOwogICAgICAgICAgfQoKICAgICAgICAgIHN0YWNrLmJib3gudyAtPSB0aGlzLkhUTUxiYXNlVzsKICAgICAgICAgIHN0YWNrLnN0eWxlLndpZHRoID0gSFRNTENTUy5FbShzdGFjay5iYm94LncpOwogICAgICAgICAgdGhpcy5IVE1MY29tYmluZUJCb3hlcyhzdGFjaywgc3Bhbi5iYm94KTsKICAgICAgICAgIHNwYW4uYXBwZW5kQ2hpbGQoc3RhY2spOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0pOwogIC8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KCiAgTU1MLm1tdWx0aXNjcmlwdHMuQXVnbWVudCh7CiAgICBIVE1MYmV0dGVyQnJlYWs6IGZ1bmN0aW9uIEhUTUxiZXR0ZXJCcmVhayhpbmZvLCBzdGF0ZSkgewogICAgICBpZiAoIXRoaXMuZGF0YVt0aGlzLmJhc2VdKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8vCiAgICAgIC8vICBHZXQgdGhlIGN1cnJlbnQgYnJlYWtwb2ludCBwb3NpdGlvbiBhbmQgb3RoZXIgZGF0YQogICAgICAvLwoKCiAgICAgIHZhciBpbmRleCA9IGluZm8uaW5kZXguc2xpY2UoMCk7CiAgICAgIGluZm8uaW5kZXguc2hpZnQoKTsKICAgICAgdmFyIFcsCiAgICAgICAgICB3LAogICAgICAgICAgc2NhblcsCiAgICAgICAgICBicm9rZW4gPSBpbmZvLmluZGV4Lmxlbmd0aCA+IDAsCiAgICAgICAgICBiZXR0ZXIgPSBmYWxzZTsKCiAgICAgIGlmICghYnJva2VuKSB7CiAgICAgICAgaW5mby5XICs9IGluZm8udzsKICAgICAgICBpbmZvLncgPSAwOwogICAgICB9CgogICAgICBpbmZvLnNjYW5XID0gaW5mby5XOyAvLwogICAgICAvLyAgR2V0IHRoZSBib3VuZGluZyBib3hlcyBhbmQgdGhlIHdpZHRoIG9mIHRoZSBzY3JpcHRzCiAgICAgIC8vCgogICAgICB2YXIgYmJveCA9IHRoaXMuSFRNTHNwYW5FbGVtZW50KCkuYmJveCwKICAgICAgICAgIGJhc2UgPSB0aGlzLmRhdGFbdGhpcy5iYXNlXS5IVE1Mc3BhbkVsZW1lbnQoKS5iYm94OwogICAgICB2YXIgZHcgPSBiYm94LncgLSBiYXNlLnc7IC8vCiAgICAgIC8vICBBZGQgaW4gdGhlIHByZXNjcmlwdHMKICAgICAgLy8gIAoKICAgICAgaW5mby5zY2FuVyArPSBiYm94LmR4OwogICAgICBzY2FuVyA9IGluZm8uc2Nhblc7IC8vCiAgICAgIC8vICBDaGVjayBpZiB0aGUgYmFzZSBjYW4gYmUgYnJva2VuCiAgICAgIC8vCgogICAgICBpZiAodGhpcy5kYXRhW3RoaXMuYmFzZV0uSFRNTGJldHRlckJyZWFrKGluZm8sIHN0YXRlKSkgewogICAgICAgIGJldHRlciA9IHRydWU7CiAgICAgICAgaW5kZXggPSBbdGhpcy5iYXNlXS5jb25jYXQoaW5mby5pbmRleCk7CiAgICAgICAgVyA9IGluZm8uVzsKICAgICAgICB3ID0gaW5mby53OwoKICAgICAgICBpZiAoaW5mby5wZW5hbHR5ID09PSBQRU5BTFRZLm5ld2xpbmUpIHsKICAgICAgICAgIGJldHRlciA9IGJyb2tlbiA9IHRydWU7CiAgICAgICAgfQogICAgICB9IC8vCiAgICAgIC8vICBBZGQgaW4gdGhlIGJhc2UgaWYgaXQgaXMgdW5icm9rZW4sIGFuZCBhZGQgdGhlIHNjcmlwdHMKICAgICAgLy8KCgogICAgICBpZiAoIWJyb2tlbikgewogICAgICAgIHRoaXMuSFRNTGFkZFdpZHRoKHRoaXMuYmFzZSwgaW5mbywgc2NhblcpOwogICAgICB9CgogICAgICBpbmZvLnNjYW5XICs9IGR3OwogICAgICBpbmZvLlcgPSBpbmZvLnNjYW5XOwogICAgICBpbmZvLmluZGV4ID0gW107CgogICAgICBpZiAoYmV0dGVyKSB7CiAgICAgICAgaW5mby5XID0gVzsKICAgICAgICBpbmZvLncgPSB3OwogICAgICAgIGluZm8uaW5kZXggPSBpbmRleDsKICAgICAgfQoKICAgICAgcmV0dXJuIGJldHRlcjsKICAgIH0sCiAgICBIVE1MbW92ZUxpbmU6IGZ1bmN0aW9uIEhUTUxtb3ZlTGluZShzdGFydCwgZW5kLCBzcGFuLCBzdGF0ZSwgdmFsdWVzKSB7CiAgICAgIHZhciBTUEFOID0gdGhpcy5IVE1Mc3BhbkVsZW1lbnQoKSwKICAgICAgICAgIGRhdGEgPSBTUEFOLmJib3gsCiAgICAgICAgICBzdGFjayA9IFNQQU4uZmlyc3RDaGlsZCwKICAgICAgICAgIEJPWCA9IHt9OwoKICAgICAgaWYgKEhUTUxDU1MubXNpZVBhZGRpbmdXaWR0aEJ1ZykgewogICAgICAgIHN0YWNrID0gc3RhY2submV4dFNpYmxpbmc7CiAgICAgIH0KCiAgICAgIHZhciBib3ggPSBzdGFjay5maXJzdENoaWxkOyAvLwogICAgICAvLyAgR2V0IHRoZSBib3hlcyBmb3IgdGhlIHNjcmlwdHMgKGlmIGFueSkKICAgICAgLy8KCiAgICAgIHdoaWxlIChib3gpIHsKICAgICAgICBpZiAoYm94LmJib3ggJiYgYm94LmJib3gubmFtZSkgewogICAgICAgICAgQk9YW2JveC5iYm94Lm5hbWVdID0gYm94OwogICAgICAgIH0KCiAgICAgICAgYm94ID0gYm94Lm5leHRTaWJsaW5nOwogICAgICB9IC8vCiAgICAgIC8vICBJZiB0aGlzIGlzIHRoZSBzdGFydCwgbW92ZSB0aGUgcHJlc2NyaXB0cywgaWYgYW55LgogICAgICAvLwoKCiAgICAgIGlmIChzdGFydC5sZW5ndGggPCAxKSB7CiAgICAgICAgaWYgKEJPWC5wcmVzdWIgfHwgQk9YLnByZXN1cCkgewogICAgICAgICAgdmFyIFNUQUNLID0gSFRNTENTUy5jcmVhdGVTdGFjayhzcGFuKTsKCiAgICAgICAgICBpZiAoQk9YLnByZXN1cCkgewogICAgICAgICAgICBIVE1MQ1NTLmFkZEJveChTVEFDSywgQk9YLnByZXN1cCk7CiAgICAgICAgICAgIEhUTUxDU1MucGxhY2VCb3goQk9YLnByZXN1cCwgZGF0YS5keCAtIEJPWC5wcmVzdXAuYmJveC53LCBkYXRhLnUpOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChCT1gucHJlc3ViKSB7CiAgICAgICAgICAgIEhUTUxDU1MuYWRkQm94KFNUQUNLLCBCT1gucHJlc3ViKTsKICAgICAgICAgICAgSFRNTENTUy5wbGFjZUJveChCT1gucHJlc3ViLCBkYXRhLmR4ICsgZGF0YS5kZWx0YSAtIEJPWC5wcmVzdWIuYmJveC53LCAtZGF0YS52KTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLkhUTUxjb21iaW5lQkJveGVzKFNUQUNLLCBzcGFuLmJib3gpOwogICAgICAgICAgc3Bhbi5hcHBlbmRDaGlsZChTVEFDSyk7CiAgICAgICAgICBTVEFDSy5zdHlsZS53aWR0aCA9IEhUTUxDU1MuRW0oZGF0YS5keCk7CiAgICAgICAgfQogICAgICB9IC8vCiAgICAgIC8vICBNb3ZlIHRoZSBwcm9wZXIgcGFydCBvZiB0aGUgYmFzZQogICAgICAvLwoKCiAgICAgIGlmICh0aGlzLmRhdGFbdGhpcy5iYXNlXSkgewogICAgICAgIGlmIChzdGFydC5sZW5ndGggPiAxKSB7CiAgICAgICAgICB0aGlzLmRhdGFbdGhpcy5iYXNlXS5IVE1MbW92ZVNsaWNlKHN0YXJ0LnNsaWNlKDEpLCBlbmQuc2xpY2UoMSksIHNwYW4sIHN0YXRlLCB2YWx1ZXMsICJwYWRkaW5nTGVmdCIpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAoZW5kLmxlbmd0aCA8PSAxKSB7CiAgICAgICAgICAgIHRoaXMuZGF0YVt0aGlzLmJhc2VdLkhUTUxtb3ZlU3BhbihzcGFuLCBzdGF0ZSwgdmFsdWVzKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuZGF0YVt0aGlzLmJhc2VdLkhUTUxtb3ZlU2xpY2UoW10sIGVuZC5zbGljZSgxKSwgc3Bhbiwgc3RhdGUsIHZhbHVlcywgInBhZGRpbmdSaWdodCIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSAvLwogICAgICAvLyAgSWYgdGhpcyBpcyB0aGUgZW5kLCBjaGVjayBmb3Igc3VwZXIgYW5kIHN1YnNjcmlwdHMsIGFuZCBtb3ZlIHRob3NlCiAgICAgIC8vICBieSBtb3ZpbmcgdGhlIHN0YWNrIHRoYXQgY29udGFpbnMgdGhlbSwgYW5kIHNoaWZ0aW5nIGJ5IHRoZSBhbW91bnQgb2YgdGhlCiAgICAgIC8vICBiYXNlIHRoYXQgaGFzIGJlZW4gcmVtb3ZlZC4gIFJlbW92ZSB0aGUgZW1wdHkgYmFzZSBib3ggZnJvbSB0aGUgc3RhY2suCiAgICAgIC8vCgoKICAgICAgaWYgKGVuZC5sZW5ndGggPT09IDApIHsKICAgICAgICBpZiAodGhpcy5kYXRhW3RoaXMuYmFzZV0pIHsKICAgICAgICAgIHN0YWNrLnJlbW92ZUNoaWxkKHN0YWNrLmZpcnN0Q2hpbGQpOwogICAgICAgIH0KCiAgICAgICAgZm9yIChib3ggPSBzdGFjay5maXJzdENoaWxkOyBib3g7IGJveCA9IGJveC5uZXh0U2libGluZykgewogICAgICAgICAgYm94LnN0eWxlLmxlZnQgPSBIVE1MQ1NTLkVtKEhUTUxDU1MudW5FbShib3guc3R5bGUubGVmdCkgLSBkYXRhLnB4KTsKICAgICAgICB9CgogICAgICAgIHN0YWNrLmJib3gudyAtPSBkYXRhLnB4OwogICAgICAgIHN0YWNrLnN0eWxlLndpZHRoID0gSFRNTENTUy5FbShzdGFjay5iYm94LncpOwogICAgICAgIHRoaXMuSFRNTGNvbWJpbmVCQm94ZXMoc3RhY2ssIHNwYW4uYmJveCk7CiAgICAgICAgc3Bhbi5hcHBlbmRDaGlsZChzdGFjayk7CiAgICAgIH0KICAgIH0KICB9KTsKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogIE1NTC5tby5BdWdtZW50KHsKICAgIC8vCiAgICAvLyAgT3ZlcnJpZGUgdGhlIG1ldGhvZCBmb3IgY2hlY2tpbmcgbGluZSBicmVha3MgdG8gcHJvcGVybHkgaGFuZGxlIDxtbz4KICAgIC8vCiAgICBIVE1MYmV0dGVyQnJlYWs6IGZ1bmN0aW9uIEhUTUxiZXR0ZXJCcmVhayhpbmZvLCBzdGF0ZSkgewogICAgICBpZiAoaW5mby52YWx1ZXMgJiYgaW5mby52YWx1ZXMuaWQgPT09IHRoaXMuc3BhbklEKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB2YXIgdmFsdWVzID0gdGhpcy5nZXRWYWx1ZXMoImxpbmVicmVhayIsICJsaW5lYnJlYWtzdHlsZSIsICJsaW5lbGVhZGluZyIsICJsaW5lYnJlYWttdWx0Y2hhciIsICJpbmRlbnRhbGlnbiIsICJpbmRlbnRzaGlmdCIsICJpbmRlbnRhbGlnbmZpcnN0IiwgImluZGVudHNoaWZ0Zmlyc3QiLCAiaW5kZW50YWxpZ25sYXN0IiwgImluZGVudHNoaWZ0bGFzdCIsICJ0ZXhDbGFzcyIsICJmZW5jZSIpOwoKICAgICAgaWYgKHZhbHVlcy5saW5lYnJlYWtzdHlsZSA9PT0gTU1MLkxJTkVCUkVBS1NUWUxFLklORklYTElORUJSRUFLU1RZTEUpIHsKICAgICAgICB2YWx1ZXMubGluZWJyZWFrc3R5bGUgPSB0aGlzLkdldCgiaW5maXhsaW5lYnJlYWtzdHlsZSIpOwogICAgICB9IC8vCiAgICAgIC8vICBBZGp1c3QgbmVzdGluZyBieSBUZVggY2xhc3MgKGhlbHBzIG91dHB1dCB0aGF0IGRvZXMgbm90IGluY2x1ZGUKICAgICAgLy8gIG1yb3dzIGZvciBuZXN0aW5nLCBidXQgY2FuIGxlYXZlIHRoZXNlIHVuYmFsYW5jZWQuCiAgICAgIC8vCgoKICAgICAgaWYgKHZhbHVlcy50ZXhDbGFzcyA9PT0gTU1MLlRFWENMQVNTLk9QRU4pIHsKICAgICAgICBpbmZvLm5lc3QrKzsKICAgICAgfQoKICAgICAgaWYgKHZhbHVlcy50ZXhDbGFzcyA9PT0gTU1MLlRFWENMQVNTLkNMT1NFICYmIGluZm8ubmVzdCkgewogICAgICAgIGluZm8ubmVzdC0tOwogICAgICB9IC8vCiAgICAgIC8vICBHZXQgdGhlIGRlZmF1bHQgcGVuYWx0eSBmb3IgdGhpcyBsb2NhdGlvbgogICAgICAvLwoKCiAgICAgIHZhciBXID0gaW5mby5zY2FuVywKICAgICAgICAgIG1vID0gaW5mby5lbWJlbGxpc2hlZCB8fCB0aGlzOwogICAgICBkZWxldGUgaW5mby5lbWJlbGxpc2hlZDsKICAgICAgdmFyIHNwYW4gPSBtby5IVE1Mc3BhbkVsZW1lbnQoKSwKICAgICAgICAgIHcgPSBzcGFuLmJib3gudzsKCiAgICAgIGlmIChzcGFuLnN0eWxlLnBhZGRpbmdMZWZ0KSB7CiAgICAgICAgdyArPSBIVE1MQ1NTLnVuRW0oc3Bhbi5zdHlsZS5wYWRkaW5nTGVmdCk7CiAgICAgIH0KCiAgICAgIGlmICh2YWx1ZXMubGluZWJyZWFrc3R5bGUgPT09IE1NTC5MSU5FQlJFQUtTVFlMRS5BRlRFUikgewogICAgICAgIFcgKz0gdzsKICAgICAgICB3ID0gMDsKICAgICAgfQoKICAgICAgaWYgKFcgLSBpbmZvLnNoaWZ0ID09PSAwICYmIHZhbHVlcy5saW5lYnJlYWsgIT09IE1NTC5MSU5FQlJFQUsuTkVXTElORSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyBkb24ndCBicmVhayBhdCB6ZXJvIHdpZHRoIChGSVhNRT8pCgoKICAgICAgdmFyIG9mZnNldCA9IEhUTUxDU1MubGluZWJyZWFrV2lkdGggLSBXOyAvLyBBZGp1c3Qgb2ZmZXN0IGZvciBleHBsaWNpdCBmaXJzdC1saW5lIGluZGVudCBhbmQgYWxpZ24KCiAgICAgIGlmIChzdGF0ZS5uID09PSAwICYmICh2YWx1ZXMuaW5kZW50c2hpZnRmaXJzdCAhPT0gc3RhdGUuVkFMVUVTLmluZGVudHNoaWZ0Zmlyc3QgfHwgdmFsdWVzLmluZGVudGFsaWduZmlyc3QgIT09IHN0YXRlLlZBTFVFUy5pbmRlbnRhbGlnbmZpcnN0KSkgewogICAgICAgIHZhciBhbGlnbiA9IHRoaXMuSFRNTGdldEFsaWduKHN0YXRlLCB2YWx1ZXMpLAogICAgICAgICAgICBzaGlmdCA9IHRoaXMuSFRNTGdldFNoaWZ0KHN0YXRlLCB2YWx1ZXMsIGFsaWduKTsKICAgICAgICBvZmZzZXQgKz0gaW5mby5zaGlmdCAtIHNoaWZ0OwogICAgICB9IC8vCgoKICAgICAgdmFyIHBlbmFsdHkgPSBNYXRoLmZsb29yKG9mZnNldCAvIEhUTUxDU1MubGluZWJyZWFrV2lkdGggKiAxMDAwKTsKCiAgICAgIGlmIChwZW5hbHR5IDwgMCkgewogICAgICAgIHBlbmFsdHkgPSBQRU5BTFRZLnRvb2JpZyAtIDMgKiBwZW5hbHR5OwogICAgICB9CgogICAgICBpZiAodmFsdWVzLmZlbmNlKSB7CiAgICAgICAgcGVuYWx0eSArPSBQRU5BTFRZLmZlbmNlOwogICAgICB9CgogICAgICBpZiAodmFsdWVzLmxpbmVicmVha3N0eWxlID09PSBNTUwuTElORUJSRUFLU1RZTEUuQUZURVIgJiYgdmFsdWVzLnRleENsYXNzID09PSBNTUwuVEVYQ0xBU1MuT1BFTiB8fCB2YWx1ZXMudGV4Q2xhc3MgPT09IE1NTC5URVhDTEFTUy5DTE9TRSkgewogICAgICAgIHBlbmFsdHkgKz0gUEVOQUxUWS5jbG9zZTsKICAgICAgfQoKICAgICAgcGVuYWx0eSArPSBpbmZvLm5lc3QgKiBQRU5BTFRZLm5lc3RmYWN0b3I7IC8vCiAgICAgIC8vICBHZXQgdGhlIHBlbmFsdHkgZm9yIHRoaXMgdHlwZSBvZiBicmVhayBhbmQKICAgICAgLy8gICAgdXNlIGl0IHRvIG1vZGlmeSB0aGUgZGVmYXVsdCBwZW5hbHR5CiAgICAgIC8vCgogICAgICB2YXIgbGluZWJyZWFrID0gUEVOQUxUWVt2YWx1ZXMubGluZWJyZWFrIHx8IE1NTC5MSU5FQlJFQUsuQVVUT107CgogICAgICBpZiAoIShsaW5lYnJlYWsgaW5zdGFuY2VvZiBBcnJheSkpIHsKICAgICAgICAvLyAgZm9yIGJyZWFrcyBwYXN0IHRoZSB3aWR0aCwgZG9uJ3QgbW9kaWZ5IHBlbmFsdHkKICAgICAgICBpZiAob2Zmc2V0ID49IDApIHsKICAgICAgICAgIHBlbmFsdHkgPSBsaW5lYnJlYWsgKiBpbmZvLm5lc3Q7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHBlbmFsdHkgPSBNYXRoLm1heCgxLCBwZW5hbHR5ICsgbGluZWJyZWFrWzBdICogaW5mby5uZXN0KTsKICAgICAgfSAvLwogICAgICAvLyAgSWYgdGhlIHBlbmFsdHkgaXMgbm8gYmV0dGVyIHRoYW4gdGhlIGN1cnJlbnQgb25lLCByZXR1cm4gZmFsc2UKICAgICAgLy8gIE90aGVyd2lzZSBzYXZlIHRoZSBkYXRhIGZvciB0aGlzIGJyZWFrcG9pbnQgYW5kIHJldHVybiB0cnVlCiAgICAgIC8vCgoKICAgICAgaWYgKHBlbmFsdHkgPj0gaW5mby5wZW5hbHR5KSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpbmZvLnBlbmFsdHkgPSBwZW5hbHR5OwogICAgICBpbmZvLnZhbHVlcyA9IHZhbHVlczsKICAgICAgaW5mby5XID0gVzsKICAgICAgaW5mby53ID0gdzsKICAgICAgdmFsdWVzLmxpbmVsZWFkaW5nID0gSFRNTENTUy5sZW5ndGgyZW0odmFsdWVzLmxpbmVsZWFkaW5nLCAxLCBzdGF0ZS5WQUxVRVMubGluZWxlYWRpbmcpOwogICAgICB2YWx1ZXMuaWQgPSB0aGlzLnNwYW5JRDsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSk7CiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwoKICBNTUwubXNwYWNlLkF1Z21lbnQoewogICAgLy8KICAgIC8vICBPdmVycmlkZSB0aGUgbWV0aG9kIGZvciBjaGVja2luZyBsaW5lIGJyZWFrcyB0byBwcm9wZXJseSBoYW5kbGUgPG1zcGFjZT4KICAgIC8vCiAgICBIVE1MYmV0dGVyQnJlYWs6IGZ1bmN0aW9uIEhUTUxiZXR0ZXJCcmVhayhpbmZvLCBzdGF0ZSkgewogICAgICBpZiAoaW5mby52YWx1ZXMgJiYgaW5mby52YWx1ZXMuaWQgPT09IHRoaXMuc3BhbklEKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB2YXIgdmFsdWVzID0gdGhpcy5nZXRWYWx1ZXMoImxpbmVicmVhayIpOwogICAgICB2YXIgbGluZWJyZWFrVmFsdWUgPSB2YWx1ZXMubGluZWJyZWFrOwoKICAgICAgaWYgKCFsaW5lYnJlYWtWYWx1ZSB8fCB0aGlzLmhhc0RpbUF0dHIoKSkgewogICAgICAgIC8vIFRoZSBNYXRoTUwgc3BlYyBzYXlzIHRoYXQgdGhlIGxpbmVicmVhayBhdHRyaWJ1dGUgc2hvdWxkIGJlIGlnbm9yZWQKICAgICAgICAvLyBpZiBhbnkgZGltZW5zaW9uYWwgYXR0cmlidXRlIGlzIHNldC4KICAgICAgICBsaW5lYnJlYWtWYWx1ZSA9IE1NTC5MSU5FQlJFQUsuQVVUTzsKICAgICAgfSAvLwogICAgICAvLyAgR2V0IHRoZSBkZWZhdWx0IHBlbmFsdHkgZm9yIHRoaXMgbG9jYXRpb24KICAgICAgLy8KCgogICAgICB2YXIgVyA9IGluZm8uc2NhblcsCiAgICAgICAgICBzcGFuID0gdGhpcy5IVE1Mc3BhbkVsZW1lbnQoKSwKICAgICAgICAgIHcgPSBzcGFuLmJib3gudzsKCiAgICAgIGlmIChzcGFuLnN0eWxlLnBhZGRpbmdMZWZ0KSB7CiAgICAgICAgdyArPSBIVE1MQ1NTLnVuRW0oc3Bhbi5zdHlsZS5wYWRkaW5nTGVmdCk7CiAgICAgIH0KCiAgICAgIGlmIChXIC0gaW5mby5zaGlmdCA9PT0gMCkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfSAvLyBkb24ndCBicmVhayBhdCB6ZXJvIHdpZHRoIChGSVhNRT8pCgoKICAgICAgdmFyIG9mZnNldCA9IEhUTUxDU1MubGluZWJyZWFrV2lkdGggLSBXOyAvLwoKICAgICAgdmFyIHBlbmFsdHkgPSBNYXRoLmZsb29yKG9mZnNldCAvIEhUTUxDU1MubGluZWJyZWFrV2lkdGggKiAxMDAwKTsKCiAgICAgIGlmIChwZW5hbHR5IDwgMCkgewogICAgICAgIHBlbmFsdHkgPSBQRU5BTFRZLnRvb2JpZyAtIDMgKiBwZW5hbHR5OwogICAgICB9CgogICAgICBwZW5hbHR5ICs9IGluZm8ubmVzdCAqIFBFTkFMVFkubmVzdGZhY3RvcjsgLy8KICAgICAgLy8gIEdldCB0aGUgcGVuYWx0eSBmb3IgdGhpcyB0eXBlIG9mIGJyZWFrIGFuZAogICAgICAvLyAgICB1c2UgaXQgdG8gbW9kaWZ5IHRoZSBkZWZhdWx0IHBlbmFsdHkKICAgICAgLy8KCiAgICAgIHZhciBsaW5lYnJlYWsgPSBQRU5BTFRZW2xpbmVicmVha1ZhbHVlXTsKCiAgICAgIGlmIChsaW5lYnJlYWtWYWx1ZSA9PT0gTU1MLkxJTkVCUkVBSy5BVVRPICYmIHcgPj0gUEVOQUxUWS5zcGFjZWxpbWl0ICYmICF0aGlzLm1hdGhiYWNrZ3JvdW5kICYmICF0aGlzLmJhY2tncm91bmQpIHsKICAgICAgICBsaW5lYnJlYWsgPSBbKHcgKyBQRU5BTFRZLnNwYWNlb2Zmc2V0KSAqIFBFTkFMVFkuc3BhY2VmYWN0b3JdOwogICAgICB9CgogICAgICBpZiAoIShsaW5lYnJlYWsgaW5zdGFuY2VvZiBBcnJheSkpIHsKICAgICAgICAvLyAgZm9yIGJyZWFrcyBwYXN0IHRoZSB3aWR0aCwgZG9uJ3QgbW9kaWZ5IHBlbmFsdHkKICAgICAgICBpZiAob2Zmc2V0ID49IDApIHsKICAgICAgICAgIHBlbmFsdHkgPSBsaW5lYnJlYWsgKiBpbmZvLm5lc3Q7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHBlbmFsdHkgPSBNYXRoLm1heCgxLCBwZW5hbHR5ICsgbGluZWJyZWFrWzBdICogaW5mby5uZXN0KTsKICAgICAgfSAvLwogICAgICAvLyAgSWYgdGhlIHBlbmFsdHkgaXMgbm8gYmV0dGVyIHRoYW4gdGhlIGN1cnJlbnQgb25lLCByZXR1cm4gZmFsc2UKICAgICAgLy8gIE90aGVyd2lzZSBzYXZlIHRoZSBkYXRhIGZvciB0aGlzIGJyZWFrcG9pbnQgYW5kIHJldHVybiB0cnVlCiAgICAgIC8vCgoKICAgICAgaWYgKHBlbmFsdHkgPj0gaW5mby5wZW5hbHR5KSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBpbmZvLnBlbmFsdHkgPSBwZW5hbHR5OwogICAgICBpbmZvLnZhbHVlcyA9IHZhbHVlczsKICAgICAgaW5mby5XID0gVzsKICAgICAgaW5mby53ID0gdzsKICAgICAgdmFsdWVzLmxpbmVsZWFkaW5nID0gc3RhdGUuVkFMVUVTLmxpbmVsZWFkaW5nOwogICAgICB2YWx1ZXMubGluZWJyZWFrc3R5bGUgPSAiYmVmb3JlIjsKICAgICAgdmFsdWVzLmlkID0gdGhpcy5zcGFuSUQ7CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH0pOyAvLwogIC8vICBIb29rIGludG8gdGhlIG1hdGhjaG9pY2UgZXh0ZW5zaW9uCiAgLy8KCiAgTWF0aEpheC5IdWIuUmVnaXN0ZXIuU3RhcnR1cEhvb2soIlRlWCBtYXRoY2hvaWNlIFJlYWR5IiwgZnVuY3Rpb24gKCkgewogICAgTU1MLlRlWG1hdGhjaG9pY2UuQXVnbWVudCh7CiAgICAgIEhUTUxiZXR0ZXJCcmVhazogZnVuY3Rpb24gSFRNTGJldHRlckJyZWFrKGluZm8sIHN0YXRlKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuQ29yZSgpLkhUTUxiZXR0ZXJCcmVhayhpbmZvLCBzdGF0ZSk7CiAgICAgIH0sCiAgICAgIEhUTUxtb3ZlTGluZTogZnVuY3Rpb24gSFRNTG1vdmVMaW5lKHN0YXJ0LCBlbmQsIHNwYW4sIHN0YXRlLCB2YWx1ZXMpIHsKICAgICAgICByZXR1cm4gdGhpcy5Db3JlKCkuSFRNTG1vdmVTbGljZShzdGFydCwgZW5kLCBzcGFuLCBzdGF0ZSwgdmFsdWVzKTsKICAgICAgfQogICAgfSk7CiAgfSk7IC8vCiAgLy8gIEhhdmUgbWFjdGlvbiBwcm9jZXNzIG9ubHkgdGhlIHNlbGVjdGVkIGl0ZW0KICAvLwoKICBNTUwubWFjdGlvbi5BdWdtZW50KHsKICAgIEhUTUxiZXR0ZXJCcmVhazogZnVuY3Rpb24gSFRNTGJldHRlckJyZWFrKGluZm8sIHN0YXRlKSB7CiAgICAgIHJldHVybiB0aGlzLkNvcmUoKS5IVE1MYmV0dGVyQnJlYWsoaW5mbywgc3RhdGUpOwogICAgfSwKICAgIEhUTUxtb3ZlTGluZTogZnVuY3Rpb24gSFRNTG1vdmVMaW5lKHN0YXJ0LCBlbmQsIHNwYW4sIHN0YXRlLCB2YWx1ZXMpIHsKICAgICAgcmV0dXJuIHRoaXMuQ29yZSgpLkhUTUxtb3ZlU2xpY2Uoc3RhcnQsIGVuZCwgc3Bhbiwgc3RhdGUsIHZhbHVlcyk7CiAgICB9LAogICAgLy8KICAgIC8vICBTcGxpdCBhbmQgbW92ZSB0aGUgaGl0IGJveGVzIGFzIHdlbGwKICAgIC8vCiAgICBIVE1MbW92ZVNsaWNlOiBmdW5jdGlvbiBIVE1MbW92ZVNsaWNlKHN0YXJ0LCBlbmQsIHNwYW4sIHN0YXRlLCB2YWx1ZXMsIHBhZGRpbmcpIHsKICAgICAgdmFyIGhpdGJveCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJNYXRoSmF4LUhpdEJveC0iICsgdGhpcy5zcGFuSUQgKyBIVE1MQ1NTLmlkUG9zdGZpeCk7CgogICAgICBpZiAoaGl0Ym94KSB7CiAgICAgICAgaGl0Ym94LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoaGl0Ym94KTsKICAgICAgfQoKICAgICAgdmFyIHNsaWNlID0gdGhpcy5TVVBFUihhcmd1bWVudHMpLkhUTUxtb3ZlU2xpY2UuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKCiAgICAgIGlmIChlbmQubGVuZ3RoID09PSAwKSB7CiAgICAgICAgc3BhbiA9IHRoaXMuSFRNTHNwYW5FbGVtZW50KCk7CiAgICAgICAgdmFyIG4gPSAwOwoKICAgICAgICB3aGlsZSAoc3BhbikgewogICAgICAgICAgaGl0Ym94ID0gdGhpcy5IVE1MaGFuZGxlSGl0Qm94KHNwYW4sICItQ29udGludWUtIiArIG4pOwogICAgICAgICAgc3BhbiA9IHNwYW4ubmV4dE1hdGhKYXhTcGFuOwogICAgICAgICAgbisrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHNsaWNlOwogICAgfQogIH0pOyAvLwogIC8vICBIYXZlIHNlbWFudGljcyBvbmx5IGRvIHRoZSBmaXJzdCBlbGVtZW50CiAgLy8gIChGSVhNRTogIGRvIHdlIG5lZWQgdG8gZG8gYW55dGhpbmcgc3BlY2lhbCBhYm91dCBhbm5vdGF0aW9uLXhtbD8pCiAgLy8KCiAgTU1MLnNlbWFudGljcy5BdWdtZW50KHsKICAgIEhUTUxiZXR0ZXJCcmVhazogZnVuY3Rpb24gSFRNTGJldHRlckJyZWFrKGluZm8sIHN0YXRlKSB7CiAgICAgIHJldHVybiB0aGlzLmRhdGFbMF0gPyB0aGlzLmRhdGFbMF0uSFRNTGJldHRlckJyZWFrKGluZm8sIHN0YXRlKSA6IGZhbHNlOwogICAgfSwKICAgIEhUTUxtb3ZlTGluZTogZnVuY3Rpb24gSFRNTG1vdmVMaW5lKHN0YXJ0LCBlbmQsIHNwYW4sIHN0YXRlLCB2YWx1ZXMpIHsKICAgICAgcmV0dXJuIHRoaXMuZGF0YVswXSA/IHRoaXMuZGF0YVswXS5IVE1MbW92ZVNsaWNlKHN0YXJ0LCBlbmQsIHNwYW4sIHN0YXRlLCB2YWx1ZXMpIDogbnVsbDsKICAgIH0KICB9KTsKICAvKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCgogIE1hdGhKYXguSHViLlN0YXJ0dXAuc2lnbmFsLlBvc3QoIkhUTUwtQ1NTIG11bHRpbGluZSBSZWFkeSIpOwogIE1hdGhKYXguQWpheC5sb2FkQ29tcGxldGUoSFRNTENTUy5hdXRvbG9hZERpciArICIvbXVsdGlsaW5lLmpzIik7Cn0pOw=="},{"version":3,"sources":["/home/hads/Downloads/pycharm-community-2020.1/plugins/python-ce/helpers/MathJax/jax/output/HTML-CSS/autoload/multiline.js"],"names":["MathJax","Hub","Register","StartupHook","VERSION","MML","ElementJax","mml","HTMLCSS","OutputJax","PENALTY","newline","nobreak","goodbreak","badbreak","auto","toobig","nestfactor","spacefactor","spaceoffset","spacelimit","fence","close","ENDVALUES","linebreakstyle","mbase","Augment","HTMLlinebreakPenalty","HTMLmultiline","span","parent","inferred","type","data","length","isTop","Get","isMultiline","VALUES","getValues","LINEBREAKSTYLE","INFIXLINEBREAKSTYLE","lineleading","length2em","HTMLremoveColor","stack","createStack","HTMLgetScale","state","n","Y","scale","values","align","HTMLgetAlign","shift","HTMLgetShift","start","end","index","penalty","w","W","scanW","nest","broken","HTMLbetterBreak","linebreakWidth","HTMLaddLine","slice","INDENTALIGN","CENTER","isLast","style","width","bbox","HTMLhandleSpace","HTMLhandleColor","info","isToken","isEmbellished","embellished","CoreMO","linebreakContainer","i","m","better","concat","HTMLaddWidth","HTMLspanElement","paddingLeft","unEm","paddingRight","line","createBox","HTMLemptyBBox","first","last","HTMLmoveLine","HTMLcleanBBox","LHD","FONTDATA","baselineskip","leading","Math","max","d","h","alignBox","cur","prev","def","indentalignfirst","indentalignlast","indentalign","AUTO","displayAlign","LEFT","indentshiftfirst","indentshiftlast","indentshift","INDENTSHIFT","cwidth","displayIndent","indent","RIGHT","j","HTMLmoveSlice","HTMLmoveSpan","padding","HTMLcreateSliceSpan","HTMLcombineBBoxes","parentNode","removeChild","nextMathJaxSpan","id","color","SPAN","LAST","SLICE","cloneNode","appendChild","BEFORE","AFTER","document","getElementById","spanID","idPostfix","nextIsFirst","mfenced","dataI","open","push","k","msubsup","base","HTMLbaseW","HTMLdw","s","sup","sub","HTMLnotEmpty","box","firstChild","nextSibling","left","Em","mmultiscripts","dw","dx","BOX","msiePaddingWidthBug","name","presub","presup","STACK","addBox","placeBox","u","delta","v","px","mo","texClass","TEXCLASS","OPEN","CLOSE","linebreak","LINEBREAK","NEWLINE","offset","floor","Array","mspace","linebreakValue","hasDimAttr","mathbackground","background","TeXmathchoice","Core","maction","hitbox","SUPER","arguments","apply","HTMLhandleHitBox","semantics","Startup","signal","Post","Ajax","loadComplete","autoloadDir"],"mappings":"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","sourcesContent":["/* -*- Mode: Javascript; indent-tabs-mode:nil; js-indent-level: 2 -*- */\n/* vim: set ts=2 et sw=2 tw=80: */\n\n/*************************************************************\n *\n *  MathJax/jax/output/HTML-CSS/autoload/multiline.js\n *  \n *  Implements the HTML-CSS output for <mrow>'s that contain line breaks.\n *\n *  ---------------------------------------------------------------------\n *  \n *  Copyright (c) 2010-2015 The MathJax Consortium\n * \n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n * \n *      http://www.apache.org/licenses/LICENSE-2.0\n * \n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n */\n\nMathJax.Hub.Register.StartupHook(\"HTML-CSS Jax Ready\",function () {\n  var VERSION = \"2.6.0\";\n  var MML = MathJax.ElementJax.mml,\n      HTMLCSS = MathJax.OutputJax[\"HTML-CSS\"];\n      \n  //\n  //  Penalties for the various line breaks\n  //\n  var PENALTY = {\n    newline:         0,\n    nobreak:   1000000,\n    goodbreak:   [-200],\n    badbreak:    [+200],\n    auto:           [0],\n    \n    toobig:        800,\n    nestfactor:    400,\n    spacefactor:  -100,\n    spaceoffset:     2,\n    spacelimit:      1,  // spaces larger than this get a penalty boost\n    fence:         500,\n    close:         500\n  };\n  \n  var ENDVALUES = {linebreakstyle: \"after\"};\n\n  \n  /**************************************************************************/\n  \n  MML.mbase.Augment({\n    HTMLlinebreakPenalty: PENALTY,\n    \n    /****************************************************************/\n    //\n    // Handle breaking an mrow into separate lines\n    //\n    HTMLmultiline: function (span) {\n\n      //\n      //  Find the parent element and mark it as multiline\n      //\n      var parent = this;\n      while (parent.inferred || (parent.parent && parent.parent.type === \"mrow\" &&\n             parent.parent.data.length === 1)) {parent = parent.parent}\n      var isTop = ((parent.type === \"math\" && parent.Get(\"display\") === \"block\") ||\n                    parent.type === \"mtd\");\n      parent.isMultiline = true;\n      \n      //\n      //  Default values for the line-breaking parameters\n      //\n      var VALUES = this.getValues(\n        \"linebreak\",\"linebreakstyle\",\"lineleading\",\"linebreakmultchar\",\n        \"indentalign\",\"indentshift\",\n        \"indentalignfirst\",\"indentshiftfirst\",\n        \"indentalignlast\",\"indentshiftlast\"\n      );\n      if (VALUES.linebreakstyle === MML.LINEBREAKSTYLE.INFIXLINEBREAKSTYLE) \n        {VALUES.linebreakstyle = this.Get(\"infixlinebreakstyle\")}\n      VALUES.lineleading = HTMLCSS.length2em(VALUES.lineleading,1,0.5);\n\n      //\n      //  Remove old color and break the span at its best line breaks\n      //\n      this.HTMLremoveColor(span);\n      var stack = HTMLCSS.createStack(span);\n      this.HTMLgetScale();\n      var state = {\n            n: 0, Y: 0,\n            scale: this.scale || 1,\n            isTop: isTop,\n            values: {},\n            VALUES: VALUES\n          },\n          align = this.HTMLgetAlign(state,{}),\n          shift = this.HTMLgetShift(state,{},align),\n          start = [],\n          end = {\n            index:[], penalty:PENALTY.nobreak,\n            w:0, W:shift, shift:shift, scanW:shift,\n            nest: 0\n          },\n          broken = false;\n          \n      while (this.HTMLbetterBreak(end,state) && \n             (end.scanW >= HTMLCSS.linebreakWidth || end.penalty === PENALTY.newline)) {\n        this.HTMLaddLine(stack,start,end.index,state,end.values,broken);\n        start = end.index.slice(0); broken = true;\n        align = this.HTMLgetAlign(state,end.values);\n        shift = this.HTMLgetShift(state,end.values,align);\n        if (align === MML.INDENTALIGN.CENTER) {shift = 0}\n        end.W = end.shift = end.scanW = shift; end.penalty = PENALTY.nobreak;\n      }\n      state.isLast = true;\n      this.HTMLaddLine(stack,start,[],state,ENDVALUES,broken);\n\n      //\n      //  Make top-level spans 100% wide.\n      //  Finish up the space and add the color again\n      //\n      if (isTop) {\n        stack.style.width = \"100%\";\n        if (parent.type === \"math\") {span.bbox.width = \"100%\"}\n      }\n      this.HTMLhandleSpace(span);\n      this.HTMLhandleColor(span);\n      span.bbox.isMultiline = true;\n\n      return span;\n    },\n\n    /****************************************************************/\n    //\n    //  Locate the next linebreak that is better than the current one\n    //\n    HTMLbetterBreak: function (info,state) {\n      if (this.isToken) {return false}  // FIXME: handle breaking of token elements\n      if (this.isEmbellished()) {\n        info.embellished = this;\n        return this.CoreMO().HTMLbetterBreak(info,state);\n      }\n      if (this.linebreakContainer) {return false}\n      //\n      //  Get the current breakpoint position and other data\n      //\n      var index = info.index.slice(0), i = info.index.shift(),\n          m = this.data.length, W, w, scanW, broken = (info.index.length > 0), better = false;\n      if (i == null) {i = -1}; if (!broken) {i++; info.W += info.w; info.w = 0}\n      scanW = info.scanW = info.W; info.nest++;\n      //\n      //  Look through the line for breakpoints,\n      //    (as long as we are not too far past the breaking width)\n      //\n      while (i < m && info.scanW < 1.33*HTMLCSS.linebreakWidth) {\n        if (this.data[i]) {\n          if (this.data[i].HTMLbetterBreak(info,state)) {\n            better = true; index = [i].concat(info.index); W = info.W; w = info.w;\n            if (info.penalty === PENALTY.newline) {\n              info.index = index;\n              if (info.nest) {info.nest--}\n              return true;\n            }\n          }\n          scanW = (broken ? info.scanW : this.HTMLaddWidth(i,info,scanW));\n        }\n        info.index = []; i++; broken = false;\n      }\n      if (info.nest) {info.nest--}\n      info.index = index;\n      if (better) {info.W = W; info.w = w}\n      return better;\n    },\n    HTMLaddWidth: function (i,info,scanW) {\n      if (this.data[i]) {\n        var span = this.data[i].HTMLspanElement();\n        scanW += span.bbox.w;\n        if (span.style.paddingLeft)  {scanW += HTMLCSS.unEm(span.style.paddingLeft)}\n        if (span.style.paddingRight) {scanW += HTMLCSS.unEm(span.style.paddingRight)}\n        info.W = info.scanW = scanW; info.w = 0;\n      }\n      return scanW;\n    },\n    \n    /****************************************************************/\n    //\n    //  Create a new line and move the required elements into it\n    //  Position it using proper alignment and indenting\n    //\n    HTMLaddLine: function (stack,start,end,state,values,broken) {\n      //\n      //  Create a box for the line, with empty BBox\n      //    fill it with the proper elements,\n      //    and clean up the bbox\n      //\n      line = HTMLCSS.createBox(stack);\n      line.bbox = this.HTMLemptyBBox({});\n      state.first = broken; state.last = true;\n      this.HTMLmoveLine(start,end,line,state,values);\n      this.HTMLcleanBBox(line.bbox);\n      //\n      //  Get the alignment and shift values\n      //\n      var align = this.HTMLgetAlign(state,values),\n          shift = this.HTMLgetShift(state,values,align);\n      //\n      //  Set the Y offset based on previous depth, leading, and current height\n      //\n      if (state.n > 0) {\n        var LHD = HTMLCSS.FONTDATA.baselineskip * state.scale;\n        var leading = (state.values.lineleading == null ? state.VALUES : state.values).lineleading * state.scale;\n        state.Y -= Math.max(LHD,state.d + line.bbox.h + leading);\n      }\n      //\n      //  Place the new line\n      //\n      HTMLCSS.alignBox(line,align,state.Y,shift);\n      //\n      //  Save the values needed for the future\n      //\n      state.d = line.bbox.d; state.values = values; state.n++;\n    },\n    \n    /****************************************************************/\n    //\n    //  Get alignment and shift values from the given data\n    //\n    HTMLgetAlign: function (state,values) {\n      var cur = values, prev = state.values, def = state.VALUES, align;\n      if (state.n === 0)     {align = cur.indentalignfirst || prev.indentalignfirst || def.indentalignfirst}\n      else if (state.isLast) {align = prev.indentalignlast || def.indentalignlast}\n      else                   {align = prev.indentalign || def.indentalign}\n      if (align === MML.INDENTALIGN.INDENTALIGN) {align = prev.indentalign || def.indentalign}\n      if (align === MML.INDENTALIGN.AUTO) {align = (state.isTop ? this.displayAlign : MML.INDENTALIGN.LEFT)}\n      return align;\n    },\n    HTMLgetShift: function (state,values,align) {\n      var cur = values, prev = state.values, def = state.VALUES, shift;\n      if (state.n === 0)     {shift = cur.indentshiftfirst || prev.indentshiftfirst || def.indentshiftfirst}\n      else if (state.isLast) {shift = prev.indentshiftlast || def.indentshiftlast}\n      else                   {shift = prev.indentshift || def.indentshift}\n      if (shift === MML.INDENTSHIFT.INDENTSHIFT) {shift = prev.indentshift || def.indentshift}\n      if (shift === \"auto\" || shift === \"\") {shift = \"0\"}\n      shift = HTMLCSS.length2em(shift,1,HTMLCSS.cwidth);\n      if (state.isTop && this.displayIndent !== \"0\") {\n        var indent = HTMLCSS.length2em(this.displayIndent,1,HTMLCSS.cwidth);\n        shift += (align === MML.INDENTALIGN.RIGHT ? -indent : indent);\n      }\n      return shift;\n    },\n    \n    /****************************************************************/\n    //\n    //  Move the selected elements into the new line's span,\n    //    moving whole items when possible, and parts of ones\n    //    that are split by a line break.\n    //  \n    HTMLmoveLine: function (start,end,span,state,values) {\n      var i = start[0], j = end[0];\n      if (i == null) {i = -1}; if (j == null) {j = this.data.length-1}\n      if (i === j && start.length > 1) {\n        //\n        //  If starting and ending in the same element move the subpiece to the new line\n        //\n        this.data[i].HTMLmoveSlice(start.slice(1),end.slice(1),span,state,values,\"paddingLeft\");\n      } else {\n        //\n        //  Otherwise, move the remainder of the initial item\n        //  and any others up to the last one\n        //\n        var last = state.last; state.last = false;\n        while (i < j) {\n          if (this.data[i]) {\n            if (start.length <= 1) {this.data[i].HTMLmoveSpan(span,state,values)}\n              else {this.data[i].HTMLmoveSlice(start.slice(1),[],span,state,values,\"paddingLeft\")}\n          }\n          i++; state.first = false; start = [];\n        }\n        //\n        //  If the last item is complete, move it,\n        //    otherwise move the first part of it up to the split\n        //\n        state.last = last;\n        if (this.data[i]) {\n          if (end.length <= 1) {this.data[i].HTMLmoveSpan(span,state,values)}\n            else {this.data[i].HTMLmoveSlice([],end.slice(1),span,state,values,\"paddingRight\")}\n        }\n      }\n    },\n    \n    /****************************************************************/\n    //\n    //  Split an element and copy the selected items into the new part\n    //\n    HTMLmoveSlice: function (start,end,span,state,values,padding) {\n      //\n      //  Get rid of color, if any (added back in later)\n      //  Create a new span for the slice of the element\n      //  Move the selected portion into the slice\n      //  If it is the last slice\n      //    Remove the original (now empty) span\n      //    Rename the Continue-0 span with the original name (for HTMLspanElement)\n      //    Add back the color\n      //\n      this.HTMLremoveColor();\n      var slice = this.HTMLcreateSliceSpan(span);\n      this.HTMLmoveLine(start,end,slice,state,values);\n      slice.style[padding] = \"\";\n      this.HTMLcombineBBoxes(slice,span.bbox);\n      this.HTMLcleanBBox(slice.bbox);\n      if (end.length === 0) {\n        span = this.HTMLspanElement();\n        span.parentNode.removeChild(span);\n        span.nextMathJaxSpan.id = span.id; var n = 0;\n        while (span = span.nextMathJaxSpan) {\n          var color = this.HTMLhandleColor(span);\n          if (color) {color.id += \"-MathJax-Continue-\"+n; n++}\n        }\n      }\n      return slice;\n    },\n\n    /****************************************************************/\n    //\n    //  Create a new span for an element that is split in two\n    //    Clone the original and update its ID.\n    //    Link the old span to the new one so we can find it later\n    //\n    HTMLcreateSliceSpan: function (span) {\n      var SPAN = this.HTMLspanElement(), n = 0;\n      var LAST = SPAN; while (LAST.nextMathJaxSpan) {LAST = LAST.nextMathJaxSpan; n++}\n      var SLICE = SPAN.cloneNode(false); LAST.nextMathJaxSpan = SLICE; SLICE.nextMathJaxSpan = null;\n      SLICE.id += \"-MathJax-Continue-\"+n;\n      SLICE.bbox = this.HTMLemptyBBox({});\n      return span.appendChild(SLICE);\n    },\n    \n    /****************************************************************/\n    //\n    //  Move an element from its original span to its new location in\n    //    a split element or the new line's span\n    //\n    HTMLmoveSpan: function (line,state,values) {\n      // FIXME:  handle linebreakstyle === \"duplicate\"\n      // FIXME:  handle linebreakmultchar\n      if (!(state.first || state.last) ||\n           (state.first && state.values.linebreakstyle === MML.LINEBREAKSTYLE.BEFORE) ||\n           (state.last && values.linebreakstyle === MML.LINEBREAKSTYLE.AFTER)) {\n        //\n        //  Move color and span\n        //\n\tvar color = document.getElementById(\"MathJax-Color-\"+this.spanID+HTMLCSS.idPostfix);\n        if (color) {line.appendChild(color)}\n        var span = this.HTMLspanElement();\n        line.appendChild(span);\n        //\n        //  If it is last, remove right padding\n        //  If it is first, remove left padding and recolor\n        //\n        if (state.last) {span.style.paddingRight = \"\"}\n        if (state.first || state.nextIsFirst) {\n          span.style.paddingLeft = \"\";\n          if (color) {this.HTMLremoveColor(span); this.HTMLhandleColor(span)}\n        }\n        if (state.first && span.bbox.w === 0) {state.nextIsFirst = true}\n          else {delete state.nextIsFirst}\n        //\n        //  Update bounding box\n        //\n        this.HTMLcombineBBoxes(this,line.bbox);\n      }\n    }\n  });\n\n  /**************************************************************************/\n\n  MML.mfenced.Augment({\n    HTMLbetterBreak: function (info,state) {\n      //\n      //  Get the current breakpoint position and other data\n      //\n      var index = info.index.slice(0), i = info.index.shift(),\n          m = this.data.length, W, w, scanW, broken = (info.index.length > 0), better = false;\n      if (i == null) {i = -1}; if (!broken) {i++; info.W += info.w; info.w = 0}\n      scanW = info.scanW = info.W; info.nest++;\n      //\n      //  Create indices that include the delimiters and separators\n      //\n      if (!this.dataI) {\n        this.dataI = [];\n        if (this.data.open) {this.dataI.push(\"open\")}\n        if (m) {this.dataI.push(0)}\n        for (var j = 1; j < m; j++) {\n          if (this.data[\"sep\"+j]) {this.dataI.push(\"sep\"+j)}\n          this.dataI.push(j);\n        }\n        if (this.data.close) {this.dataI.push(\"close\")}\n      }\n      m = this.dataI.length;\n      //\n      //  Look through the line for breakpoints, including the open, close, and separators\n      //    (as long as we are not too far past the breaking width)\n      //\n      while (i < m && info.scanW < 1.33*HTMLCSS.linebreakWidth) {\n        var k = this.dataI[i];\n        if (this.data[k]) {\n          if (this.data[k].HTMLbetterBreak(info,state)) {\n            better = true; index = [i].concat(info.index); W = info.W; w = info.w;\n            if (info.penalty === PENALTY.newline) {\n              info.index = index;\n              if (info.nest) {info.nest--}\n              return true}\n          }\n          scanW = (broken ? info.scanW : this.HTMLaddWidth(i,info,scanW));\n        }\n        info.index = []; i++; broken = false;\n      }\n      if (info.nest) {info.nest--}\n      info.index = index;\n      if (better) {info.W = W; info.w = w}\n      return better;\n    },\n    \n    HTMLmoveLine: function (start,end,span,state,values) {\n      var i = start[0], j = end[0];\n      if (i == null) {i = -1}; if (j == null) {j = this.dataI.length-1}\n      if (i === j && start.length > 1) {\n        //\n        //  If starting and ending in the same element move the subpiece to the new line\n        //\n        this.data[this.dataI[i]].HTMLmoveSlice(start.slice(1),end.slice(1),span,state,values,\"paddingLeft\");\n      } else {\n        //\n        //  Otherwise, move the remainder of the initial item\n        //  and any others (including open and separators) up to the last one\n        //\n        var last = state.last; state.last = false; var k = this.dataI[i];\n        while (i < j) {\n          if (this.data[k]) {\n            if (start.length <= 1) {this.data[k].HTMLmoveSpan(span,state,values)}\n              else {this.data[k].HTMLmoveSlice(start.slice(1),[],span,state,values,\"paddingLeft\")}\n          }\n          i++; k = this.dataI[i]; state.first = false; start = [];\n        }\n        //\n        //  If the last item is complete, move it\n        //\n        state.last = last;\n        if (this.data[k]) {\n          if (end.length <= 1) {this.data[k].HTMLmoveSpan(span,state,values)}\n            else {this.data[k].HTMLmoveSlice([],end.slice(1),span,state,values,\"paddingRight\")}\n        }\n      }\n    }\n\n  });\n  \n  /**************************************************************************/\n\n  MML.msubsup.Augment({\n    HTMLbetterBreak: function (info,state) {\n      if (!this.data[this.base]) {return false}\n      //\n      //  Get the current breakpoint position and other data\n      //\n      var index = info.index.slice(0), i = info.index.shift(),\n          W, w, scanW, broken = (info.index.length > 0), better = false;\n      if (!broken) {info.W += info.w; info.w = 0}\n      scanW = info.scanW = info.W;\n      //\n      //  Record the width of the base and the super- and subscripts\n      //\n      if (i == null) {\n        this.HTMLbaseW = this.data[this.base].HTMLspanElement().bbox.w;\n        this.HTMLdw = this.HTMLspanElement().bbox.w - this.HTMLbaseW;\n      }\n      //\n      //  Check if the base can be broken\n      //\n      if (this.data[this.base].HTMLbetterBreak(info,state)) {\n        better = true; index = [this.base].concat(info.index); W = info.W; w = info.w;\n        if (info.penalty === PENALTY.newline) {better = broken = true}\n      }\n      //\n      //  Add in the base if it is unbroken, and add the scripts\n      //\n      if (!broken) {this.HTMLaddWidth(this.base,info,scanW)}\n      info.scanW += this.HTMLdw; info.W = info.scanW;\n      info.index = []; if (better) {info.W = W; info.w = w; info.index = index}\n      return better;\n    },\n    \n    HTMLmoveLine: function (start,end,span,state,values) {\n      //\n      //  Move the proper part of the base\n      //\n      if (this.data[this.base]) {\n        if (start.length > 1) {\n          this.data[this.base].HTMLmoveSlice(start.slice(1),end.slice(1),span,state,values,\"paddingLeft\");\n        } else {\n          if (end.length <= 1) {this.data[this.base].HTMLmoveSpan(span,state,values)}\n            else {this.data[this.base].HTMLmoveSlice([],end.slice(1),span,state,values,\"paddingRight\")}\n        }\n      }\n      //\n      //  If this is the end, check for super and subscripts, and move those\n      //  by moving the stack that contains them, and shifting by the amount of the\n      //  base that has been removed.  Remove the empty base box from the stack.\n      //\n      if (end.length === 0) {\n        var s = this.data[this.sup] || this.data[this.sub];\n        if (s && this.HTMLnotEmpty(s)) {\n          var box = s.HTMLspanElement().parentNode, stack = box.parentNode;\n          if (this.data[this.base]) {stack.removeChild(stack.firstChild)}\n\t  for (box = stack.firstChild; box; box = box.nextSibling)\n\t    {box.style.left = HTMLCSS.Em(HTMLCSS.unEm(box.style.left)-this.HTMLbaseW)}\n          stack.bbox.w -= this.HTMLbaseW; stack.style.width = HTMLCSS.Em(stack.bbox.w);\n          this.HTMLcombineBBoxes(stack,span.bbox);\n          span.appendChild(stack);\n        }\n      }\n    }\n\n  });\n  \n  /**************************************************************************/\n\n  MML.mmultiscripts.Augment({\n    HTMLbetterBreak: function (info,state) {\n      if (!this.data[this.base]) {return false}\n      //\n      //  Get the current breakpoint position and other data\n      //\n      var index = info.index.slice(0); info.index.shift();\n      var W, w, scanW, broken = (info.index.length > 0), better = false;\n      if (!broken) {info.W += info.w; info.w = 0}\n      info.scanW = info.W;\n      //\n      //  Get the bounding boxes and the width of the scripts\n      //\n      var bbox = this.HTMLspanElement().bbox,\n          base = this.data[this.base].HTMLspanElement().bbox;\n      var dw = bbox.w - base.w;\n      //\n      //  Add in the prescripts\n      //  \n      info.scanW += bbox.dx; scanW = info.scanW;\n      //\n      //  Check if the base can be broken\n      //\n      if (this.data[this.base].HTMLbetterBreak(info,state)) {\n        better = true; index = [this.base].concat(info.index); W = info.W; w = info.w;\n        if (info.penalty === PENALTY.newline) {better = broken = true}\n      }\n      //\n      //  Add in the base if it is unbroken, and add the scripts\n      //\n      if (!broken) {this.HTMLaddWidth(this.base,info,scanW)}\n      info.scanW += dw; info.W = info.scanW;\n      info.index = []; if (better) {info.W = W; info.w = w; info.index = index}\n      return better;\n    },\n    \n    HTMLmoveLine: function (start,end,span,state,values) {\n      var SPAN = this.HTMLspanElement(), data = SPAN.bbox,\n          stack = SPAN.firstChild, BOX = {};\n      if (HTMLCSS.msiePaddingWidthBug) {stack = stack.nextSibling}\n      var box = stack.firstChild;\n      \n      //\n      //  Get the boxes for the scripts (if any)\n      //\n      while (box) {\n        if (box.bbox && box.bbox.name) {BOX[box.bbox.name] = box}\n        box = box.nextSibling;\n      }\n      //\n      //  If this is the start, move the prescripts, if any.\n      //\n      if (start.length < 1) {\n        if (BOX.presub || BOX.presup) {\n          var STACK = HTMLCSS.createStack(span);\n          if (BOX.presup) {\n            HTMLCSS.addBox(STACK,BOX.presup);\n            HTMLCSS.placeBox(BOX.presup,data.dx-BOX.presup.bbox.w,data.u);\n          }\n          if (BOX.presub) {\n            HTMLCSS.addBox(STACK,BOX.presub);\n            HTMLCSS.placeBox(BOX.presub,data.dx+data.delta-BOX.presub.bbox.w,-data.v);\n          }\n          this.HTMLcombineBBoxes(STACK,span.bbox);\n          span.appendChild(STACK);\n          STACK.style.width = HTMLCSS.Em(data.dx);\n        }\n      }\n      //\n      //  Move the proper part of the base\n      //\n      if (this.data[this.base]) {\n        if (start.length > 1) {\n          this.data[this.base].HTMLmoveSlice(start.slice(1),end.slice(1),span,state,values,\"paddingLeft\");\n        } else {\n          if (end.length <= 1) {this.data[this.base].HTMLmoveSpan(span,state,values)}\n            else {this.data[this.base].HTMLmoveSlice([],end.slice(1),span,state,values,\"paddingRight\")}\n        }\n      }\n      //\n      //  If this is the end, check for super and subscripts, and move those\n      //  by moving the stack that contains them, and shifting by the amount of the\n      //  base that has been removed.  Remove the empty base box from the stack.\n      //\n      if (end.length === 0) {\n        if (this.data[this.base]) {stack.removeChild(stack.firstChild)}\n        for (box = stack.firstChild; box; box = box.nextSibling)\n\t  {box.style.left = HTMLCSS.Em(HTMLCSS.unEm(box.style.left)-data.px)}\n        stack.bbox.w -= data.px; stack.style.width = HTMLCSS.Em(stack.bbox.w);\n        this.HTMLcombineBBoxes(stack,span.bbox);\n        span.appendChild(stack);\n      }\n    }\n\n  });\n  \n  /**************************************************************************/\n\n  MML.mo.Augment({\n    //\n    //  Override the method for checking line breaks to properly handle <mo>\n    //\n    HTMLbetterBreak: function (info,state) {\n      if (info.values && info.values.id === this.spanID) {return false}\n      var values = this.getValues(\n        \"linebreak\",\"linebreakstyle\",\"lineleading\",\"linebreakmultchar\",\n        \"indentalign\",\"indentshift\",\n        \"indentalignfirst\",\"indentshiftfirst\",\n        \"indentalignlast\",\"indentshiftlast\",\n        \"texClass\", \"fence\"\n      );\n      if (values.linebreakstyle === MML.LINEBREAKSTYLE.INFIXLINEBREAKSTYLE) \n        {values.linebreakstyle = this.Get(\"infixlinebreakstyle\")}\n      //\n      //  Adjust nesting by TeX class (helps output that does not include\n      //  mrows for nesting, but can leave these unbalanced.\n      //\n      if (values.texClass === MML.TEXCLASS.OPEN) {info.nest++}\n      if (values.texClass === MML.TEXCLASS.CLOSE && info.nest) {info.nest--}\n      //\n      //  Get the default penalty for this location\n      //\n      var W = info.scanW, mo = (info.embellished||this); delete info.embellished;\n      var span = mo.HTMLspanElement(), w = span.bbox.w;\n      if (span.style.paddingLeft) {w += HTMLCSS.unEm(span.style.paddingLeft)}\n      if (values.linebreakstyle === MML.LINEBREAKSTYLE.AFTER) {W += w; w = 0}\n      if (W - info.shift === 0 && values.linebreak !== MML.LINEBREAK.NEWLINE)\n        {return false} // don't break at zero width (FIXME?)\n      var offset = HTMLCSS.linebreakWidth - W;\n      // Adjust offest for explicit first-line indent and align\n      if (state.n === 0 && (values.indentshiftfirst !== state.VALUES.indentshiftfirst ||\n          values.indentalignfirst !== state.VALUES.indentalignfirst)) {\n        var align = this.HTMLgetAlign(state,values),\n            shift = this.HTMLgetShift(state,values,align);\n        offset += (info.shift - shift);\n      }\n      //\n      var penalty = Math.floor(offset / HTMLCSS.linebreakWidth * 1000);\n      if (penalty < 0) {penalty = PENALTY.toobig - 3*penalty}\n      if (values.fence) {penalty += PENALTY.fence}\n      if ((values.linebreakstyle === MML.LINEBREAKSTYLE.AFTER &&\n          values.texClass === MML.TEXCLASS.OPEN) ||\n          values.texClass === MML.TEXCLASS.CLOSE) {penalty += PENALTY.close}\n      penalty += info.nest * PENALTY.nestfactor;\n      //\n      //  Get the penalty for this type of break and\n      //    use it to modify the default penalty\n      //\n      var linebreak = PENALTY[values.linebreak||MML.LINEBREAK.AUTO];\n      if (!(linebreak instanceof Array)) {\n        //  for breaks past the width, don't modify penalty\n        if (offset >= 0) {penalty = linebreak * info.nest}\n      } else {penalty = Math.max(1,penalty + linebreak[0] * info.nest)}\n      //\n      //  If the penalty is no better than the current one, return false\n      //  Otherwise save the data for this breakpoint and return true\n      //\n      if (penalty >= info.penalty) {return false}\n      info.penalty = penalty; info.values = values; info.W = W; info.w = w;\n      values.lineleading = HTMLCSS.length2em(values.lineleading,1,state.VALUES.lineleading);\n      values.id = this.spanID;\n      return true;\n    }\n  });\n  \n  /**************************************************************************/\n\n  MML.mspace.Augment({\n    //\n    //  Override the method for checking line breaks to properly handle <mspace>\n    //\n    HTMLbetterBreak: function (info,state) {\n      if (info.values && info.values.id === this.spanID) {return false}\n      var values = this.getValues(\"linebreak\");\n      var linebreakValue = values.linebreak;\n      if (!linebreakValue || this.hasDimAttr()) {\n        // The MathML spec says that the linebreak attribute should be ignored\n        // if any dimensional attribute is set.\n        linebreakValue = MML.LINEBREAK.AUTO;\n      }\n      //\n      //  Get the default penalty for this location\n      //\n      var W = info.scanW, span = this.HTMLspanElement(), w = span.bbox.w;\n      if (span.style.paddingLeft) {w += HTMLCSS.unEm(span.style.paddingLeft)}\n      if (W - info.shift === 0) {return false} // don't break at zero width (FIXME?)\n      var offset = HTMLCSS.linebreakWidth - W;\n      //\n      var penalty = Math.floor(offset / HTMLCSS.linebreakWidth * 1000);\n      if (penalty < 0) {penalty = PENALTY.toobig - 3*penalty}\n      penalty += info.nest * PENALTY.nestfactor;\n      //\n      //  Get the penalty for this type of break and\n      //    use it to modify the default penalty\n      //\n      var linebreak = PENALTY[linebreakValue];\n      if (linebreakValue === MML.LINEBREAK.AUTO && w >= PENALTY.spacelimit &&\n          !this.mathbackground && !this.background)\n        {linebreak = [(w+PENALTY.spaceoffset)*PENALTY.spacefactor]}\n      if (!(linebreak instanceof Array)) {\n        //  for breaks past the width, don't modify penalty\n        if (offset >= 0) {penalty = linebreak * info.nest}\n      } else {penalty = Math.max(1,penalty + linebreak[0] * info.nest)}\n      //\n      //  If the penalty is no better than the current one, return false\n      //  Otherwise save the data for this breakpoint and return true\n      //\n      if (penalty >= info.penalty) {return false}\n      info.penalty = penalty; info.values = values; info.W = W; info.w = w;\n      values.lineleading = state.VALUES.lineleading;\n      values.linebreakstyle = \"before\"; values.id = this.spanID;\n      return true;\n    }\n  });\n  \n  //\n  //  Hook into the mathchoice extension\n  //\n  MathJax.Hub.Register.StartupHook(\"TeX mathchoice Ready\",function () {\n    MML.TeXmathchoice.Augment({\n      HTMLbetterBreak: function (info,state) {\n        return this.Core().HTMLbetterBreak(info,state);\n      },\n      HTMLmoveLine: function (start,end,span,state,values) {\n        return this.Core().HTMLmoveSlice(start,end,span,state,values);\n      }\n    });\n  });\n  \n  //\n  //  Have maction process only the selected item\n  //\n  MML.maction.Augment({\n    HTMLbetterBreak: function (info,state) {\n      return this.Core().HTMLbetterBreak(info,state);\n    },\n    HTMLmoveLine: function (start,end,span,state,values) {\n      return this.Core().HTMLmoveSlice(start,end,span,state,values);\n    },\n    //\n    //  Split and move the hit boxes as well\n    //\n    HTMLmoveSlice: function (start,end,span,state,values,padding) {\n      var hitbox = document.getElementById(\"MathJax-HitBox-\"+this.spanID+HTMLCSS.idPostfix);\n      if (hitbox) {hitbox.parentNode.removeChild(hitbox)}\n      var slice = this.SUPER(arguments).HTMLmoveSlice.apply(this,arguments);\n      if (end.length === 0) {\n        span = this.HTMLspanElement(); var n = 0;\n        while (span) {\n          hitbox = this.HTMLhandleHitBox(span,\"-Continue-\"+n);\n          span = span.nextMathJaxSpan; n++;\n        }\n      }\n      return slice;\n    }\n  });\n  \n  //\n  //  Have semantics only do the first element\n  //  (FIXME:  do we need to do anything special about annotation-xml?)\n  //\n  MML.semantics.Augment({\n    HTMLbetterBreak: function (info,state) {\n      return (this.data[0] ? this.data[0].HTMLbetterBreak(info,state) : false);\n    },\n    HTMLmoveLine: function (start,end,span,state,values) {\n      return (this.data[0] ? this.data[0].HTMLmoveSlice(start,end,span,state,values) : null);\n    }\n  });\n  \n  /**************************************************************************/\n\n  MathJax.Hub.Startup.signal.Post(\"HTML-CSS multiline Ready\");\n  MathJax.Ajax.loadComplete(HTMLCSS.autoloadDir+\"/multiline.js\");\n  \n});\n\n"]}]}